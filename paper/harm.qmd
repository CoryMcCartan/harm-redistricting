---
title: Individual and Differential Harm in Redistricting
date: last-modified
authors:
  - name: Cory McCartan
    affiliations:
      - name: Pennsylvania State University
        department: Department of Statistics
        address: 461 Pollock Road
        city: University Park
        region: PA
        postal-code: 16801
    email: mccartan@psu.edu
    url: https://corymccartan.com/
    corresponding: true
  - name: Christopher T. Kenny
    affiliations:
    - name: Harvard University
      department: Department of Government
      address: 1737 Cambridge Street
      city: Cambridge
      region: MA
      postal-code: "02138 "
    email: christopherkenny@fas.harvard.edu
    url: https://christophertkenny.com
abstract: |
  Social scientists have developed dozens of measures for assessing partisan bias in redistricting.
  But these measures are not easily adapted to other groups,
  including groups defined by race, class, or geography.
  Nor are they applicable to single- or no-party contexts, such as local redistricting.
  To overcome these limitations, we propose a unified framework of harm for evaluating
  the impacts of a districting plan on individual voters and the groups to which they belong.
  We consider a voter harmed if their chosen candidate is not elected under the current plan,
  but would be under a different plan.
  Harm improves on existing measures by both focusing on the choices of individual voters
  and directly incorporating counterfactual plans.
  We discuss strategies for estimating harm, and demonstrate the utility of our framework
  through analyses of partisan gerrymandering in New Jersey, voting rights
  litigation in Alabama, and racial dynamics of Boston City Council elections.
thanks: |
  The authors thank Steve Ansolabehere, Matt Blackwell, Kosuke Imai, Gary King,
  Shiro Kuriwaki, Tyler Simko, Nick Stephanopolous, and
  participants of the Fall 2021 Harvard American Politics Research Workshop,
  Fall 2022 Harvard Applied Statistics Workshop,
  and Imai Research Group for helpful comments and discussion.
  Replication code and data are available at <https://github.com/CoryMcCartan/harm-redistricting>.
keywords:
  - representation
  - redistricting
  - voting rights
  - individual harm
bibliography: references.bib
format:
    cmc-article-pdf:
        journal:
            blinded: true
        fontsize: 11pt
        biblio-style: apsr
        include-in-header: "header.tex"
editor_options:
  markdown:
    wrap: sentence
---

```{r SETUP, include=FALSE}
library(knitr)
library(here)

opts_chunk$set(echo=FALSE, message=FALSE, warning=FALSE,
               fig.path=here("paper/figures/"), fig.align="center",
               fig.width=(8.5-2*1)/2, out.width="100%", fig.asp=0.8)
```

# Introduction

For as long as there have been district-based electoral systems, groups, individuals, and parties have manipulated them for political gain.
Partisan gerrymandering, going back to Elbridge Gerry's salamander-shaped district [@griffith1907rise, pp. 72--73], is perhaps the most consistently visible manifestation of this tendency.
But gerrymandering takes other forms as well.
In the United States, states historically used racial gerrymandering to maintain White political supremacy [@gilliland1969racial].
At the local level, where most redistricting occurs, partisanship is less salient, and manipulation may be more subtle or may favor a narrower group [@cain2002mapmaking; @halberstam2012process].
The diversity of types of gerrymandering is further apparent from a survey of major litigation over the past decades, which includes allegations of gerrymandering involving party [@2018league; @2019rucho], race [@1993shaw; @2022merrill], religion [@1977ujo; @2020ercsd], incarceration status [@2015calvin; @2016davidson], and residency or citizenship [@1966burns; @2016evenwel].

The academic study of gerrymandering has not reflected this diversity.
Nearly all research has been on partisan gerrymandering, and has centered on how districting plans treat political parties, as captured in the *seats-votes curve* or notions of *partisan symmetry* [@tufte1973pb; @grofman1983measures; @king1987democratic; @king1989representation; @gelman1994unified; @thomas2013estimating; @katz2020].
A large number of formulas for quantifying partisan gerrymanders have also been developed [@stephanopoulos2015; @mcdonald2015unfair; @warrington18].
The study of racial gerrymandering has been largely shaped by the legal framework for challenging such gerrymanders: the Voting Rights Act of 1965 (VRA).
This literature focuses on identifying the voting preferences of racial groups through techniques such as ecological inference [@oloughlin1982id; @grofman1991identifying; @king1997solution; @greiner2006ecological].
Work on local redistricting is even more sparse, in part because of data limitations [but see @siegel2013educational; @abott2020large; @vargas2021racial].

The dominance of partisan frameworks limits redistricting analysis, even in purely partisan cases.
By focusing only on party effects, existing tools overlook how partisan lines also have an effect of relative voting power on axes such as race, wealth, and urbanicity.
This paper addresses these limitations with a new framework of *individual and differential harm*.
Our proposed framework focuses on measuring the concentration or dilution of voting power to favor or disfavor a particular group.
This avoids the pitfalls of party-centric approaches.

The harm framework combines two key ideas, further motivated in @sec-motivation.
First, it operates at the level of the individual voter and measures whether each voter is represented by the candidate of their choice.
This unifies gerrymandering analyses across contexts and reflects the goal that elected officials represent the preferences of the voting public [see also @brunell2010].
Few existing measures, with the exception of partisan disclocation [@defoeubarodd21], are focused on the invididual voter this way.

Second, the proposed framework considers *counterfactual* districting plans, not just a single enacted plan.
Many factors influence the qualities of a districting plan, and without a well-defined comparison, it is impossible to differentiate which qualities, like its partisan performance, are consequences of laws and political geography or result from improper manipulation of the system for political gain [@chen:rodd:13].
For example, Massachusetts' 2010 districts had an efficiency gap that would normally qualify as a Democratic gerrymander, but was in fact due to the homogeneity of the state's political geography [@duch:18].
While consideration of counterfactual plans is now commonplace with redistricting simulation algorithms [e.g., @deford2019], our approach is different in that it incorporates them within the definition of the measure itself.
Some existing districting rely on *implicit* counterfactuals, which may be irrelevant or infeasible, as we discuss in [Appendix @sec-connections].
By making the comparison set explicit, our approach improves on existing work by better reflecting legal and geographic realities, while making the interpretation of our measures clearer.

The *combination* of individual voter choices and counterfactual districting plans is the key innovation of our framework of *individual harm*: informally, a voter is harmed if they would be represented by their candidate of choice under a counterfactual plan.
Once measured for each voter, researchers can examine the distribution of harm by geography, partisanship, race, or other factors.
@sec-motivation gives a simple example of this idea; @sec-indiv-harm formalizes it.

A key feature of our framework is its clear separation of theoretical quantities of interest and empirical strategies for estimating them [@katz2022].
The methods section discusses the challenge of estimating harm and differential harm from observed data.
Recent advances in redistricting simulation, which can generate a large number of random districting plans that respect relevant legal constraints, are critical to this effort [@fifield2020mcmc; @deford2019; @carter2019; @mccartan2020].
These algorithmically-generated sets of districting plans can provide a realistic set of counterfactuals for our measures.

The harm framework has important similarities with the common-law approach to voting rights litigation.
To proceed with a legal challenge to an alleged gerrymander, a voter must demonstrate that their individual right to vote has been harmed by the enacted district boundaries [@1964reynolds; @1962baker; @issakarl98].
This requires proof that *but for* the alleged gerrymander, the voter would have been more likely to elect their chosen candidate [@2004vieth; @2018league; @2019lewis].
Indeed, a primary factor in the Supreme Court's ruling that partisan gerrymandering is not justiciable was that existing redistricting measures are not clearly tied to individual injury [@2017gill].
The harm measure also captures or generalizes the three *Gingles* preconditions for vote dilution litigation under the Voting Rights Act of 1965, as discussed further in [Appendix @sec-connections].

We demonstrate the practical value of the proposed framework in three diverse contexts.
@sec-nj analyzes New Jersey congressional districts, showing how traditional metrics can misidentify both the magnitude and direction of partisan gerrymanders.
@sec-alabama uses differential harm to disentangle racial and partisan effects in Alabama's districting.
@sec-boston applies the framework to local redistricting, quantifying the benefits of race-aware boundaries for Black voters in Boston.
@sec-discussion concludes.

# Motivation {#sec-motivation}

Consider *Minissouri*, a stylized representation of Missouri which is shown in @fig-minissouri.
Minissouri has two cities and a substantial rural population with a partisan breakdown of 55.6% R to 44.4% D, and is divided into three districts.
<!-- Voters' preferences are assumed to be stable across elections, and turnout is 100%. -->
In addition to partisan affiliation (red or blue), each voter also belongs to a racial group (squares or circles).

```{r fig-minissouri, fig.width=6.75}
#| fig.cap: |
#|      Two potential districting plans for Minissouri,
#|      a Democratic gerrymander (a), and a close-to-proportional plan (b).
#|      Panel (c) shows which voters are harmed by the Democratic gerrymander,
#|      using the proportional plan (b) as a counterfactual.
#|      Panel (d) summarizes this across precincts, showing
#|      the average harm done to voters of each partisan and racial group.
include_graphics("figures/minissouri.pdf")
```

Suppose the redistricting plan in @fig-minissouri(a) has been enacted.
Though Republicans win the popular vote, Democrats win two of three seats.
In contrast, @fig-minissouri(b) is more proportional, electing two Republicans and one Democrat.

Compared to plan (b), plan (a) packs Republicans into a rural district.
@fig-minissouri highlights the voters who are harmed by the enactment of plan (a) over the alternative (b).
For example, in the upper leftmost precinct, there are three Republican square voters who are placed into a Democratic district in plan (a) but would have been placed into a Republican district in plan (b), and thus are harmed.
In contrast, Republican voters in the northeast city are not harmed, since they reside in a Democratic district under both plans.

After identifying which voters are harmed by plan (a) compared to counterfactual (b), it is natural to examine the overall composition of these harmed voters.
Of the 46 harmed voters, 44 are Republicans and only 2 are Democrats.
These represent $44\%$ of all Republicans and $2.5\%$ of all Democrats.
We call the gap between these two rates the *differential harm*, and propose it as a general way to account for the impact of a districting plan on particular groups.
Here, then the partisan differential harm is $-41.5\%$, meaning that the average Republican voter is $41.5$pp less likely to be represented by a Republican than the average Democrat is to be represented by a Democrat, *compared to plan (b)*.

We need not limit our consideration to partisanship.
We can also tally harm by *race*, which in Minissouri is correlated with both geography and partisanship.
Plan (a) harms 13 circle voters and 33 square voters---a differential racial harm of $-20\%$.
<!-- This means square voters are $20$pp more likely to be harmed than circle voters. -->
While this comparison alone cannot establish whether the drawers of plan (a) intended to harm square voters versus maximize Democratic representation, it quantifies the impact of plan (a) on these voters versus the alternative plan (b), on the same scale as differential partisan harm.

We stress that the results here are tied the specific counterfactual plan (b).
Indeed, this is a feature of the harm framework: different research questions may require different counterfactuals.
We illustrate this aspect of the framework throughout the applications below.

# Individual and Differential Harm {#sec-indiv-harm}

We formalize and generalize the concepts in @sec-motivation.
Let $\Voters$ be the set of individuals, or *voters*, in the region and time period.
Individuals vote for a candidate to represent districts, which are indexed by $\Distrs$.

Individuals vote in elections, each of which produces a specific outcome $v$ from the set $\Elecs$ of all possible election outcomes.
<!-- In an election, voters either vote for a candidate running in their district, or abstain from voting. -->
We write $v(i)$ to mean the candidate that individual $i$ votes for in election $v$.
The set of all individual vote choices (which may include the choice to abstain from voting) fully determines the specific election outcome.

Every voter resides in some legislative district.
This assignment defines a *districting plan* and is represented here by a function $q(i)$ indicating the district that individual $i$ lives in.
The set of all possible districting plans is $\Plans$.

In an election $v$, the votes are tallied and the candidate with the most votes wins.
Using potential outcomes notation, we denote the winner of voter $i$'s district under districting plan $q$ and election $v$ as $\win_i(v,q)$.
This notation obscures the complex relationships and feedback effects between individuals, elections, and districting plans.
For example, different districting plans may lead to different candidates running, depending on district partisanship and incumbent residency.
The assumptions we make on these relationships are made explicit by the statistical models used to estimate the harm measure; these models may be as simple or complex as the researcher chooses, as we discuss in the methods section.

## Harm {#sec-harm}

The key intuition from @sec-motivation is that to be harmed, a voter must have a better outcome in the counterfactual world where a different districting plan was in place.
Letting $\tilde q$ denote a counterfactual districting plan, we define the *harm* to an individual $i$ in election $v$ held under districting plan $q$ as

$$h_i(v,q,\tilde q) = \ind\{v(i) \neq \win_i(v, q)\} \ind\{v(i) = \win_i(v, \tilde q)\}.$$

Harm requires both terms to be true: the first measuring if a voter is not represented by their chosen candidate under $q$, and the second term measuring if they would have been represented by their chosen candidate under the counterfactual plan $\tilde q$.

Notice the fundamental asymmetry in this definition: $h_i(v,q,\tilde q)\neq h_i(v,\tilde q,q)$, as $\ind\{v(i) \neq \win_i(v, q)\} \neq \ind\{v(i) \neq \win_i(v, \tilde q)\}$.
Exchanging the role of the enacted plan and the counterfactual will not simply flip the direction of our conclusion.

In general, $q$ harms some individuals versus $\tilde q$, and $\tilde q$ harms a distinct, though not necessarily disjoint, set of individuals, versus $q$.
A symmetric version of $h_i(v,q,\tilde q)$ would need to combine both of these groups: those harmed and those who gain by electing their chosen candidate under $q$ but not under the counterfactual $\tilde q$.
In practice, voters, courts, or politicians may differ in their views on how to balance preventing harm and maximizing gains.

## Multiple Elections or Districting Plans

As defined above, $h_i(v,q,\tilde q)$ captures harm in a single election and relative to one counterfactual districting plan $\tilde q$.
In general, we are interested in outcomes over multiple elections and a much larger set of counterfactual plans.
Ideally, we would average individual harm over a set of future elections under the enacted districting plan and over a set of hypothetical districting plans that are consistent with districting criteria.
We could also consider averaging over a set of individuals with some shared characteristics.

To allow for such averaging, we replace the fixed election $v$, counterfactual districting plan $\tilde q$, and individual voter $i$ with random variables $V\in\Elecs$, $\tilde Q\in\Plans$, and $I\in\Voters$.
The random variable $V$ can be conceptualized as ranging over possible future elections---one realization could correspond to a heavily Democratic-favoring midterm year, while another could involve incumbents under-performing particularly badly.
The random variable $\tilde Q$ captures the range of potential counterfactual districting plans.
Rarely would an analyst have a single counterfactual plan in mind: different realizations of $\tilde Q$ correspond to different districting plans that are permissible under the relevant districting criteria.
Finally, $I$ is defined to be a voter taken uniformly at random from $\Voters$, with $I\indep V,\tilde Q$.

The randomness in $V$ and $\tilde Q$ allows us to compare the enacted districting plan to many plausible counterfactual alternatives, and across a range of electoral environments.
At times we may wish to study on a particular election or a particular counterfactual plan.
Treating $V$ and $\tilde Q$ as random variables allows us to condition on particular values of each.
A particular specification of the distribution of $V$ and $\tilde Q$ is required only when *estimating* our harm measures in a particular application, a topic we return to in the methods section.

With these definitions, the harm for a (randomly selected) individual under plan $q$ can be written as
$$
H(q) \dfeq h_I(V, q, \tilde Q).
$$
$H(q)$ is itself a random variable, representing the harm to *some* individual in *some* election compared to *some* counterfactual plan.
The random variable $I$ here serves as a kind of "veil of ignorance" [@rawls2004theory]: without picking a specific individual, a districting plan $q$ which tends to produce a low $H(q)$ would be expected to be preferred over a plan which tended to produce a higher $H(q)$.

<!-- Despite being only a scalar quantity, $H(q)$ actually fully captures the harm created by the plan $q$.
We can zoom in to specific dimensions of the plan by conditioning on values of $V$, $\tilde Q$, and $I$, or by taking expectations.
Thus, for example, the harm for a single individual $i$ becomes $H(q)\mid I=i$, and the electorate's average harm in a particular election $v$ becomes
$$
    \E[H(q)\mid V=v] = \Pr[v(I)\neq\win_I(v, q) \text{ and }v(I)=\win_I(v, \tilde Q)],
$$
that is, the probability that a randomly selected voter in this election is misrepresented under the adopted plan but would not have been under a randomly selected counterfactual. -->

## Differential Harm {#sec-diff-harm}

Single-member districts are often motivated by the value in representation to specific communities with shared interests.
Preserving "communities of interest" is one of the most common statutory and constitutional requirements imposed by states on the plan-drawing process [@ncslcriteria].
It is therefore natural to consider not just the average harm to voters done by a plan, but also how this harm is distributed across certain groups of voters, defined by race, party, or other attributes.

To that end, let $\Groups=\{G_1,G_2,\dots\}$ be a set of mutually exclusive groups of voters, so that for each voter $i$, we have $i\in G_k$ for some group $G_k$.
In general we will not require the group identities to be fixed with respect to elections.[^1]
This is because some group identities, like partisan preference, may themselves change election-to-election.

[^1]: Formally, we have random indicator variables $\ind\{i\in G_k\}$ for all $i$ and $k$, subject to the constraint that $\sum_k \ind\{i\in G_k\}=1$ for all $i$.
    These indicator variables may be correlated with $V$ and/or $\tilde Q$, in general.

Once we have defined a set of groups, we define the *differential harm* for two groups $G_k$ and $G_l$ as
$$
  \Delta_{G_k-G_l}H(q) \dfeq \E[H(q)\mid I\in G_k] - \E[H(q)\mid I\in G_l].
$$
So $\Delta_{G_k-G_l}H(q)$ will be positive if voters in group $G_k$ are harmed at a higher rate than voters in group $G_l$, indicating that plan $q$ favors $G_l$ over $G_k$.

Zero differential harm between groups is analogous to the notion of *error rate balance* in the algorithmic fairness literature, which seeks to equalize false positive and false negative rates across protected classes [@zafar2017fairness; @chouldechova2017fair].
There, the implicit counterfactual is a perfect predictor.
Compared to the perfect predictor, the actual decision process harms individuals whenever it makes a false positive or false negative error.
Here, there can be no perfect districting plan, and the counterfactual instead consists of a collection of plausible alternatives.

Differential harm provides a unified framework for evaluating a districting plan across a variety of dimensions.
It is derived from an individual-level measure of representation and it accounts for the space of counterfactual possibilities.
Importantly, it separates *vote choice* from *group membership*, allowing one to discuss how partisan election outcomes under a specific districting plan create harm for specific groups or their interactions, simply by conditioning $H(q)$ on different sets of voters.

Estimating these quantities from available data is another matter, of course, and requires additional assumptions, as we describe in the methods section.

# Application to Partisan Gerrymandering in New Jersey {#sec-nj}

To demonstrate the proposed framework in a classic partisan gerrymandering context, we provide a brief analysis of congressional districting in the state of New Jersey.
We show that differential harm correctly identifies possible gerrymandering, in contrast to some common redistricting metrics.
Appendices [-@sec-app-nj] and [-@sec-app-corr] contain further comparisons between gerrymandering metrics.

Since 1995, New Jersey congressional redistricting has been handled by a 13-member commission, with 6 political appointees from each party and one independent chair with *de facto* tiebreaking authority.
@fig-nj-maps shows the baseline Democratic vote share by precinct, along with the Democratic and Republican commission proposals.[^8]
In a typical election, the Democratic proposal yields 9 Democratic and 3 Republican seats, while the Republican proposal gives a 7--5 split.

[^8]: The Democratic plan was enacted. The GOP plan was provided by Harrison Neely, executive director for the GOP delegation to the New Jersey Congressional Redistricting Committee, following an Open Public Records Act request.

```{r fig-nj-maps, fig.width=6.25}
#| fig.cap: |
#|      Baseline vote patterns (a), two hypothetical gerrymanders (b) and (c),
#|      and one randomly sampled counterfactual plan (d).
#|      County lines are overlaid in white.
include_graphics("figures/nj_maps.pdf")
```


For differential harm to measure gerrymandering, a counterfactual $\tilde Q$ drawn without partisan intent is needed.
To do so, we generate 10,000 districting plans without any partisan data, using the SMC algorithm of [@mccartan2020; implemented in @redist] setting constraints to favor compact plans that respect county lines.
@fig-nj-maps(d) shows one such plan.
For each of these sampled plans and the two proposals, we estimate the average harm and differential partisan harm versus the simulated baseline,[^9] and calculate the expected number of Democratic seats and several common partisan metrics.
These measures, and their distribution in the basline, are shown in @fig-nj-meas.

[^9]: We choose to calculate $\Delta_{\dem-\rep}H(q)$, so positive values correspond to a Republican-favoring plan.

The estimate of differential partisan harm aligns with the expected partisan skew of each plan, with a value of $-3.6\%$ for the Democratic proposal and $2.0\%$ for the Republican proposal.
This means that, for example, an average Democratic voter is $3.6$pp less likely to be misrepresented than their average Republican counter-partisan.
Overall, the Democratic plan has lower average harm.

```{r fig-nj-meas, fig.width=7}
#| fig.cap: |
#|      The distribution of the existing and proposed measures across
#|      a sample of 10,000 plans,
#|      with the values for two gerrymanders overlaid as vertical lines.
#|      The dashed line indicates a value of zero.
include_graphics("figures/nj_meas.pdf")
```

Most of the other metrics, with the notable exceptions of the mean-median and partisan dislocation measure, agree with differential harm that each party's proposal favors itself.
The efficiency gap and partisan bias estimate give roughly equal scores in absolute value to the Democratic and Republican plans, in comparison to differential harm and declination, which identify the Democratic proposal as slightly more extreme.

The raw metrics can be better contextualized in comparison to the distribution across the sampled plans, something we discuss in [Appendix @sec-app-nj].
That appendix also compares the correlations between the various metrics in the simulated sample.
We find strong correlations of differential harm with the number of seats won by each party, while several common metrics like the mean-median gap and partisan bias are very weakly correlated with seats won.

# Application to Voting Rights Litigation in Alabama {#sec-alabama}

We next apply our proposed framework to @2022merrill, ongoing VRA litigation in which civil rights groups have argued that the existing Black majority district packs Black voters, and so a second Black opportunity-to-elect district should be drawn.
Measuring differential harm by both race and party will allow us to cleanly separate the racial and partisan effects of the Alabama districting plan, something existing approaches are unable to do.

Plaintiffs had to satisfy the first *Gingles* criterion by submitting one or more remedial maps demonstrating that a new Black opportunity-to-elect district could be drawn while meeting all other redistricting requirements.
In *Allen*, the plaintiff's expert, Moon Duchin, submitted four such plans, one of which is shown in @fig-al-maps(e).
A uniform distribution over these plans forms a natural counterfactual $\tilde Q$ to use in analyzing the challenged districting plan (@fig-al-maps(d)), especially since the district court ruled in favor of the plaintiffs and found that their remedial plans satisfied the first *Gingles* criterion.
In [Appendix @sec-app-alsampling], we repeat the analysis performed here on a different counterfactual consisting of plans sampled with a redistricting simulation algorithm; the results are broadly similar.

```{r fig-al-maps, fig.width=6.75}
#| fig.cap: |
#|      Top row: baseline vote patterns (a),
#|      fraction of the voting-age population which is Black (b),
#|      the expected fraction of voters in each precinct which are harmed by
#|      the 2020 enacted congressional districts versus the set of four remedial
#|      plans (c).
#|      2020 enacted district boundaries are overlaid
#|      in black on the leftmost map and in white on the other maps.
#|      Bottom row: the challenged plan and a submitted remedial plan
#|      (d) and (e) colored by each district's Black share of the voting-age
#|      population, and the expected number of harmed voters in each
#|      race/partisan group, relative to the total number of such voters (f).
include_graphics("figures/al_maps.pdf")
```

This analysis is slightly more complicated than in New Jersey, since in order to understand the racial distribution of harm we need to estimate turnout and voting preferences by race.
As we describe in the methods section, this is accomplished with an ecological inference model.
The estimates confirm that voting is highly polarized by race outside of the cities of Birmingham and Montgomery.

With these estimates in hand, @fig-al-maps(c) shows the average number of voters harmed in each precinct, and @fig-al-maps(f) summarizes harm by party and race.
Harm is concentrated among Black and Democratic voters in Birmingham, Montgomery, and the southern end of the Black Belt region.
These areas are excluded from the Black-majority district under the challenged plan, but are included in a Black-majority district in the average remedial plan.

Across the state, the estimated average harm is $7.9\%$.
The expected harm for a Black Democrat is $22\%$, for a Black Republican is $3.7\%$, for a White Democrat is $8.3\%$, and for a White Republican is $1.7\%$.
Thus while the challenged plan differentially harms both Black voters and Democratic voters, it *especially* harms Black Democrats, who have an estimated differential harm of $13.8\%$ versus White Democrats and of $18.3\%$ versus Black Republicans.

These calculations are made by aggregating harm within racial groups at the precinct level, and so they automatically take into account individual voter preferences.
Unlike in a traditional *Gingles* analysis, there is no need to identify a particular party as the uniform statewide "choice" of the minority racial group, nor is there any cause for concern because of lower racial voting polarization in urban areas.
The harm measure also treats voters of every race and location equally, recording just their inability to elect their preferred candidate.
<!-- Only once we have aggregated these individual harms does it become apparent that the challenged plan concentrates the harm among certain groups of voters. -->

# Application to Primary Elections in Boston {#sec-boston}

The proposed harm measures are particularly easy to calculate in two-party elections, since the preferences of each kind of partisan are directly observable as partisan vote shares.
However, the same framework can be fruitfully applied to more complex settings, providing insights unavailable with traditional methods.

A challenge in voting rights law and research are settings where racially polarized voting occurs in primary elections or nonpartisan races, where it is difficult to observe due to the lack of party labels.
This is the case in many cities, where the Democratic primary often is the *de facto* general election.
The resulting uncertainty leads to arguments about the proper role of race in drawing urban legislative districts.

This section studies how the current Boston city council district boundaries differentially harm Black voters, versus a race-neutral districting process.
In Boston, nine councilors are elected from contiguous districts, shown in @fig-boston-map alongside a demographic map, and the remaining four are elected at-large.

```{r fig-boston-map, fig.width=6.75, fig.height=3.375}
#| fig.cap: |
#|      Racial composition of the city of Boston (left)
#|      and 2010 city council districts (right).
#|      Neighborhood boundaries are overlaid in black on the
#|      left map and in white on the right map.
include_graphics("figures/boston_map.pdf")
```

To conduct our analysis, we must be able to predict individual preferences under counterfactual districting plans.
This is more difficult than in both New Jersey and Alabama.
First, the lack of party labels in city council races means that voting choices are more complex than a simple partisan preference.
<!-- To estimate election outcomes, we must map observed support for particular candidates in one election onto counterfactual support for a hypothetical slate in another election. -->
Second, as in Alabama, we aim to examine the racial impact of the district system, and so must estimate these voting preferences by race.
<!-- Even if we could, for instance, divide candidates into a more "liberal" and a more "conservative" group, the vote counts for each group by precinct will not alone show how different racial groups voted. -->

```{r fig-boston-factors, fig.width=7, fig.height=3.5}
#| fig.cap: |
#|      Candidate factor loadings from the latent EI model,
#|      with approximate 80\% credible intervals shown as ellipses (left),
#|      and geographic variation in factor values by race (right).
#|      Neighborhood boundaries overlaid in black.
#|      Factor values in the Black second-dimension map are truncated so that variation in the other maps is visible.
include_graphics("figures/boston_factors.pdf")
```

To solve both of these problems, we develop a *latent factor ecological inference model*, which simultaneously estimates (a) turnout by precinct and race, (b) candidate positions in a latent two-dimensional political space, and (c) voter preferences in this space by precinct and race.
@fig-boston-factors shows the key outputs from this model, and the methods section explains the model in more detail.
This is a different modeling approach than the stochastic uniform swing model used in the previous two applications, but the harm framework is designed to accommodate such modeling flexibility.

The first dimension estimated by the model primarily aligns with a traditional liberal-conservative spectrum, with progressives like Bernie Sanders and current Boston mayor Michelle Wu on the left, and centrists like Joseph R. Biden and Wu's opponent, Annissa Essaibi-George, on the right.
The second dimension appears to capture racial differences in support---as the factor value maps in @fig-boston-factors show, minority-majority and White areas of the city take opposite values on the second dimension, demonstrating racial polarization.

To evaluate harm in a typical council election, we consider two scenarios, one in which all of the council races are contested along the ideological (first) dimension, and one in which the races are contested along the racial (second) dimension.
Matching the research question, our counterfactual plans are drawn from a race-blind districting simulation.

For the first scenario, we estimate that the enacted plan differentially harms White voters at a rate of only $0.79\%$ compared to the race-neutral baseline.
For the second scenario, we estimate that the enacted plan differentially harms White voters at a rate of $4.1\%$.

These findings suggest that despite the dominance of the Democratic party in city politics, and the shared preferences between certain groups of Black and White voters, race-aware districting still serves an important role in empowering Black voters across the city to elect their chosen candidates.
<!-- Further study could focus on the racial impact of the four at-large members in comparison to a system with 13 districts and no at-large members. -->

<!-- These two harm estimates reflect the harm of the current boundaries compared to a race-neutral baseline.
The more policy-relevant direction might be in evaluating a change from the status quo.
What is the harm of switching to race-neutral districting from the current race-aware boundaries?
We can flip the above setup and compute harm by averaging over the simulated plans with the enacted plan as the counterfactual.
For this reverse comparison, along the first dimension, we estimate that a race-neutral baseline would differentially harm Black voters at a rate of 3.1% compared to the enacted plan Along the second dimension, the differential harm to Black voters would be 1.8%. -->

# Discussion {#sec-discussion}

We offer a new framework for studying redistricting that brings together a focus on individual voter preferences and the causal-inference logic of counterfactuals.
The combination of these ideas imbues the analysis of districting plans with historical understandings of legal standing and harm.

A key advantage of the harm framework is that it applies without modification beyond partisanship, so that harms can be measured by race or other protected groups.
By centering the framework on individual voters' choices, we sidestep the need to blindly associate voters' preferences with their group memberships.
As @sec-boston showed, this opens up space for more nuanced analyses that can extend to the local level as well.

The proposed framework is not without important limitations, however, which present opportunities for future study.
The flexibility of choosing a model for counterfactual plans and hypothetical election outcomes also creates possibly large sensitivity to those choices.
<!-- Fundamentally, harm and differential harm are unable to measure plans against an absolute benchmark, the way that other measures such as partisan symmetry are able to do. -->
Simple election models are computationally tractable and require minimal data, but grossly simplify reality.
More realistic models can add a significant burden to the calculation of our harm measures.
And while modern simulation methods are a valuable starting point for defining counterfactual plans, these approaches involve analyst discretion and interpretation of often-murky legal standards.

One limitation of the harm definition itself is that considers only individuals who vote; abstainers experience zero harm.
A richer framework and the use of auxiliary survey data might allow consideration of the informal preferences of the whole population, even when those preferences are not expressed at the ballot box.

A second limitation is that the harm definition ignores any preferences a voter may have between the candidates that they did not vote for.
For example, a voter may consider candidates A and B nearly interchangeable, but may strongly dislike candidate C.
The simple cost function implicitly assumed in our proposed measure does not differentiate between candidates B or C winning the district.
The problem could be remedied by replacing the indicator functions in the measure with other cost functions that consider ordinal preferences.
For example, in our Boston example, the distance in latent space between a voter's ideal point and the winning candidate's position could be used.

At its core, redistricting is a multifaceted and high-dimensional problem that must balance political, legal, and administrative constraints to allow citizens to exercise their rights.
A districting plan can never be boiled down to a single number.
But we hope our approach provides a modular and flexible set of measures that can help decompose how various components of the districting plan combine to produce observed patterns and election outcomes.
Researchers can and should tinker with our assumptions and push our framework further to better apply it to multi-candidate elections, more realistic election models, and beyond district-based electoral systems.

# Methods {#sec-methods}

This section discusses estimating the proposed harm measures from real data, and provides details on the analyses conducted for the three applications in the main text.

## Estimating the harm measures {#sec-estimating}

Harm $H(q)$ and differential harm $\Delta H(q)$ as defined above require specification of a probability distribution on elections and districting plans.
Depending on one's viewpoint, this is either a theoretical fiction which must be specified by a model, or an actual data-generating process we must estimate.
Either way, past election data and an enacted districting plan alone are not enough to calculate these measures.

### Modeling Districting Plans

It is difficult to construct a tractable probability distribution for districting plans, since the space of plans is discrete and lacks a natural metric structure.
Thankfully, in recent years a number of algorithms have been developed which sample districting plans from specific distributions [@fifield2020mcmc; @deford2019; @carter2019; @mccartan2020].
These distributions can generally be characterized as maximum-entropy distributions on the space of all valid districting plans, in combination with several moment constraints.

For example, the algorithms of @carter2019 and @mccartan2020 sample from the maximum-entropy distribution of districting plans that are geographically contiguous, have district populations within a specified deviation from equality, and which have a certain average compactness value (according to a particular graph-theoretic compactness measure).
These maximum-entropy distributions put as few conditions as possible on the districting sampling process, as long as a set of constraints imposed by the researcher are met.
If these constraints are precisely those which are required by law or traditional redistricting criteria, then samples from this distribution provide a natural set of counterfactual districting plans, uninfluenced by superfluous partisan or other considerations, to use in estimating $H(q)$ and $\Delta H(q)$.
In practice, the translation from tradition and law into mathematical formulations of constraints is not always clear or even well-defined.
There is certainly an element of subjectivity in sampling a set of districting plans.
Nonetheless, sampling methods are widely used in practice [see e.g., @2019rucho; @2018league; @2022merrill; @becker2021computational; @chen:rodd:13].

### Modeling Election Outcomes

Election results present a different set of modeling challenges, given the large number of factors that influence election outcomes and the general unpredictability of future events.
We limit our discussion here to the case of estimating harm and differential partisan harm in a two-party setting.
Estimating differential racial harm in the two-party setting can be done by first generating ecological inferences or survey estimates of party preference by race, and then applying methods analogous to those outlined here.
Multiparty or primary elections pose additional modeling challenges.
In @sec-boston we consider a spatial-racial model for primary elections with multiple candidates, to illustrate the application of our framework to these more complicated cases.

Motivated primarily by computational convenience and simplicity, we recommend for most cases the stochastic uniform partisan swing model of @gelman1994unified, modeling the Democratic two-party vote share in district $d$ and election $v$ as
$$
    s_{dv} = \bar{s}_d + \delta_v + \varepsilon_{dv},
$$
where $\bar{s}_d$ is the baseline Democratic vote share in the districts, $\delta_v\sim\Norm(0, \sigma^2_\delta)$ is a election-specific uniform shift, and $\varepsilon_{dv}\sim\Norm(0, \sigma^2_\varepsilon)$ is a district-election residual error term.
This can be thought of as a hiererchical extension of the classic uniform swing model.

The baseline $\bar{s}_d$ can be established by averaging the results of all available statewide elections over the past decade or other suitable period.
This is done at the precinct level, since this is the most granular level that districting plans are usually built from and election returns are reported at.[^14]
Since $\bar{s}_d$ is calculated for the particular configuration of district $d$, this model takes into account the specific districting plan under consideration.

[^14]: When district boundaries split precincts, practitioners generally impute the returns in each component of the split precinct by population-weighted interpolation.
    Population information comes from Census blocks, which, when populated, are practically never split.

To estimate $\sigma^2_\delta$ and $\sigma^2_\varepsilon$, we use historical U.S. congressional election returns from 1976-2020, provided by the MIT Election Data Science Lab (<https://doi.org/10.7910/DVN/IG0UN2>).
We discard elections which were uncontested by either party, or which had more than one Democratic or Republican candidate, leaving 5,931 total elections.
The data do not have complete coverage, and some states are missing or represented very sparsely.
However, there are 38 states with at least 20 elections.

For each election, we compute the two-party Democratic vote share.
We fit a linear mixed-effects model to these vote shares, with an overall intercept fixed effect, and random effects for districts and election years.
To account for the fact that district boundaries change every decade, the district identifiers are built as a concatenation of the state, district number, and redistricting.
For example, Washington's 7th congressional district receives one random effect from 2002-2010 and a different random effect from 2012-2020, since new district boundaries were enacted in the 2010-2012 period.
We do not account for any mid-decade redistricting which may occur as a result of litigation.

The estimated standard deviations of the random effects are $\hat{\sigma}_\delta=0.0266$ for the election-year shocks and $\hat{\sigma}_\varepsilon=0.0653$ for the election-district-specific effects.
We substitute these point estimates directly into our election model.
While this has the advantage of simplicity, it does not account for uncertainty in the estimates.

One implication of the model presented here is that it rules out any mechanism whereby voters reward or punish the parties based on the plan enacted: $q$ itself does not show up in the model.
Indirect effects, such as $q$ affecting the type of candidates who run, and therefore the vote share each party wins, are also ruled out, or at least on average: the residual $\varepsilon_{dv}$ captures candidate effects broadly, but it is assumed to be drawn independently of $q$.
To the extent that a particular $q$ affects voter turnout or vote choice in these ways, the simple model presented here will not capture those effects.

More complicated election outcome models are certainly possible and are straightforward to use with the measures proposed here.
For example, one could operate on the logit scale, model incumbency effects, or include additional data from local elections.

However, the simple model presented here does a reasonable job of capturing the distribution in future elections.
@kenny2023widespread (Appendix D) validated the model in a similar redistricting context and found it to perform well.



### Calculating Harm and Differential Harm

With a model for election outcomes and districting plans in hand, calculation of $H(q)$ and $\Delta H(q)$ is straightforward.
For each sampled counterfactual districting plan $\tilde q$, we use the election model to simulate vote shares in each district of $q$ and $\tilde q$.
We can then identify, for each precinct, how many Democratic or Republican voters were harmed.[^2]
We tally the total harm done to Democratic and Republican voters across the map and divide by the appropriate totals to get a single draw of $H(q)\mid I\in\dem$ and $H(q)\mid I\in\rep$.
When other groups (such as racial groups) are used in $\Delta H(q)$, we must repeat these computations for each group.
Finally, we average across all of the samples, and add or subtract across groups, to produce estimates of $E[H(q)]$ and $\Delta_{\dem-\rep} H(q)$.

[^2]: For this, we use the baseline count of Democratic or Republican votes.
    This is a slight simplification, since the vote share changes across random draws, and so the number of Democratic and Republican voters changes too.
    To deal with this issue completely, one must model elections at the precinct level, which requires more data and computational costs.


## Ecological inference model for Alabama {#sec-alei}

To estimate voter preferences by race and precinct in Alabama, we use 2020 U.S.
Census demographic data and election returns from seven recent statewide elections: the 2016 races for president and U.S. senator, the 2018 races for governor, attorney general, and secretary of state, and the 2020 races for president and U.S. senator.
Our ecological inference model used to produce the estimates is broadly similar to that of @king1997solution.
However, it jointly estimates both turnout and Democratic support across all seven elections, rather than estimating each quantity separately for each election.

For precinct $j$ in election $v$, let $\vap_j$ denote the voting-age population, $n_{jv}$ denote the total number of votes cast for major-party candidates, $s_{jv}$ denote the Democratic vote share, and $p_{jr}$ denote the fraction of the voting-age population belonging to racial group $r$, where here $r\in\{\text{White},\text{Black},\text{Other}\}$.
Our main parameters of interest are $\turn_{jr}$ and $\supp_{jr}$, the baseline turnout and Democratic support rate by race in the precinct.

We model the observed turnout $n_{jv}$ and vote counts $s_{jk}n_{jv}$ as
\begin{align*}
    n_{jv} \mid \turn_{jr}, \beta^{(t)}_v
        &\sim \Binlog\qty(\vap_j, \logit(\turn_j^\top\vb p_j) + \beta^{(t)}_v) \\
    \logit(\turn_j) \mid \mu^{(t)}, \Sigma^{(t)}
        &\sim \Norm(\mu^{(t)}, \Sigma^{(t)}) \\
    s_{jv}n_{jv} \mid \supp_{jr}, \turn_{jr}, \beta^{(s)}_v
        &\sim \Binlog\qty(n_{jv}, \logit\qty(
        \supp_j^\top \frac{\turn_j\circ\vb p_j}{\turn_j^\top\vb p_j}) + \beta^{(s)}_v) \\
    \logit(\supp_j) \mid \mu^{(s)}, \Sigma^{(s)}
        &\sim \Norm(\mu^{(s)}, \Sigma^{(t)}),
\end{align*}
where the $\vb*\beta^{(t)}$ and $\vb*\beta^{(s)}$ model election-specific logit shifts, $\Binlog$ indicates the Binomial distribution with the probability parameter specified on the logit scale, and $\circ$ indicates the element-wise (Hadamard) product.
We give $\vb*\beta^{(t)}$ an i.i.d. $\Norm(0, 0.6^2)$ prior,and $\vb*\beta^{(s)}$ an i.i.d. $\Norm(0, 0.4^2)$ prior, and $\mu^{(t)}$ an i.i.d. $\Norm(0, 1.5^2)$ prior.
We set priors independently on the variance and correlation components of $\Sigma^{(t)}$ and $\Sigma^{(s)}$.
The former received $\Gam(1.5, 1.5/0.5)$ and $\Gam(1.5, 1.5/0.25)$ priors for turnout and support, while the latter received uniform priors (i.e., LKJ priors with shape parameter 1).
Several reparametrizations are made for computational efficiency.
The full Stan model is included in the replication code.

```{r fig-alabama-ei, fig.width=6.5}
#| fig.cap: |
#|      Model estimates of precinct-level turnout by race (a)
#|      and Democratic support by race (b).
#|      Points are sized in proportion to their voting-age population,
#|      and colored according to their Black share of the voting-age population.
#|      All axes are transformed to a logit scale.
include_graphics("figures/al_ei.pdf")
```

The mean support $\mu^{(s)}$ receives an informative prior based on the racially polarized voting estimates of @kuriwaki2021geography, with $\mu^{(s)}\sim\Norm(\logit((0.18, 0.90, 0.35)), (0.03^2, 0.03^2, 0.2^2))$.
These estimates were derived through multilevel regression and poststratification from survey data, calibrated to actual election results.

The model was fitted with a mean-field variational approximation for computational efficiency.
Posterior medians of $\turn_{jr}$ and $\supp_{jr}$ are plotted in @fig-alabama-ei.
These estimates broadly track with the findings of the voting rights expert retained in *Allen*.

## Boston application methods {#sec-bos-methods}

### Latent factor ecological inference model {#sec-lfei}

To estimate voter preferences by race and precinct in Boston, we use 2020 U.S.
Census demographic data and election returns from the March 2020 presidential primary and the September 2021 mayoral preliminary elections.
Our ecological inference model used to produce the estimates expands on the model in @sec-alei, jointly estimating both turnout and vote choice in the two elections.
However, it estimates voter preferences in a two-dimensional latent space and also estimates candidates' positions in this space.

Continuing the notation from above, for precinct $j$ in election $v$, let $\vap_j$ denote the voting-age population, $n_{jv}$ denote the total number of votes cast for major-party candidates, $s_{jk}$ denote the vote share for candidate $k$ (who implicitly belongs to a particular election $v_k$), and $p_{jr}$ denote the fraction of the voting-age population belonging to racial group $r$, where here $r\in\{\text{White},\text{Black},\text{Hispanic},\text{Other}\}$ ("Other" consisting primarily of Asian voters in Boston).
Our main parameters of interest are $\turn_{jr}$, the baseline turnout by race and precinct, $F_{jqr}$, the preferences in latent dimension $q$ by race and precinct, and $L_{kq}$, the loading of each candidate on latent dimension $q$.
Here $q\in\{1,2\}$, since preliminary analyses found no improved fit when expanding to three dimensions.

We model the observed turnout $n_{jv}$ identically as in Alabama, above:
\begin{align*}
    n_{jv} \mid \turn_{jr}, \beta^{(t)}_v
        &\sim \Binlog\qty(\vap_j, \logit(\turn_j^\top\vb p_j) + \beta^{(t)}_v) \\
    \logit(\turn_j) \mid \mu^{(t)}, \Sigma^{(t)}
        &\sim \Norm(\mu^{(t)}, \Sigma^{(t)}).
\end{align*}

Because of the latent factor model, we do not require that vote shares by race and precinct, when tallied by race, necessarily equal the observed vote share in the precinct.
As a result we choose to model the vote shares directly, rather than the vote counts, which is more computationally efficient.
Because each precinct has dozens or hundreds of voters, a Normal approximation to the Binomial likelihood is appropriate, and so we model the vote shares $s_{jk}$ as
\begin{align*}
    \logit(s_{jk}) \mid \pi_{jk}, \eps &\sim \Norm(\pi_{jk}, \frac{\eps}{1+n_{jv_k}}),
\end{align*}
where $\pi_{jk}$ is the preference of precinct $j$ for candidate $k$ on the logit scale, as detailed below.
The Normal approximation variance is inversely proportional to the total number of votes in the precinct (the additional 1 is to avoid divide-by-zero errors).
The multiplicative factor $\eps$ captures the additional variance that isn't accounted for by the latent factors.

The logit candidate preference itself is modeled as
\begin{align*}
    \pi_{jk} &= \beta^{(s)}_k + \alpha_k
        F_{j}^\top(\turn_j\circ \vb p_j)^\top\mathrm{diag}(\vb*\rho)\vb L_k  \\
    F_{jq} \mid \Sigma^{(p)} &\sim \Norm(0, \Sigma^{(p)}).
\end{align*}
We use a two-dimensional factor model, since exploratory analyses found that three latent dimensions did not provide a substantially better fit to the data.
Note that $F_j$ is a $q\times r$ matrix of preferences by race and dimension within precinct $j$, and $\turn_j\circ \vb p_j$ is a vector of the percentages of the total VAP in the precinct that belongs to voters of each race, so $F_{j}^\top(\turn_j\circ \vb p_j)$ is a vector with $q$ elements containing the preferences by dimension of the precinct's voters, after marginalizing out race.
The matrix $\mathrm{diag}(\vb*\rho)$ captures the relative scale or importance of each dimension to the overall outcomes.
The $\vb*\alpha$ parameters are "fudge factors" that adjust the scale of the deviations from each candidate's average support.

We give $\vb*\beta^{(t)}$ an i.i.d. $\Norm(0, 0.5^2)$ prior,and $\vb*\beta^{(s)}$ an i.i.d. $\Norm(0, 4.0^2)$ prior, and $\logit(\mu^{(t)})$ an i.i.d. $\Beta(10, 30)$ prior.
We set priors independently on the variance and correlation components of $\Sigma^{(t)}$ and $\Sigma^{(p)}$.
The former has $\Gam(1.5, 1.5/0.25)$ and $\Gam(1.5, 1.5/1.0)$ priors for turnout and support, while the latter have LKJ priors with shape parameters 4.0 and 20.0.
A larger LKJ shape parameter places more weight on correlation matrices closer to diagonal, i.e., it regularizes away from high correlations.
The scale parameters $\vb*\rho$ have i.i.d. $\Gam(1.5, 1.5/4.0)$ priors, the fudge factors $\vb*\alpha$ have i.i.d. $\Gam(5.0, 5.0)$ priors, and $\eps$ has an $\Expo(1/4.0)$ prior.
Overall, these priors weakly identify the location and scale of the parameters.
Several reparametrizations were made for computational efficiency.
The full Stan code for the model is available as part of the replication code.

Like all probabilistic factor models, ours is unidentifiable due to the rotation, location, and scale invariance of the factors in the likelihood.
To identify the location and scale, we place $\Norm(0,1)$ priors on most components of $\vb L$.
To identify the rotation, we place more informative priors on the loadings of certain candidates.
This was accomplished through somewhat of an interactive process, where a preliminary principal components decomposition of the precinct vote shares helped suggest the latent factors that might be found by the model.
We chose to align the first dimension with the Sanders-Biden axis, and chose to make the second dimension roughly orthogonal along the Janey-Buttigieg axis.
This translated to a prior of $\Norm((-1, 0), (0.1^2, 0.25^2))$ for Sanders, $\Norm((1, 0), (1.0^2, 0.5^2))$ for Biden, and $\Norm((-0.25, -1), (0.5^2, 2^2))$ for Janey.
We additionally set the prior correlation between Sanders' and Biden's loadings to be $(-0.5, 0.8)$.

The estimated loading matrix $\vb L$ is visualized on the left of @fig-boston-factors, and $F$ is visualized for Black and White voters on the right.

```{r fig-boston-gen-pred, fig.width=6.5}
#| fig.cap: |
#|      Model predictions of general election vote shares and turnout,
#|      compared to actual general election results.
#|      Red reference line indicates perfect agreement.
include_graphics("figures/boston_gen_pred.pdf")
```

Like all ecological inference models, this one makes several assumptions, verifiable and unverifiable.
We stress that the latent factor ecological inference model is not necessary for this kind of analysis; it is one out of several approaches which could provide estimated vote choices for individuals.
Local survey data with ideological preferences and racial information would be a sufficient alternative.
We assume no spatial correlation in residuals, when some is almost certainly present.
We place distributional assumptions on how voter preferences by races vary across precincts (importantly, that these preferences are centered around a common location).
And we of course impose a latent two-dimensional factor structure, which must always be a major simplification of reality.

To test the suitability of the model for representing the outcomes of hypothetical future elections, we use the model fitted to the primary elections to predict the outcome of the mayoral general election in November 2021.
Michelle Wu and Annissa Essaibi-George advanced to the general from the preliminary election.
We fix the model's loading matrix $\vb L$ to the posterior mean of their estimated loadings.
We draw $s_{jk}$ from a $\Beta(20\bar s, 20(1-\bar s))$ distribution, where $\bar s$ is each candidate's share of the two-candidate vote from the preliminary election (59.7% Wu -- 40.3% Essaibi George).

The model's predictions (posterior medians) for the turnout and vote share in each precinct are shown in @fig-boston-gen-pred.
Considering the differences between a primary and general election, and the additional campaign time elapsed between the elections, the predictions are remarkably accurate.
The predicted turnout has a Spearman correlation of 0.84 with the actual turnout, and the predicted and actual vote shares have a correlation 0.87.
The turnout and support levels are also in relatively close agreement.
The accuracy of these validation predictions tracks with previous work using factor models to predict runoff outcomes after a first-stage election [@kamakura2006modeling].

We stress that the latent factor ecological inference model is not necessary for this kind of analysis; it is one out of several approaches which could provide estimated vote choices for individuals.
Local survey data with ideological preferences and racial information would be a sufficient alternative.

### Election scenarios

We analyze two different scenarios: one in which all of the council races are contested along the first latent dimension, and one in which the races are contested along the second.
Specifically, we draw voter choices between two candidates from the posterior predictive distribution of our model, setting the candidates' loadings to --1 and 1 on the chosen dimension and 0 on the other dimension.
We draw the overall level of support from a $\Beta(15, 15)$ distribution, which means that we will study election scenarios where the overall vote share for each bloc of candidates ranges from roughly 30 to 70 percent.
The posterior predictive draws yield counts of voters for each candidate in each precinct by race, from which we can calculate winners at the district level, under any configuration of districts.

Our hypothetical elections involve only two candidates, to simplify the challenges of measuring harm with multiple candidates, over which voters may have different ranked preferences.
However, our use of latent factors provides one way to extend our harm framework to the multiple-candidate setting.
One could weight voter harm by the distance in latent space between each voter's preferred candidate and the elected candidate, thus dropping the implicit assumption in the definition of harm that all candidates the voter did not vote for are interchangeable.

We sample 2,000 districting plans across two independent runs of the SMC algorithm of @mccartan2020
In Boston, council districts must be equipopulous, be compact, and preserve neighborhood and community boundaries.[^11]
In sampling, we therefore set constraints to favor compact plans that respect neighborhood boundaries.
Since we do not provide any racial information to the algorithm, this set of plans forms a good approximation of a race-neutral districting process.

[^11]: City of Boston charter.
    Available at <https://www.boston.gov/sites/default/files/embed/b/boston-city-charter-2007.pdf>.

# Data availability {.unnumbered}
All data are publicly available and are included in the replication package for the manuscript.

# Code availability {.unnumbered}
All code is included in the replication package for the manuscript.

::: {#refs}
:::

```{=tex}
\vspace{1in}
\appendix
\renewcommand\thefigure{\thesection.\arabic{figure}}
\renewcommand\thetable{\thesection.\arabic{table}}
\setcounter{figure}{0}
\setcounter{table}{0}
```


# Connections to Current Practice for Analyzing Partisan and Racial Gerrymandering {#sec-connections .appendix}

A primary advantage of our proposed harm measures is that they are defined at the individual level, allowing for the study of redistricting for any defined group memberships.
For political science, two of the most important group memberships are perhaps race and party.
Even in these well-studied contexts, our measures provide an improvement over existing analytical approaches.

## Racial Vote Dilution {#sec-racial}

The study of racial gerrymandering and vote dilution is considerably more complicated than that of partisan gerrymandering, due to the difficulty of understanding racial voting preferences when individual votes are secret.
No simple formulas exist to measure the precise racial impacts of a districting plan.
Indeed, much of the academic literature has focused on the statistical challenges of estimating vote preferences and turnout by race [@king1997solution; @greiner2006ecological; @imai2016improving].

Modern analyses of vote dilution and racial gerrymandering are inseparable from the Voting Rights Act of 1965 (VRA) and the 14th and 15 Amendments.
Section 2 of the VRA enables citizens to challenge districting plans in court for diluting the voting power of racial minorities.
Under the current framework for vote dilution established by @1986gingles, plaintiffs must prove that (a) the minority group is large and geographically compact enough to form a majority in some hypothetical district, (b) the minority group is "politically cohesive," and (c) the majority group can and does vote to deny the minority group its choice of candidate [@hood2018legal] (the so-called *Gingles* criteria).
Criteria (a) is generally proven through a single example districting plan, while criteria (b) and (c) are shown using the statistical estimates of vote preferences and turnout by race.

While the specific legal requirements for a vote dilution claim will obviously remain front-and-center for court challenges of racial gerrymanders, our proposed harm measures unifies all three *Gingles* criteria.
Criteria (b) and (c) capture the misrepresentation of minority voters by a candidate they do not support, while (a) requires the existence of a counterfactual where this would not be the case and (a) and (c) together establish that minority voters are harmed.
But our proposed measures can also tackle trickier situations where the *Gingles* criteria may not be clearly met.

One such case arises when there are several distinct minority racial groups with similar preferences.
In these cases, some courts have found that (a) may be weakened to consider "coalition" districts that still allow minority voters overall to elect candidates of their choice, but there is no clear rule [@stephanopoulos2014south].
Or when urban White voters have similar partisan preferences to minority voters, (b) and (c) may not be strictly satisfied, especially for two-party general elections.
Some argue, however, that courts should still rely on the VRA in these cases to protect minority voters, especially in light of differing racial preferences in primary elections [@becker2021computational].

In both these cases, the proposed harm measures quantify the extent to which a challenged districting plan differentially harms minority voters.
They account for geographic sorting, political cohesion, and the individual preferences of every voter.
Sections @sec-alabama and @sec-boston demonstrate this approach in practice.

## Partisan Gerrymandering

The canonical framework for considering partisan fairness in redistricting is partisan symmetry [@king1987democratic]. Partisan symmetry implies that the seats $s$ won by a party with vote share $v$ would be satisfied if $s(v) = 1 - s(1 - v)$. In practice, the partisan symmetry framework is applied via the partisan bias metric $\beta(v)$, which measures the seat deviation from symmetry [@tufte1973pb; @katz2020], i.e., the number of seats that would need to be reallocated to reach partisan symmetry for a given statewide vote share $v$ (usually $\half$).

More recently, and particularly in the years since @2004vieth, researchers have developed a veritable zoo of measures to identify partisan gerrymanders.
The *mean-median* difference looks at the relationship between the vote share of the median seat in a delegation and the mean vote share of the delegation to make claims about how a map is skewed [@mcdonald2015unfair].
*Declination* describes the relative rate at which districts become less competitive for each party [@warrington18].
Perhaps the new measure which has reached the most acclaim is the *efficiency gap* [@stephanopoulos2015], which measures the difference in the number of the votes wasted by each party.[^3]

[^3]: Wasted votes are those cast for a losing candidate, as well as those cast for a winning candidate beyond the required 50% to win the election.
    They are exactly the votes which don't contribute to winning a seat.

The latter three metrics are grounded in intuition over how to reliably identify a partisan gerrymander, and not in the larger theoretical framework of partisan symmetry [@katz2020].
As such, they make no distinction between the quantity they are trying to estimate and a particular estimator or formula used in calculations.
This is in contrast to partisan symmetry as well as the proposed harm measures, which require practitioners to take the additional step of linking observed election data to the theoretical construct by way of an election model, as discussed in @sec-estimating.[^4]
This is an important conceptual distinction that is often lost in day-to-day applications of various gerrymandering measures.
Plugging in past election results without using an election model assumes too much about the stability of electoral dynamics and consequently can significantly understate the uncertainty in how a particular districting plan will perform into the future.

[^4]: For partisan bias, both researchers and practitioners have largely relied on simple uniform-shift models similar to the one we use in this work.

A quite different approach to measuring partisan gerrymandering is the partisan dislocation [@defoeubarodd21].
This measure uses a $k$-nearest-neighbor approach, where $k$ is the size of a district, to identify when a voter's district is politically different from their assigned district.
This can be repeated for  voter in a state or region, demonstrating at a local level when people been placed in a district which is atypical for who their nearest neighbors are.
When aggregated to the precinct-level, this can produce local measures of partisan gerrymandering, similar to our proposed differential partisan harm measure.

Since none of the existing measures, other than partisan dislocation, are centered on individual voters, they offer far less granular insights than the proposed harm framework, even in the case of studying partisan gerrymandering.
For example, differential harm can be estimated at the precinct level and then plotted on a map to show not just *which party* is harmed by a gerrymander, but *where* this harm occurs.

All of these existing measures are constructed so that a value of zero indicates no bias, and a value of zero is at least implicitly held up as a normative standard for districting plans.
In doing so, these measures allude to *implicit* counterfactuals.
For example, with partisan bias, the implicit electoral counterfactual is an election in which the parties' vote shares have been reversed, and the implicit counterfactual districting plan is one which assigns equal vote shares to the parties under both the real-world and counterfactual electoral scenarios.
Indeed, @katz2020 reference an implicit counterfactual in discussing the normative implications of partisan symmetry, writing that "[o]bviously, a process designed to be 'fair' that turns out to be substantially asymmetric [i.e., have nonzero partisan bias], if there is a fairer alternative, would not normally be regarded as a legitimate outcome." Similar implicit counterfactuals can be thought up for the other measures.

These implicit counterfactuals differ from the explicit counterfactuals we adopt in this work in that there is no guarantee they are possible.
@katz2020 and others recognize that a nonzero value in a measure like partisan bias can only be considered problematic "if there is a fairer alternative." The inability of partisan bias and other existing measures to explicitly account for realistic counterfactual districting plans means that none of them may be interpreted in a vacuum.
No particular value can be used as a threshold past which a plan becomes a gerrymander, because the measures confound the map-drawer's bias with the bias inherent to the electoral system's geography.

It is this confounding which explains many of the concerns that have been raised over the existing measures.
The standard calculation of partisan bias, $\beta(\half)$, can give unintuitive results in more lopsided states, which, if not interpreted carefully, can lead practitioners to make incorrect conclusions about the presence and direction of a partisan gerrymander.[^5]
And none of the measures take into account any aspect of political geography, and therefore suffer in states like Massachusetts, where, for example, the efficiency gap takes a value generally indicating an extreme Democratic gerrymander.

[^5]: This has been called by some the "Utah paradox" [@deford2020symmetry], though the paradoxical nature is contested as a mistake of using it for description, rather than inference [@katz2022].
    Even when interpreted carefully, however, partisan bias requires significant extrapolation from observed election outcomes in lopsided states---how realistic is it to evaluate the counterfactual where Democrats run even with Republicans statewide in Utah?

Despite these differences, there are also empirical similarities in many cases.
The efficiency gap is often highly correlated with estimates of differential partisan harm under a stochastic uniform partisan swing model (though the efficiency gap is much more discrete), as wasted votes and partisan harm are rooted in similar logic.[^6]
Similarly, in competitive states, where the baseline election has a statewide vote share near 50%, $\beta(\half)$ is highly correlated with the average number of seats won by each party and with estimates differential partisan harm as well.
Correlations, of course, are not everything: it is the universal scale and centering of our harm measure which makes it more useful in evaluating partisan gerrymanders, as we demonstrate in @sec-nj.

[^6]: The differences stem from the efficiency gap considering a vote to be wasted if it is in excess of the 50% threshold needed to win, while the harm framework does not penalize such votes, since every such voter is happily represented by their candidate of choice.
    This definition of wasted votes is also at the root of other criticisms of the efficiency gap, which note its tendency to penalize proportionality and reward 3-to-1 districts [@bernstein2017egap; @tamcho2017egap; @deford2020symmetry].

Finally, it is worth comparing the proposed measures to the increasingly common application redistricting simulation techniques to cases of partisan gerrymandering.
Standard practice in such litigation, for example, is to calculate a battery of gerrymandering metrics on the simulated plans, and show that the challenged plan is an outlier on all or most of the metrics: see, e.g., @2019rucho (report of Dr. Jonathan Mattingly) and @2018league (report of Dr. Wesley Pegden).
While this can help contextualize the challenged plan, it is not foolproof---if the underlying metric is misleading, it will still be misleading when applied to thousands of simulated plans.
In the worst cases, this can lead to directionally wrong conclusions.


# Additional New Jersey discussion {#sec-app-nj}

This section compares the partisan metrics from @sec-nj across the simulated baseline.
@fig-nj-pairs expands on @fig-nj-meas in the main text with pairwise scatter plots and correlation summaries.

```{r fig-nj-pairs, fig.width=7, fig.height=7}
#| fig.cap: |
#|      Scatterplots for all pairs of measures.
#|      The Democratic and Republican gerrymanders are shown
#|      with the blue and red lines and crosses.
#|      The dashed line indicates a value of zero.
#|      Below the diagonal, numbers indicate the absolute value of the correlation between variables.
include_graphics("figures/nj_pairs.pdf")
```


The Democratic proposal is expected to produce an average of 3.45 Republican seats under our election model, more than 79% of all sample plans.
The Republican proposal is an outlier, yielding fewer seats on average than every single sampled plan.
This pattern is repeated for all of the four common gerrymandering measures, where the Republican plan is a clear outlier (all $p=0.0002$, except $p=0.002$ for partisan bias) while the Democratic plan is not ($p=0.34$ for the efficiency gap, $0.50$ for declination, $0.88$ for partisan bias, and $0.17$ for the mean-median score).

The partisan dislocation measure [@defoeubarodd21] shows that the Democratic plan is typical ($p=0.24$) while the Republican plan is an outlier ($p=0.01$).
We use the vote-weighted measure of the average dislocation to produce a statewide summary.
We find that the sign is incorrect for the Democratic plan, which has a positive sign.
As the sign is positive for the simulations as well, this difference may be related to the fact that this measure uses the $k$ nearest neighbors, which is not uniform over the voters in the state.
Implicitly, voters in dense, urban areas will be counterd at a higher rate than those in rural areas.

Note that the Ranked Marginal Deviation [@herschlag2020quantifying] is not a signed measure.
All scores are at least zero, with low scores indicating that a plan is similar to the simulated plans.
In this analysis, the Democratic plan sits within the range of the sampled plans, while the Republican plan is an outlier ($p=0.0002$).

The estimate of differential harm already uses the simulation output, and so comparing the proposals to the sampling distribution is not strictly required.
However, it is notable that while the Democratic proposal has a more extreme estimate of differential partisan harm (1.6 percentage points higher), its value of $-3.7\%$ is not an outlier with respect to the distribution of differential harm for a randomly sampled plan ($p=0.43$, using the same set of samples as a counterfactual), while the Republican plan is ($p=0.0002$).
In other words, a *typical* nonpartisan districting plan is not necessarily a *fair* one, even in comparison to other similarly generated districting plans.
The sampled plan which minimizes estimated differential harm yields 8.18 expected Democratic seats, compared to a sample average of 8.41 seats, and the 6.8 seats that would be required for an outcome completely proportional to the parties' statewide vote share.

Both proposals are estimated to harm the average voter at a higher rate than most of the sampled plans, with the Republican plan again more extreme in this regard ($p=0.0008$ versus $p=0.061$ for the Democratic plan).
The plans which minimize estimated total harm are also those which have near-zero estimated differential partisan harm.
Thus, at least in New Jersey, overall harm reduction is consistent with a fair map on a partisan basis.
Minimizing bias with other measures, however, could lead one astray: plans which score an efficiency gap of zero can have estimated average harm as high as 17.2% and estimated differential harm as extreme as $-6.1\%$, nearly twice the value of the Democratic proposal.
Plans with zero partisan bias or mean-median score likewise are estimated to have higher-than-average harm and to tend to differentially harm Republicans.

@fig-nj-pairs appendix expands on @fig-nj-meas to also show the correlations between these various measures.
Expected Democratic seats, the differential harm estimates, the efficiency gap, and declination are all moderately correlated with each other.
Similarly, partisan bias and the mean-median score are moderately correlated, but very weakly correlated with the expected number of Democratic seats.
Thus there exist many plans which give Democrats a higher-than-average share of the seats, but which have partisan bias and mean-median score favoring Republicans.
New Jersey is just one state, and while some of the correlations between measures here are found in other states, some are not.
[Appendix @sec-app-corr] records these correlations across simulated plans in eight states.
The most consistent correlation is between estimated differential partisan harm and the expected number of seats won by each party, which averages 0.79 in the eight states we study.
Seats are, of course, more discrete and cannot directly identify the local areas where gains and losses are derived.

# Correlation Between Partisan Gerrymandering Metrics Across Multiple States {#sec-app-corr}

@tbl-corr reports the correlation between differential harm and the partisan gerrymandering metrics used in @sec-nj for eight states which cover a wide range of partisan leans and number of seats:

-   Utah, with 4 districts and a Democratic vote share baseline of $33$%
-   Mississippi, with 4 districts and a Democratic vote share baseline of $43$%
-   Iowa, with 4 districts and a Democratic vote share baseline of $46$%
-   North Carolina, with 14 districts and a Democratic vote share baseline of $50$%
-   Wisconsin, with 8 districts and a Democratic vote share baseline of $51$%
-   New Jersey, with 12 districts and a Democratic vote share baseline of $57$%
-   Massachusetts, with 9 districts and a Democratic vote share baseline of $61$%
-   California, with 52 districts and a Democratic vote share baseline of $65$%

The correlations are calculated across 5,000 simulated plans for each state.
The simulations are provided by the 50-State Simulation Project [@mccartan2022fiftystates].
In particular, the New Jersey simulations are not the same as those used in @sec-nj.

::: {#tbl-corr}

```{=tex}
\begin{center}
\input{figures/corr_table.tex}
\end{center}
```

Correlations between five gerrymandering metrics and partisan differential harm, for simulated districting plans from eight states. Declination is NA for Massachusetts since there are no Republican-leaning districts at baseline under any simulated plan.
:::


# Additional Sampling Analysis for Alabama {#sec-app-alsampling}

Here, we perform the same analysis as in @sec-alabama, but using a randomly sampled set of plans as a counterfactual, rather than the four plans used in litigation.
Specifically, we use 2,000 plans provided by the 50-State Simulation Project [@mccartan2022fiftystates].
These plans are designed to discourage packing of Black voters and maintain at least the same number of majority-opportunity districts as the enacted 2020 plan.

```{r fig-alabama-harm-sample, fig.width=6.5}
#| fig.cap: |
#|      On the left, the expected fraction of voters in each precinct which are
#|      harmed by the 2020 enacted congressional districts versus the sampled
#|      counterfactual set.
#|      On the right, the expected number of harmed voters in each race/partisan
#|      group, relative to the total number of such voters.
include_graphics("figures/al_harm_sample.pdf")
```
@fig-alabama-harm-sample summarizes the results, which are mostly similar to the results in in @sec-alabama.
Across the state, the estimated average harm is 6.9%, which translates to around 144,000 voters.
Of these harmed voters, around 56,000 are Black, while 88,000 are White.
Similarly, 73,000 are Democratic, while only 71,000 are Republican.
Normalizing by group sizes, the expected harm for a Black Democrat is 9.6%, for a Black Republican is 16.8%, for a White Democrat is 9.7%, and for a White Republican is 5.2%.
So the challenged plan differentially harms Democratic voters, but does not differentially harm Black Democrats versus White Democrats.
However, it it especially harms Black Republicans, who have an estimated differential harm of 7.2% versus Black Democrats and of 11.6% versus White Republicans.

