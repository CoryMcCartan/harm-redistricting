---
title: Individual Partisan Harm and Utility in Redistricting
authors:
  - name: Cory McCartan
    thanks: |
      To whom correspondence should be addressed. 
      The authors thank {you} for helpful comments and discussion.
    department: Department of Statistics
    affiliation: Harvard University
    location: Cambridge, MA
    email: cmccartan@fas.harvard.edu
  - name: Christopher T. Kenny
    department: Department of Government
    affiliation: Harvard University
    location: Cambridge, MA
    email: christopherkenny@fas.harvard.edu
abstract: |
  Most existing standards for assessing partisan gerrymandering focus on the symmetric treatment of parties by electoral systems. We develop measures of utility and harm for individual voters by considering counterfactual redistricting plans, and use these notions to construct a normative standard of partisan fairness which is centered on the individual. We calculate these measures on real-world data by leveraging recent advances in redistricting sampling methodology, which allow researchers to generate large numbers of districting plans which reflect local legal and practical requirements. We apply our measures to congressional redistricting in New Jersey, and compare them to existing measures of partisan symmetry and competitiveness.
keywords:
  - partisan fairness
  - representation
  - redistricting simulation
  - individual standing
bibliography: references.bib
biblio-style: apalike
output:
  rticles::arxiv_article:
    keep_tex: true
    includes:
      in_header: "header.tex"
    latex_engine: pdflatex
editor_options: 
  markdown: 
    wrap: sentence
---

```{r SETUP, include=FALSE}
library(knitr)
library(here)

opts_chunk$set(echo=FALSE, message=FALSE, warning=FALSE,
               fig.path=here("paper/figures/"), fig.align="center",
               fig.width=(8.5-2*1)/2, out.width="100%", fig.asp=0.8)
```

# Introduction

How do you measure a partisan gerrymander?
Researchers, courts, and the public may agree that gerrymandering involves the manipulation of district boundaries for political gain, but beyond this vague definition are liable to disagree on a particular operationalization.

Decades of academic literature on redistricting have focused on the fairness to parties.
The normative standard for redistricting in this line of research is for electoral outcomes to be symmetric across political parties---what is commonly referred to as *partisan symmetry* [@katz2020].
A variety of theoretical measures have been developed to capture this notion and to measure quantitatively any deviations from it.
These measures may generally (and, as some have argued, necessarily) be derived from the *seats-votes curve*, which relates the expected number of seats a party wins to its share of votes received.

The courts, meanwhile, have focused more on the impact an alleged gerrymander has on individual voters.
To proceed with a legal challenge to a gerrymander, a voter must demonstrate that their individual right to vote has been harmed by the gerrymander [@1964reynolds; @1962baker].

Crucially, for a voter to be harmed by a districting plan, there must exist another districting plan which remedies the harm.
An example we will return to frequently is that of a Massachusetts Republican: based on residential patterns of party voters, it is not possible to draw a Republican congressional district in Massachusetts, and so a Republican voter cannot be harmed by a districting plan that yields a fully Democratic delegation [@duch:18].

We argue that understanding the redistricting process requires a counterfactual set of feasible redistricting plans.
To that end, we define two individual utility measures for districting plans: a *local utility* capturing the value to a voter of having a representative of the same party, and a *global utility* reflecting the value in maximizing the number of seats awarded to a voter's chosen party.
From these two utility measures, we derive a measure of harm, based on counterfactual plans, and a notion of individual partisan fairness, which occurs when harms are evenly distributed across voters of each party.
Deviations from fairness are measured by *differential harm*, which, as we show, is intimately connected to the number of seats won by each party.

Taken together, our measures offer a framework for understanding the individual impacts of a districting plan, and how these impacts are borne by members of each party.
The use of counterfactual plans allows us to better relate legalistic interpretations of harm to those of political science.

To calculate these measures in practice requires generating counterfactual districting plans, for which we rely on advances in redistricting simulation methodology.
Early methodologies for simulating plans relied on randomness to generate many different districting plans [@ciri:darl:orou:00; @chen:rodd:13; @deford2019]. These methods greatly enhanced the understanding of redistricting within contexts of a particular state with set populations. Yet, lacking a specific target probability distribution, these heuristic approaches to simulation do not allow for probabilistic interpretations, and risk misrepresenting the total space of possible districting plans [@fifield2020essential]. Recent advances in Monte Carlo methods allow us move beyond random simulation and towards sampling plans from this definable space [@fifield2020mcmc; @carter2019; @mccartan2020]. We can thus develop a reliable set of counterfactual plans that can be tuned to reflect the constraints imposed by the laws and practices of a particular state [@matt:hers:21].

We offer a reminder that geographic context is key to understanding common problems in political science; elections themselves are geographically determined.
Recent research offers important resolution of the degree of partisan sorting in the US [@enos:brown:21].
By combining those understandings with the necessities of redistricting, we are able to expand the localized aspect of harm.
Further, we suggest that while the efficiency gap may not incorporate geographic information, it often helps capture individual harm better than other common measures.
This is a great benefit as an indicator to detect extreme gerrymanders in cases where sufficiently local geographic data to simulate plans is not available.
We further clarify that common existing measures of partisan fairness -- while they may capture the difficulties offered to a party -- do not necessarily capture the representational harms incurred by individuals who live in districts which do not at all represent their preferences.

## Running Examples

To illustrate the notation and measures we introduce, this article will make use of three running examples, which are stylized representations of U.S. states: Mininois, Minissouri, and Minichussets.
Mininois has one large Democratic city which can electorally dominate the rest of the state; Minissouri has two medium-sized cities which are not large enough to deliver a statewide Democratic majority; and Minichusetts has a uniform 3--2 Democratic split in every precinct.
Each example state has the same population and should be divided into 3 districts with population between 54 and 66.
Voters' preferences are assumed to be stable across elections, and turnout is 100%.
Schematics for these examples are shown in Figure \ref{fig:mini-schematic}(a)--(c).

```{r mini-schematic, fig.cap="Schematic maps of the three running examples, showing the partisan composition of each of the 36 precincts. The total voting population for each example is 180. White lines delineate precincts."}
include_graphics(here("paper/figures/minis_schematic.pdf"))
```

## Outline of the Paper

Section \ref{sec:voter-util} provides the necessary notation and introduces our measures of voter utility.
Section \ref{sec:indiv-harm} builds a measure of individual harm and a derived measure of partisan fairness from this notion of utility.
Section \ref{sec:estimating} discusses estimating these measures from observed election results.
Section \ref{sec:connections} connects our proposed measures to existing symmetry and fairness measures.
Section \ref{sec:empirical} applies the proposed measures to congressional redistricting in the state of New Jersey to illustrate their value and these comparisons.
Section \ref{sec:discussion} concludes.

# Voter Utility in Election Outcomes {#sec:voter-util}

The utility voters gain from a particular election outcome naturally varies across the electorate, depending on factors such as political engagement, partisanship, race and ethnicity, individual policy preferences, and individual candidate attributes.
Here, we restrict our attention to what we believe are the two dominant contributors to partisan utility: which party represents a voter's district, and how many overall seats a voter's preferred party wins.

## Notation and Setup

Let $\Voters$ be the set of individuals, or voters, in the region and time period under consideration, who vote to select a candidate from one of a set of political parties $\Parties$ to represent each of a set of legislative districts, indexed by $\Distrs$.
We take these three sets to be fixed.

Voters vote in elections, each of which produces a specific outcome $v$ from the set $\Elecs$ of all possible election outcomes.
In an election, voters either vote for a candidate running in their district, or abstain from voting.
So we write $v:\Voters\to\Parties\cup\{\textsc{abstain}\}$, with $v(i)$ the party that voter $i\in\Voters$ voted for in election $v$.

Every voter resides in some legislative district; this assignment is referred to as a *districting plan* and is formally represented by a function $q:\Voters\surjto \Distrs$.
The set of all possible districting plans is $\Plans$.[^1]

[^1]: Note that these districting plans do not depend on the election; as a result, we implicitly assume that voters do not move residences during the period under consideration.
    This is not a necessary restriction and can be dealt with formally by first mapping voters to precincts (varying by election) and then mapping precincts to districts (constant across elections).
    Once we aggregate or average across all voters in a party or district, the differences between these two approaches disappear.

Votes may be tallied at the district level, by party, by defining for each party $p\in\Parties$ $$
    \votes^{(p)}: \Distrs\times\Elecs\times\Plans \to \N, \qquad
    \votes^{(p)}(d, v, q) = \sum_{i\in q^{-1}(d)} \ind_{\{p\}}(v(i)).
$$ The political party of the candidate with the most votes wins each district, as captured by the function $$
    \win: \Distrs\times\Elecs\times\Plans\to P, \qquad
    \win(d, v, q) = \argmax_{p\in\Parties} \votes^{(p)}(d, v, q).
$$Thus an individual voter $i\in\Voters$ is represented after election $v$ by political party $\win(q(i), v, q)$, and each political party can be said to win a number of seats, formalized as$$
    \seats:\Parties\times\Elecs\times\Plans\to\N,
    \qquad \seats(p,v,q) = \sum_{d\in\Distrs} \ind_{\{p\}}(\win(d,v,q)).
$$

## Global Outcome Utility

We posit that the utility of the global election outcome to a voter is a strictly increasing function of the share of total seats that the voter's preferred party wins.
Their global outcome utility function for an election outcome $e\in\Elecs$ and districting plan $q\in\Plans$ can thus be written$$
    u^{(G)}:\Voters\times\Elecs\times\Plans\to\R,
    \qquad u^{(G)}(i,v,q) = g\qty(\frac{\seats(v(i), v, q)}{|\Distrs|}),
$$for $g:[0,1]\bijto\R$ a strictly increasing function.

What kind of electoral systems does this utility function encourage, if the goal is maximizing total voter utility (or, equivalently, average voter utility)?
It depends on the form of $g$, as the following result describes.
Proofs of this and all other propositions are deferred to Appendix \ref{app:proofs}.

```{=tex}
\begin{restatable}{prop}{propglobal} \label{prop:global}
Let $S=\{s_p:p\in\Parties\}$ be a set of party popular vote shares, and $f:[0,1]\bijto[0,1]$ be a rule for assigning each party a share of seats according to their share of the popular vote.
Define the total utility for this rule as \[
    u_{\mathrm{tot}}^{(G)}(f, v) \dfeq \sum_{i\in\Voters} g\qty(f\qty(s_{v(i)})).
\]
Then if $g$ is convex, $u_{\mathrm{tot}}^{(G)}$ is maximized for $f(x)=\ind_{[\max S, 1]}(x)$, and if $g$ is strictly concave, the maximizer of $u_{\mathrm{tot}}^{(G)}$ will be a strictly increasing function.
In particular, if $g(x)=\log(x)$ and every party receives at least one vote, then $f(x)=x$ maximizes $u_{\mathrm{tot}}^{(G)}$.

\end{restatable}
```
Thus, if we are willing to adopt the logarithm for the functional specification of $u^{(G)}$, then this global outcome utility measure will encourage districting systems that create proportionality between party vote shares and seat shares.

## Local Outcome Utility

The specification of the utility of the local election outcome is more straightforward.
We define$$
    u^{(L)}:\Voters\times\Elecs\times\Plans\to\R,
    \qquad u^{(L)}(i,v,q) = \ind\{v(i)=\win(q(i), v, q)\},
$$that is, a voter gains utility only if they winner of their legislative district belongs to their preferred political party.

Attempting to maximize the average local utility across the electorate would lead to a districting plan where every voter is assigned to a district with other voters of the same party preference; in this way, every voter's utility would be $1$.
Whether such an districting plan is possible depends on the geographical layout of voters and the legal constraints on the districting process---districts must be contiguous, balanced in population, constructed from whole precincts, geographically compact, and so on.
But the general tendency of this utility measure (in the context of a single election, at least), like the global utility measure, will be to push plans towards proportionality.
Unlike with the global measure, a specific kind of proportionality is preferred: that which creates as many lopsided districts as possible (what is often termed a *bipartisan gerrymander*).
This point is discussed further in Section \ref{sec:competitive} below.

## Examples

To illustrate these two utility measures, Figure \ref{fig:mini-util-opt} shows three plans for our running examples which maximize both global (with $g=\log$) and local utility.[^2]
In Mininois and Minissouri, the overall division of seats is as close to proportional as possible.
In Minichusetts, however, it is impossible to give any seats to Republicans (as long as districts are constructed from precincts); all plans have the same utility.
In none of the three states is it possible to create a perfect bipartisan gerrymander, but the plans for Mininois and Minissouri get as close as possible by packing Democratic voters into cities (and Republican voters into rural areas, where feasible).

[^2]: These examples present a slight complication---what to do when a party wins no seats?
    The easiest solution, perhaps, is to define the utility to that party's voters to be $-1$; this will make the utility well-defined while still encouraging proportionality.

```{r mini-util-opt, fig.cap="Utility-maximizing redistricting plans for the three running examples, with each district shaded by its partisan lean. Black lines indicate districts. Red and blue dots indicate Republicans and Democrats, respectively."}
include_graphics(here("paper/figures/minis_util_opt.pdf"))
```

## Multiple Elections or Districting Plans

The utility measures above are defined for a single election outcome $v\in \Elecs$ and districting plan $q\in\Plans$.
But often we will want to consider utility averaged over a set of future elections (under the same districting plan), or over a set of hypothetical districting plans.

To allow this, we replace the fixed election districting plan with random variables $(V,Q)\sim \pi$, where $\pi$ is a joint probability measure on election outcomes and districting plans.
The randomness in election outcomes comes from variations in factors such as voter preferences, the political environment, candidate quality, and campaign events.
The randomness in districting plans reflects the constraints and preferences of the plan-drawing process.
As we will discuss in Section \ref{sec:estimating}, generally we will assume that $V\indep Q$, though this is not required for our theoretical analysis.
We will also consider a voter $I$ taken uniformly at random from $\Voters$, with $I\indep\pi$.
This has the effect of treating voters exchangeably and valuing their personal utilities equally.

Then we may define the utilities for a (randomly selected) voter as $$
    U^{(G)} \dfeq u^{(G)}(I, V, Q) \qand
    U^{(L)} \dfeq u^{(L)}(I, V, Q).
$$Thus, the local utility for a single voter $i$ becomes $U^{(L)}\mid I=i$; the electorate's average utility for election outcome $v$ becomes $\E[U^{(L)}\mid V=v]$, and so on.

# Towards Individualized Representational Harm {#sec:indiv-harm}

Utility may be defined solely in terms of realized election outcomes and districting plans.
Harm, we argue, cannot.
Harm is not the same as disutility, for to be harmed by a decision a voter must have a better outcome in the counterfactual world where another decision was made.
Put another way, in the context of districting plans, if no alternative districting plan could provide more utility to a voter, then that voter was not harmed by the districting plan chosen.

## Individual Harm

To operationalize this, we need to introduce a counterfactual districting plan $\tilde q$.
These counterfactuals could arise from a posited probability distribution capturing the factors relevant to a non-partisan redistricting process, or they could be a set of alternative redistricting plans that were considered as part of the legislative process leading to a final enacted plan.
Then we may define the harm to a voter as $h:\Voters\times\Elecs\times\Plans^2\to\R$, \begin{align*}
    h(i,v,q,\tilde q) &= (1 - u^{(L)}(i, v, q))\cdot u^{(L)}(i, v, \tilde q) \\
    &= \ind\{v(i)\neq\win(q(i), v, q)\}
        \ind\{v(i)=\win(\tilde q(i), v, \tilde q)\},
\end{align*}that is, a voter is harmed only if they are not represented by the party of their choice *and* they would have been represented by the party of their choice under the counterfactual plan.

Harm is defined using the local, not global, utility measure, because inherently, global utility (and thus harm) will be constant for all voters of a particular party.
As we discuss below in Section \ref{subsec:diff-harm}, locally-based harm is connected to global electoral outcomes, anyway.

As with the utility measures, this harm measure naturally extends to multiple elections and districting plans.
Make the counterfactual plan a random variable $\tilde Q$, with $(V,Q,\tilde Q)\sim\pi$ such that $Q\indep\tilde Q$.
Then the harm to a random voter is $H \dfeq h(I, V, Q, \tilde Q)$.

The expected harm to an individual $i\in\Voters$ then becomes $$
   \E[H\mid I=i] = \Pr[V(i)\neq\win(Q(i), V, Q)
    \text{ and }V(i)=\win(\tilde Q(i), V, \tilde Q)],
$$

that is, the probability that the voter is misrepresented under the adopted plan but would not have been under a counterfactual.

```{r mini-harm, fig.cap="Three potential districting plans for Mininois and Minissouris, showing district partisan lean (top row) and total voter harm versus the counterfactuals in Figure 2(a)-(b) (bottom row; darker shading indicates more harm)."}
include_graphics(here("paper/figures/mini_harm.pdf"))
```

Figure \ref{fig:mini-harm} illustrates this measure for a set of hypothetical gerrymanders, comparing to the set of optimal plans from Figure \ref{fig:mini-util-opt}.
As might be intuitively expected, total harm to voters is concentrated in areas whose party representation flips from the gerrymander to the counterfactual plan.

## Differential Harm and Fairness {#subsec:diff-harm}

Intuitively, a districting plan is fair if it does not harm the voters of one party more than another, on average.
This is easily expressed using our notation above; $Q$ is *fair* in comparison to counterfactual $\tilde Q$ if $\E[H\mid V(I) = p]$ is constant across parties $p\in\Parties$.

To quantify deviations from fairness, we introduce of a measure of \textit{differential harm}, defined as $$
  \Delta^{p_1}_{p_2}H(q) \dfeq \E[H\mid V(I)=p_1, Q=q] - \E[H\mid V(I)=p_2, Q=q],
$$ for two parties $p_1$ and $p_2$.
So $\Delta^{p_1}_{p_2}H(q)=0$ for all $p_1,p_2\in\Parties$ if and only if $q$ is fair.
From here onward we will restrict our attention to the case of two parties---concretely, $\Parties=\{\dem,\rep\}$---and simply write $\Delta H(q)=\Delta^\dem_\rep H(q)$.
But the same concepts and definitions naturally carry over to the multiparty setting.

In the districting plan examples of Figure \ref{fig:mini-harm}, the differential harm of the Democratic gerrymander of Mininois is $-0.519$, the differential harm of the Democratic gerrymander of Minissouri is $-0.415$, and the differential harm of the Republican gerrymander of Minissouri is $0.450$, where positive values indicate Republican bias.
In other words, the average Republican voter in Mininois is 51.9% more likely to be represented by a Democrat than an average Democrat is to be represented by a Republican, compared to the utility-maximizing plan in Figure \ref{fig:mini-util-opt}(a).

Despite being derived from a local harm measure, $\Delta H(Q)$ is in fact closely related to the overall number of seats won by each party, as Proposition \ref{prop:fairness} describes below.
Yet unlike a simple measure of seats, $\Delta H(Q)$ is shifted to an interpretable scale, where a value of zero corresponds to partisan fairness.
In other words, $\Delta H(Q)$ provides a connection between fairness and seats, establishing a normative guide to overall election outcomes.
This connection further supports the use of total seats as a summary statistic in redistricting simulation methods, as advocated by @deford2020symmetry.

```{=tex}
\begin{restatable}{prop}{propfairness} \label{prop:fairness}
If turnout is equal across districts, i.e., if $\sum_{p\in\Parties} \votes^{(p)}(d,v,q)$ is constant across $d$, $v$, and $q$, then for a specific districting plan $q\in\Plans$ and political party $p\in\Parties$, we have
\begin{align*}
    \Delta H(q) = \E[\seats(p, V, Q)\mid Q=q] - \E[\seats(p, V, \tilde Q)].
\end{align*}

\end{restatable}
```
# Estimating the Harm Measures {#sec:estimating}

The measures $U^{(G)}, U^{(L)}, H$ and $\Delta H(q)$ defined above require specification of a probability distribution on elections and districting plans, $\pi$.
Depending on one's viewpoint, this is either a theoretical fiction which must be specified by a model, or an actual data-generating process we must aim to estimate.
Either way, past election data and an enacted districting plan alone are not enough to calculate these measures.

While not strictly necessary, modeling of $V$ and $\tilde Q$ independently will simplify the situation considerably.
Practically, this translates to the assumption that individual voters would vote for the same political party no matter the districting plan.
To the extent that voters reward or punish an incumbent party for the districting plan they adopt, or that an adopted districting plan affects which candidates run in a district, this assumption is violated.
But as our suggested model for election outcomes will not account for candidate factors or policy preferences, the marginal effect on our conclusions will be minimal.

## Modeling Districting Plans

It is difficult to construct a tractable probability distribution for districting plans, since the space of plans is discrete and lacks a natural metric structure.
Thankfully, in recent years a number of algorithms have been developed which sample districting plans from specific distributions [@fifield2020mcmc; @deford2019; @carter2019; @mccartan2020].
These distributions can generally be characterized as maximum-entropy distributions on the space of all valid districting plans, in combination with several moment constraints.

For example, the algorithms of @carter2019 and @mccartan2020 sample from the maximum-entropy distribution of districting plans which are geographically contiguous, have district populations within a deviation from equality, and which have a certain average compactness value (according to a particular graph-theoretic compactness measure).
These maximum-entropy distributions put as few conditions as possible on the districting sampling process, as long as a set of constraints imposed by the researcher are met.
If these constraints are precisely those which are required by law or traditional redistricting criteria, then samples from this distribution provide a natural set of counterfactual districting plans, uninfluenced by superfluous partisan considerations, to use in estimating $H$ and $\Delta H(q)$.

## Modeling Election Outcomes

Election results present a different set of modeling challenges, given the large number of factors that influence the outcome, and the general unpredictability of future events.
As far as estimating measures like $U^{(G)}, U^{(L)}, H$, and $\Delta H(q)$, we would ideally use a relatively simple model that captures the primary drivers of election outcomes.
In the interest of fairness, the model should not make any biasing assumptions about the future (e.g., that demographic shifts will favor one party, or that past trends in election returns will continue in the same direction).

We propose a *proportionate uniform shift* model, which focuses on swings in the national political environment as the main determinant of election outcomes.
Each election outcome over the period of interest (generally ten years or less) is modeled as a random deviation from a baseline outcome, and these deviations are assumed to consist of a constant fraction of voters of one party in each precinct switching to the other.
The baseline itself can be established by averaging the results of all available statewide elections over the past decade or other suitable period.

The proportionate uniform shift model is not mathematically equivalent to the uniform partisan swing model of @butler1951swing, but is near-identical for most precincts and districts. Despite their simplicity, uniform-swing--type models are highly accurate for out-of-sample prediction [@katz2020], and are intuitive and easy to implement.

Proportionate shift, where we assume that a constant fraction of *voters of one party* in each precinct switch to the other party, has several advantages over the uniform swing model, where a constant fraction of *all voters* shifts parties.
First, the proportionate shift prevents hypothetical party vote shares from exceeding 1 or falling below 0 in any precinct.
Second, as it has the effect of scaling vote shares across precincts by a constant multiple, it preserves the relative balance of a party's voters across precincts.
For measures like $H$ and $F$ which consider voters in each party separately, this helpfully simplifies computations.

The proportionate shift may be mathematically expressed as linear shift on a transformed scale, not unlikea generalized linear model.
Specifically, we define $\gamma:[0,1]\to\R$, $$
\gamma(x) = -\thalf\sgn(x-\thalf)\log(1-2\qty|x-\thalf|),
$$ which is the inverse CDF of a Laplace distribution with rate 2.[^3]
Then a party's vote share in precinct $k$, notated here as $s_k$, is modeled as $$
\gamma(s_k) = \gamma(\overline s_k) + \eps, \qquad \eps \sim \Norm(0, \sigma^2_{\mathrm{hist}}),
$$ where $\overline{s}_k$ is the party baseline, and $\sigma^2_\mathrm{hist}$ is estimated from the historical variability in nationwide popular vote shares.
For congressional elections in the United States from 1974--2018, we have $\widehat\sigma^2_\mathrm{hist}=0.03723$, and so draw predictive deviations from $\mathrm{t}_{22}(0, \widehat\sigma^2_\mathrm{hist})$.

[^3]: A rate of 2 is chosen so that the slope of the link function at $\half$ is exactly 1, meaning that transformed vote shares will be on approximately the same scale as the original shares.

More complicated election outcome models are certainly possible and straightforward to use with the measures proposed here.
For example, one could model district deviations as a systematic national shift plus a local idiosyncratic effect, as is done in the Stochastic Uniform Partisan Swing model of @gelman1994unified.
For ease and efficiency of computation, we stick to the simple proportionate uniform shift model here.
Appendix \ref{app:formulas} contains the specific formulas used to compute $U^{(G)}, U^{(L)}, H$, and $\Delta H(q)$ from a set of past election returns and a sample of districting plans from a redistricting sampling algorithm.

# Connections to Partisan Symmetry and Fairness, Standards {#sec:connections}

In the years since @2004vieth, researchers have developed a veritable zoo of measures to identify partisan gerrymanders. Specifically, these measures aim to quantify deviations from partisan symmetry, fairness, or competitiveness. Some of the most commonly used are perhaps the *efficiency gap* [@stephanopoulos2015], *partisan bias* [@tufte1973pb; @king1987democratic], and the *mean-median* measure [@mcdonald2015unfair].
All of these measures may be estimated using district vote shares alone, and as we discuss next, are to varying degrees related to our proposed measures.

## The Efficiency Gap

The efficiency gap ($EG$) interrogates how a party's votes are wasted under a districting plan.
By subtracting the wasted votes for Democrats from those for Republicans, and normalizing by the total votes cast, it offers a signed measure that is simple to interpret: $EG=0.05$, for example, indicates that 5% more Democratic votes are wasted than Republican ones.
The general recommendation is that an efficiency gap larger than two Congressional seats (i.e., 2 divided by the number of districts), or 0.08 for state legislative plans, indicates a partisan gerrymander.

A number of scholars have criticized the efficiency gap for (1) penalizing proportionality, (2) rewarding 3-to-1 districts and switching sign for more lopsided districts, and (3) being discrete and therefore sensitive to small changes in district vote shares [@bernstein2017egap; @tamcho2017egap; @deford2020symmetry].
These concerns to not apply to our proposed measures.

First, $U^{(G)}, U^{(L)}, H$, and $\Delta H(q)$ are all averaged over possible election outcomes, and so do not suffer from discreteness.
And as discussed above, $U^{(G)}$ and $U^{(L)}$ both reward proportionality.
Of course, proportionality is not always possible, given a state's political geography.
The harm measures $H$ and $\Delta H(q)$ both reflect this by comparing to a set of counterfactual districting plans.
This addresses one inherent shortcoming of the efficiency gap, illustrated best by the state of Massachusetts.
According to the efficiency gap, Massachussetts' congressional districting plan is a Democratic gerrymander ($EG=-0.14$).
But it is impossible to draw a single Republican congressional district in the state.
Consequently $H$ and $\Delta H(q)$ are everywhere 0.

Finally, the fact that the efficiency gap is minimized for districts with 75%--25% vote shares is a direct consequence of comparing the raw number of wasted votes, rather than the share within each party.
In contrast, $\Delta H(q)$ is calculated by comparing harm averaged first within each party, avoiding this deficiency.

As we will see in the application below, often there is substantial correlation between the efficiency gap and $\Delta H(q)$.
Yet in more unusual or tricky cases, the efficiency gap may point to a partisan gerrymander while $\Delta H(q)$ indicates a fair outcome or an unfair advantage for the opposite party.

## Partisan Bias

Partisan bias is probably the most widely-used measure of partisan symmetry.
The bias, denoted by $\beta(s)$ is the number of seats that would need to be reallocated to reach proportionality for a given statewide vote share $s$ (usually $\half$).
Like our proposed measures, this quantity is defined independent of electoral data and can be estimated using a uniform swing model.
Each value of $s$ yields information about a different point on the seats-votes curve.

In competitive states, where the baseline election has a statewide vote share near 50%, $\beta(\half)$ is highly correlated with $\E[\seats(\dem, V, Q)\mid Q=q]$ and thus $\Delta H(q)$ as well.
But in more lopsided states, $\beta(\half)$ can give unintuitive results, which, if not interpreted carefully, can lead practictioners to make incorrect conclusions about the presence and direction of a partisan gerrymander.

Fundamentally, however, $\beta(s)$ measures partisan symmetry, and not partisan harm or utility.
It should not be surprising, then, that it can and does "disagree" about the partisan effects of a particular plan.
These "disagreements" are really just differences in the target quantity of interest.

```{=html}
<!--
1.  Integrating yields a related measure of @nagle2015measures, which has also been criticized by @deford2020symmetry.
2.  Focuses on only one part of S-V curve, which may not be relevant

Notably, as the quantity of interest is not partisan symmetry, our measures do not require the existence of a seats-votes curve. This is consequential for the study of congressional redistricting. As a seats-votes curve is defined for a legislature, rather than a delegation, to understand the impact of single state's congressional map, you would be forced to consider how every other state drew their maps [@katz:king:rose:21a]. Thus, if this taken as the definition of a seats-votes curve, then measures of partisan symmetry lack diagnostic power to identify gerrymanders for the delegations that academics, legal scholars, and the general public are often focused on. The individualized focus of our measures are, however, portable to congressional, state legislative, or any other form of districting and elections.
-->
```
## Mean-Median Difference

The mean-median difference straightforwardly measures the difference between the mean and median district vote shares.
In practice, the mean-median differences is moderately correlated with other partisan redistricting measures.
However, considerations of the mean and median district are only related to individuals insofar as they describe the general propensity to be harmed or benefited by a particular map.
As [@katz2020] discuss, the mean-median difference can be interpreted as an estimator of *votes-denominated bias*, another value derived from the seats-votes curve.

## Districting Plan Competitiveness {#sec:competitive}

The notion of district *competitiveness*, while related to the slope of the seats-vote curve around $\half$, is not the same as partisan symmetry.
However, one commonly used measure of competitiveness, from @tamcho2016, is related to our local utility measure $U^{(L)}$.
The measure of @tamcho2016, which we will denote by $\mathrm{comp}_\alpha(v,q)$, contains two terms: one, $T_p(v,q)$, measuring the closeness of district vote shares to 50%, and the other, $T_e(v,q)$, measuring the closeness of the overall share of seats to 50%; the relative importance of these two terms is controlled by $\alpha$.
It is this first term which his closely related to $U^{(L)}$, as stated in Proposition \ref{prop:comp} below.

```{=tex}
\begin{restatable}{prop}{propcomp} \label{prop:comp}
If turnout is equal across districts, for an election $v\in\Elecs$ and districting plan $q\in\Plans$ and two political parties, we have
\begin{align*}
    \E[U^{(L)}\mid V=v, Q=q] &= \frac{1}{2|D|}\sum_{d\in D}
        \qty|\frac{\votes^{(p_a)}}{\votes^{(p_b)} + \votes^{(p_b)}}-\half| \\
    &= \half T_p(v,q) = \frac{\mathrm{comp}_\alpha(v,q)}{1+\alpha T_e(v_q)}.
\end{align*}

\end{restatable}
```
Importantly, $\mathrm{comp}_\alpha(v,q)$ is designed to be *minimized*---smaller values correspond to more competitive districts.
But, as briefly discussed above, this actually runs counter to the local utility measure, which encourages lopsided districts with as many similarly-minded voters as possible.
@brunell2010 discusses this point in much more detail, arguing that competitive districts should be avoided where possible.
Buttressing our choice of local utility function, he analyzes ANES survey data to show that voters approve more highly of their representative and of Congress overall when their representative votes in alignment with their preferences.

# Application: New Jersey {#sec:empirical}

To illustrate the connections in the preceding section and to demonstrate the value of the proposed measures in a real-world setting, we provide a brief analysis of congressional districting in the state of New Jersey.
As discussed above, many gerrymandering measures function well in highly competitive states, but may produce more counterintuitive results in other states.
New Jersey, with an average Democratic two-party vote share of 56.6% across our two baseline elections (2016 presidential and 2018 senatorial), will demonstrate that this is not a problem unique to lopsided states.
Additionally, New Jersey has 12 congressional districts, which is enough to produce some variability in seats outcomes across counterfactual plans, but not so many as to render trivial the challenges of discreteness.

```{r nj-maps, fig.cap="Baseline vote patterns, and two hypothetical gerrymanders. Census-designated places are shaded in gray and county lines in white.", fig.width=6.5, fig.height=3.5}
include_graphics(here("paper/figures/nj_maps.pdf"))
```

Figure \ref{fig:nj-maps} shows the baseline Democratic vote share by precinct, along with two hypothetical gerrymanders of the state, which were generated using the short-burst optimization approach of @cannon2020.
The Democratic gerrymander has 11 Democratic seats and 1 Republican seat at baseline, while the Republican gerrymander has 6 Democratic and 6 Republican seats.

We sample 1,000 districting plans using the SMC algorithm of @mccartan2020, setting constraints to favor compact plans with district boundaries that tend to follow county lines.
For each of these sampled plans and the two gerrymanders, we calculate the utility, harm, and fairness measures, as well as the expected number of Democratic seats, the efficiency gap, partisan bias, and the mean-median score.[^4]
The distribution of these measures is shown in Figure \ref{fig:nj-vars}.

[^4]: We include partisan bias and mean-median in these figures as it is common practice, though it may have theoretical issues when used for a delegation rather than a legislature[@katz21].

```{r nj-vars, fig.cap="Distributions of districting measures for simulated New Jersey distriting plans, the Republican gerrymander (red), and the Democratic gerrymander (blue).", fig.width=6.5, fig.height=3.25}
include_graphics(here("paper/figures/nj_vars.pdf"))
```

The efficiency gap and $\Delta H(q)$ both correctly classify the gerrymandered plans as such, and with the correct sign.
Both gerrymanders also have a higher average harm than any of the simulated plans.
In contrast, under the partisan bias measure the Republican gerrymander is completely unbiased, and according to the mean-median measure, both gerrymanders strongly favor Democrats.

For the utility measures, the Democratic plan is a low-utility outlier.
But the Republican plan is near the median for both global and local utility.
How to square this with the finding that the Republican plan is an unfair gerrymander which harms more voters than expected under a neutral process?
As the distribution of expected Democratic seats shows, Democrats are structurally favored in New Jersey, able to win a larger fraction of seats than their statewide vote share under a neutral process.
Plans which actively counteract this to try to draw proportional districts, like the Republican gerrymander, will necessarily harm Democratic voters versus the neutral counterfactual.
But in doing so they will create a more proportional plan that will tend to pack voters of each party into more homogeneous districts, increasing both global and local utility.

```{r nj-district-shares, fig.cap="Distribution of district vote shares, with districts ordrered by baseline Democratic two-part vote share. Displayed on top are the district vote shares for six example plans, each extremal for some combination of districting measures.", fig.width=6.5, fig.height=3.9}
include_graphics(here("paper/figures/nj_district_shares.pdf"))
```

This is manifested in the district-level vote shares shown in Figure \ref{fig:nj-district-shares}.
Within each districting plan, we number districts in order of their Democratic vote share, with district 1 the least Democratic.
The figure shows these vote shares for six selected districting plans, and compares them to the distribution of shares for the entire sample.
The selected plans themselves are shown in Appendix \ref{app:nj}.

The fairest, best overall utility, and high global, low local utility plans have 8 Democratic and 4 Republican seats at baseline, but the best-utility plan has more extreme vote shares, i.e., less competitive districts, while the high global, low local utility plan has vote shares closer to 50%, with the fairest plan falling somewhere in the middle.

In contrast, the low global, high local utility plan has 9 Democratic seats, 1 Republican seat, and 2 highly competitive seats at baseline.
While generally local utility encourages proportionality and noncompetitive districts, conditional on low global utility (poor proportionality) the local utility measure encourages a Democratic gerrymander which satisfies the state's majority of Democratic voters, at the expense of the minority of Republican voters.

The fair but low local utility plan has a similar vote share pattern to the fair plan, but overall with more competitive districts, which are generally penalized by the local utility measure.
Conversely, the unfair but high local utility plan has 9 Democratic seats, 2 Republican seats, and 1 highly competitive seat at baseline---an unfair Democratic gerrymander---while keeping district vote shares relatively noncompetitive.

# Discussion {#sec:discussion}

This paper is an attempt to bridge the quantitative gap between votes and representation.
We break from existing redistricting literature and focus on the relationship between votes and representation by copartisans, rather than the relationship between votes and seats.
This focus naturally leads to a new normative standard of partisan fairness, which is achieved when the necessary harms of a districting plan are distributed evenly across voters of each party.
This may occur regardless of whether the districting plan achieves partisan symmetry.

This approach offers new purchase into the foundational questions of how to quantify the harms and benefits that accrue to voters in district-based democracies, where the rules of defining districts are fixed, but the choice of how to how to draw the districts remains a policy question.
While the overall framework is flexible, we offer a selection of simple yet interesting measures for improving the individual partisan implications of a districting plan.
Further work is needed to characterize how existing redistricting requirements and practices, such as the number or size of districts, or encouragement of competitive districts, interact with these measures.

# References {.unnumbered}

::: {#refs}
:::

```{=tex}
\vspace{1in}
\appendix
\renewcommand\thefigure{\thesection.\arabic{figure}}
\setcounter{figure}{0}
```
# Proofs of Propositions {#app:proofs}

```{=tex}
\propglobal*

\begin{proof}
\end{proof}

\propfairness*

\begin{proof}
\end{proof}

\propcomp*

\begin{proof}
\end{proof}
```
# Computing Utility, Harm, and Fairness from Precinct-level Election Data {#app:formulas}

```{=html}
<!--

1.  Global utility is discrete, so we can compute the range of shifts that produce each number of seats, and the average vote share for those ranges.
    Combine these

2.  To be computationally efficient, local utility requires linearizing the vote share curve.

3.  For voter fairness, PUS means that relative share of party's voters in each precinct remains the same.
    Need only to apply a kernel function (composition of Laplace ICDF + model shift CDF)

Formulas here.
-->
```
# Districting Measures in New Jersey {#app:nj}

```{r nj-pairs, fig.cap="Scatterplots for all pairs of measures. Color indicates the number of Democratic seats won (ranging from 7 to 10). Below the diagonal, numbers indicate the absolute value of the correlation between variables.", fig.width=7, fig.height=7}
include_graphics(here("paper/figures/nj_pairs.pdf"))
```

```{r nj-ex-maps, fig.cap="Example districting plans selected according to their scores on $\\Delta H(q)$, $U^{(G)}$, and $U^{(L)}$. District shares for these example plans are shown in Figure \\ref{fig:nj-district-shares}.", fig.width=7, fig.height=7}
include_graphics(here("paper/figures/nj_ex_maps.pdf"))
```
