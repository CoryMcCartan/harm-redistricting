---
title: Individual and Differential Harm in Redistricting
authors:
  - name: Cory McCartan
    thanks: |
      To whom correspondence should be addressed.
      The authors thank Kosuke Imai, Gary King, Shiro Kuriwaki, 
      Tyler Simko, Nick Stephanopolous, and 
      participants of the Harvard American Politics Research Workshop 
      and Imai Research Group for helpful comments and discussion.
      Replication code and data are available at <https://github.com/CoryMcCartan/harm-redistricting>.
    department: Department of Statistics
    affiliation: Harvard University
    location: Cambridge, MA
    email: cmccartan@fas.harvard.edu
  - name: Christopher T. Kenny
    department: Department of Government
    affiliation: Harvard University
    location: Cambridge, MA
    email: christopherkenny@fas.harvard.edu
abstract: |
  Social scientists have developed dozens of measures for assessing partisan bias in redistricting. But these measures cannot be easily adapted to other groups, including those defined by race, class, or geography. Nor are they applicable to single- or no-party contexts such as local redistricting. To overcome these limitations, we propose a unified framework of harm for evaluating the impacts of a districting plan on individual voters and the groups to which they belong. We consider a voter harmed if their chosen candidate is not elected under the current plan, but would be under a different plan. Harm improves on existing measures by both focusing on the choices of individual voters and directly incorporating counterfactual plans. We discuss strategies for estimating harm, and demonstrate the utility of our framework through analyses of partisan gerrymandering in New Jersey, voting rights litigation in Alabama, and racial dynamics of Boston City Council elections.
keywords:
  - representation
  - redistricting
  - voting rights
  - individual harm
bibliography: references.bib
biblio-style: apsr
output:
  rticles::arxiv_article:
    keep_tex: true
    includes:
      in_header: "header.tex"
    latex_engine: pdflatex
editor_options:
  markdown:
    wrap: sentence
---

```{r SETUP, include=FALSE}
library(knitr)
library(here)

opts_chunk$set(echo=FALSE, message=FALSE, warning=FALSE,
               fig.path=here("paper/figures/"), fig.align="center",
               fig.width=(8.5-2*1)/2, out.width="100%", fig.asp=0.8)
```

# Introduction

For as long as there have been district-based electoral systems, groups, individuals, and parties have manipulated them for political gain.
Partisan gerrymandering, whether in the form of rotten boroughs or Elbridge Gerry's salamander-shaped district [@griffith1907rise, pp. 72--73], is perhaps the most consistently visible manifestation of this tendency. The academic study of partisan gerrymandering has largely centered on how electoral systems treat political parties, as captured in the *seats-votes curve* or notions of *partisan symmetry* [@tufte1973pb; @grofman1983measures; @king1987democratic; @king1989representation; @gelman1994unified; @thomas2013estimating; @katz2020]. Other types of gerrymandering exist as well. In the United States, many states have historically used racial gerrymandering to maintain White political supremacy [@gilliland1969racial]. The Voting Rights Act of 1965 (VRA) provided a framework for legal challenges to racial gerrymanders that has also shaped the academic literature, which is characterized by a focus on identifying the voting preferences of racial groups and observing the extent to which these are realized or frustrated through district boundaries and other features of the electoral system [@oloughlin1982id; @grofman1991identifying; @king1997solution; @greiner2006ecological]. At the local level, where most redistricting occurs, partisan dynamics are not always as salient, and the manipulation of the electoral system may be more subtle or may favor a narrower or less well-defined group [@cain2002mapmaking; @halberstam2012process]. Local redistricting has been less extensively studied, in part for this reason and in part because of data limitations [but see @siegel2013educational; @vargas2021racial].

No matter the source or context, all of these cases involve the concentration or dilution of voting power to favor or disfavor a particular group.
This paper proposes a new framework of *individual and differential harm* for the unified study of all forms of gerrymandering by way of measuring this concentration and dilution.

The harm framework combines two key ideas, which are motivated at greater length in Section \ref{sec:motivation}.
First, we operate at the level of the individual voter, and examine whether each voter is represented by the candidate of their choice.
Doing so both unifies our approach to gerrymandering across contexts and also reflects a core goal of representative democracy: that elected officials represent the preferences of the voting public to the greatest extent possible [see also @brunell2010].

Second, the proposed framework moves beyond a single electoral system under study to also consider *counterfactual* electoral systems.
Many factors influence the performance and qualities of an electoral system.
Without a well-defined comparison system, it is impossible to differentiate whether certain aspects of the system, like its partisan performance, are intrinsic consequences of laws and political geography or result from improper manipulation of the system for political gain.
As we demonstrate, modern redistricting simulation tools can provide a realistic set of counterfactuals that make these kinds of comparisons possible.

The combination of individual voter choices and counterfactual electoral systems defines our notion of *individual harm*: informally, a voter is harmed if they are more likely to be represented by the candidate of their choice under a different electoral system.
And by analyzing how harms fall differentially along partisan, racial, ideological, and other lines, we can connect individual harm to traditional notions of gerrymandering.
Section \ref{sec:motivation} illustrates this with three simple examples, and the general definitions are formalized in Section \ref{sec:indiv-harm}.
In Section \ref{sec:estimating}, we discuss how to estimate these measures from observed election results.

This framework has important similarities with the common-law approach to voting rights litigation.
To proceed with a legal challenge to an alleged gerrymander, a voter must demonstrate that their individual right to vote has been harmed by the enacted district boundaries [@1964reynolds; @1962baker; @issakarl98]. This requires proof that *but for* the alleged gerrymander, the voter would have been more likely to elect their chosen candidate [@2004vieth; @2018league; @2019lewis].
A more detailed discussion of the connections between the proposed framework and existing practices for analyzing racial and partisan gerrymandering may be found in Section \ref{sec:connections}.

Harm and differential harm are more than a useful conceptual unification---they are practically useful in a wide variety of redistricting analyses, including partisan gerrymandering of New Jersey congressional districts (Section \ref{sec:nj}), voting rights litigation for Alabama congressional districts (Section \ref{sec:alabama}), and racial impacts of district boundaries on Boston City Council primary elections (Section \ref{sec:boston}).
Section \ref{sec:discussion} concludes.

# Motivation {#sec:motivation}

To motivate the concepts of individual and differential harm, we will make use of three examples, which are stylized representations of U.S. states: Mininois, Minissouri, and Minichusetts.
Mininois has one large Democratic city which can electorally dominate the rest of the state; Minissouri has two medium-sized cities which are not large enough to deliver a statewide Democratic majority; and Minichusetts has a uniform 3--2 Democratic split in every precinct.
Each example state has the same population and should be divided into 3 districts with population between 54 and 66.
Voters' preferences are assumed to be stable across elections, and turnout is 100%.
Schematics for these examples are shown in Figure \ref{fig:mini-schematic}(a)--(c).

## Minichusetts: counterfactuals matter

Every precinct in Minichusetts has a Democratic majority.
As a result, it is impossible to draw a districting plan built from precincts that creates even a single Republican district.
This mirrors the situation in the actual state of Massachusetts, where a high level of partisan integration and a solid statewide Democratic majority leads to Republican inability to win any congressional seats under recent historical voting patterns [@duch:18].

```{r mini-schematic}
#| fig.cap: |
#|      Schematic maps of the example states,
#|      showing the partisan composition of each of the 36 precincts.
#|      The total voting population for each example is 180.
include_graphics("figures/minis_schematic.pdf")
```

This Democratic dominance poses a problem for existing measures of partisan gerrymandering.
One of the most common measures, the efficiency gap of @stephanopoulos2015, takes a value of $-0.311$ or $-0.317$ for Minichusetts, depending on the configuration of the districts.
This would make any Minichusetts districting plan an extreme Democratic gerrymander in comparison to the historical range of efficiency gaps observed in states nationwide.[^1]

[^1]: See, e.g., the historical distribution calculated by the Campaign Legal Center's PlanScore tool: <https://planscore.campaignlegal.org/metrics/efficiencygap/>.

But it is impossible to gerrymander if every manipulation of district boundaries produces no change in partisan outcomes.
What the efficiency gap and other gerrymandering measures lack is an awareness of the space of possible districting plans, plans that *counterfactually* might have been selected.
Once a set of districting rules has been agreed on (in Minichusetts, that districts must be contiguous and composed of whole precincts), what matters is not how a plan measures up to a fixed ideal, but how it performs in comparison to counterfactual plans.
There can be no gerrymander, and no harm to individual voters, if no improvement in partisan fairness is possible.

## Mininois: individual harm

To explore how to properly integrate counterfactual districting plans into the analysis of a potential gerrymander, we turn to the more interesting state of Mininois, where, in a familiar pattern of partisan sorting, Democrats are sorted asymmetrically into a single population-dominating city whereas Republicans dominate the less ideologically segregated rural regions [@chen:rodd:13; @enos:brown:21].

Consider the two plans in Figure \ref{fig:harm-mininois}(a)-(b).
A Democratic gerrymander (a) effectuates Democratic control by splitting its city, pinwheel-like, into three districts reaching out into the more Republican and sparsely populated remainder of the state.
This gerrymander would elect zero Republicans and three Democrats, whereas the proportional map (b) would elect two Democrats and one Republican.

```{r harm-mininois}
#| fig.cap: |
#|      Two potential districting plans for Mininois:
#|      a Democratic gerrymander (a) and a close-to-proportional plan (b).
#|      Panel (c) shows the total harm to voters in each precinct done by (a), using (b) as a counterfactual.
include_graphics("figures/harm_mininois.pdf")
```

Suppose now that plan (a) is enacted into law.
Who does this decision harm, if anyone?
Precisely those voters who are not represented by their chosen party, but would have been counterfactually.
Using plan (b) as a counterfactual, we can see that rural Republicans in the eastern half of Mininois are harmed by plan (a), since under plan (b) they would be represented by a Republican.
Republicans in the city and in the southwest are unharmed, as are all Democratic voters, since they are represented by the same party under both plans.
Figure \ref{fig:harm-mininois}, Panel C plots the number of voters harmed in each precinct.

Measuring the harm of the Democratic gerrymander required comparing it to a neutral counterfactual plan.
The choice of counterfactual might seem hopelessly subjective.
We discuss in Section \ref{sec:estimating} principled ways to define counterfactuals, but for now we hope the value in measuring harm through counterfactuals is clear even if the operationalization is not.

## Minissouri: differential harm

We could quantify the harm a Democratic gerrymander imposed on voters in Mininois by comparing election outcomes to those under a counterfactual proportional plan.
But the results said nothing about the direction of the harm.
While it is apparent that the Democratic gerrymander indeed benefits Democrats, tallying up the total harm done to all voters is not enough to prove this.

However, we can partition voters into groups, and compare how the harm done by a plan falls across those groups.
If a plan disproportionately harms voters of one group, then we might conclude that that group was the target of a gerrymander.
Figure \ref{fig:diffharm-minissouri} illustrates this idea for two hypothetical gerrymanders ((a) and (c)) of Minissouri.
As in Mininois, we can tally the total number of voters harmed in each precinct ((d) and (f)) in comparison to a proportional counterfactual plan (b).
In both cases, total harm to voters is concentrated in areas whose party representation flips from the gerrymander to the counterfactual plan.

```{r diffharm-minissouri}
#| fig.cap: |
#|      Three potential districting plans for Minissouri:
#|      a Democratic gerrymander (a),
#|      a close-to-proportional plan (b), and a Republican gerrymander (c).
#|      Panels (d) and (f) show the total harm to voters in each precinct done
#|      by their corresponding gerrymander, using (b) as a counterfactual.
#|      Panel (e) summarizes this harm by party and across precincts, showing
#|      the average harm done to voters of each party by each gerrymander.
include_graphics("figures/diffharm_minissouri.pdf")
```

Panel (e) then splits the voters by party, and computes, for each party, the share of its voters which are harmed.
The Democratic gerrymander (a) harms Republicans at a much higher rate than Democrats, and the opposite can be said of the Republican gerrymander (c).
We call the gap between these two rates the *differential harm,* and propose it as a general way to account for the impact of a districting plan on particular groups.

The differential harm of the Democratic gerrymander of Minissouri is $-0.415$, and the differential harm of the Republican gerrymander is $0.450$, where positive values indicate Republican bias.
In other words, under the Democratic gerrymander, the average Republican voter in Mininois is 41.5% more likely to be represented by a Democrat than an average Democrat is to be represented by a Republican, compared to the proportional plan in Figure \ref{fig:diffharm-minissouri}(b).

# Individual and Differential Harm {#sec:indiv-harm}

We formalize and generalize the concepts in Section \ref{sec:motivation}, beginning with some notation.
Let $\Voters$ be the set of individuals, or voters, in the region and time period under consideration, who vote to select a candidate to represent each of a set of districts, indexed by $\Distrs$.

Voters vote in elections, each of which produces a specific outcome $v$ from the set $\Elecs$ of all possible election outcomes.
In an election, voters either vote for a candidate running in their district, or abstain from voting.
We write $v(i)$ to mean the candidate that individual $i$ votes for in election $v$.

Every voter resides in some legislative district; this assignment is referred to as a *districting plan* and is represented here by a function $q(i)$ indicating the district that individual $i$ lives in.
The set of all possible districting plans is $\Plans$.

For an election $v$, we can tally the votes for each candidate; the candidate with the most votes wins.
Using potential outcomes notation, we denote the winner of voter $i$'s district under districting plan $q$ and election $v$ as $\win_i(v,q)$.

This notation obscures the complex relationships and feedback effects between individuals, elections, and districting plans.
For example, different districting plans may lead to different candidates running, depending on district partisanship and incumbent residency.
The assumptions we make on these relationships will be made more explicit in Section \ref{sec:estimating}, where we discuss how to estimate our measures in practice.

## Harm {#subsec:harm}

The key intuition from Section \ref{sec:motivation} was that to be harmed by a decision a voter must have a better outcome in the counterfactual world where another decision was made.
To operationalize this, we need to have a counterfactual districting plan $\tilde q$.
Then we may define the *harm* to an individual $i$ in election $v$ held under districting plan $q$ as $$
h_i(v,q,\tilde q) = \ind\{v(i) \neq \win_i(v, q)\}
        \ind\{v(i) = \win_i(v, \tilde q)\},
$$that is, a voter is harmed only if they are not represented by the candidate of their choice under $q$ and they would have been represented by their chosen candidate under the counterfactual plan $\tilde q$.

This definition of harm is limited in two key regards.
First, it considers only individuals who vote; if a person abstains from voting then their calculated harm is zero.
A natural extension of this definition would be to separate an individual's candidate preference from their vote choice; the latter would be used in calculating election winners, but the former could provide a more broadly-based harm measure.
Naturally, this approach requires auxiliary data to implement (such as a large-scale survey), since candidate preferences for nonvoters cannot be directly inferred from election returns.

A second limitation is that $h_i(v,q,\tilde q)$ ignores any preferences a voter may have between candidates he or she did not vote for.
For example, a voter may consider candidates A and B nearly interchangeable, but may strongly dislike candidate C.
If the voter ultimately voted for candidate A, this harm measure makes no distinction between candidate B or candidate C winning the voter's district.
This reflects the simplistic nature of the cost function that is implicit in the harm measure.
The problem could be remedied by replacing the indicator functions with other cost functions that consider ordinal preferences.
Ballot-level ranked-choice vote data, or candidate ideology scores, could be used to estimate such a cost function.
Here, for simplicity and to avoid making further assumptions, we limit ourselves to the indicator-based cost function.
Section \ref{sec:boston} further discusses the implications of this particular specification in the context of primary elections.

## Multiple Elections or Districting Plans

As defined above, $h_i(v,q,\tilde q)$ captures harm in a single election and relative to a single counterfactual districting plan $\tilde q$.
In general we will be interested in outcomes over multiple elections, and possibly a much larger set of counterfactual plans.
Ideally, we would like to be able to average individual harm over a set of future elections (under the same districting plan), or over a set of hypothetical districting plans, or even over a set of individuals with some shared characteristic.

To allow for this, we replace the fixed election and counterfactual districting plans with random variables $V\in\Elecs$ and $\tilde Q\in\Plans$.
The randomness here is primarily a conceptual device to simplify the notation, but one can also think of it as reflecting uncertainty or variation in voter preferences, the political environment, candidate quality, campaign events, and other factors.
The randomness in districting plans specifically may be conceptualized as the constraints and preferences of the plan-drawing process (i.e., plans which better respect the preferences are given a higher probability).
As we will discuss in Section \ref{sec:estimating}, generally we will assume that $V$ and $\tilde Q$ are independent, though this is not required for our theoretical analysis.
Finally, we will also replace $i$ with an individual $I$ taken uniformly at random from $\Voters$, with $I\indep V,\tilde Q$.

Then we may define the harm for a (randomly selected) individual under plan $q$ as $H(q) \dfeq h_I(V, q, \tilde Q)$.
Thus, for example, the harm for a single individual $i$ becomes $H(q)\mid I=i$; and the electorate's average harm in election $v$ becomes$$
\E[H(q)\mid V=v] = \Pr[v(I)\neq\win_I(v, q)
    \text{ and }v(I)=\win_I(v, \tilde Q)],
$$that is, the probability that a randomly selected voter in this election is misrepresented under the adopted plan but would not have been under a randomly selected counterfactual.

## Differential Harm and Fairness {#subsec:diff-harm}

Single-member districts are often motivated by the value in representation to specific communities with shared interests; indeed, preserving "communities of interest" is one of the most common statutory and constitutional requirements imposed by states on the plan-drawing process [@ncslcriteria].
It is therefore natural to consider not just the average harm to voters done by a plan, but also how this harm is distributed across certain groups of voters, defined by race, party, or other attributes of interest.

To that end, let $\Groups=\{G_1,G_2,\dots\}$ be a set of mutually exclusive groups of voters, so that for each voter $i$, we have $i\in G_k$ for some group $G_k$.
In general we will not require the group identities to be fixed with respect to elections.[^2]
This is because some group identities, like partisan preference, may themselves change election-to-election.

[^2]: Formally, we have random indicator variables $\ind\{i\in G_k\}$ for all $i$ and $k$, subject to the constraint that $\sum_k \ind\{i\in G_k\}=1$ for all $i$.
    These indicator variables may be correlated with $V$ and/or $\tilde Q$, in general.

Once we have defined a set of groups, we say that a plan $q$ is *fair* for groups $\Groups$ in comparison to a counterfactual $\tilde Q$ if $\E[H(q)\mid I\in G_k]$ is constant across groups $G_k\in\Groups$.

Fairness is a strict condition; any real-life plan will never be exactly fair.
To quantify deviations from fairness, we introduce the concept of *differential harm*, defined as $$
  \Delta_{G_k-G_l}H(q) \dfeq \E[H(q)\mid I\in G_k] - \E[H(q)\mid I\in G_l],
$$ for two groups $G_k$ and $G_l$.
So $\Delta_{G_k-G_l}H(q)$ will be positive if voters in group $G_k$ are harmed at a higher rate than voters in group $G_l$, indicating that plan $q$ favors $G_l$ over $G_k$.
Using our definition of fairness, $\Delta_{G_k-G_l}H(q)=0$ for all $G_k,G_l\in\Groups$ if and only if $q$ is fair.

It is this measure of differential harm that we propose as a unified framework for evaluating a districting plan across a variety of dimensions.
It is derived from an individual-level measure of representation and it accounts for the space of counterfactual possibilities.
Importantly, it separates *vote choice* from *group membership*, allowing one to discuss how partisan election outcomes under a specific districting plan create harm for specific groups or their interactions, simply by conditioning $H(q)$ on a set of individuals.

Estimating these quantities from available data is another matter, of course, and requires additional assumptions, as we describe next.

# Estimating the Harm Measures {#sec:estimating}

Harm $H(q)$ and differential harm $\Delta H(q)$ as defined above require specification of a probability distribution on elections and districting plans.
Depending on one's viewpoint, this is either a theoretical fiction which must be specified by a model, or an actual data-generating process we must aim to estimate.
Either way, past election data and an enacted districting plan alone are not enough to calculate these measures.

While not strictly necessary, modeling of $V$ and $\tilde Q$ independently will simplify the situation considerably.
Practically, this translates to the assumption that individual voters would make the same candidate choice no matter the districting plan.
To the extent that voters reward or punish an incumbent party for the districting plan they adopt, or that an adopted districting plan affects which candidates run in a district, this assumption is violated.
But as our suggested model for election outcomes $V$ will be quite coarse, not accounting for candidate factors or policy preferences, the marginal effect of this independence assumption on our conclusions will be minimal.

## Modeling Districting Plans

It is difficult to construct a tractable probability distribution for districting plans, since the space of plans is discrete and lacks a natural metric structure.
Thankfully, in recent years a number of algorithms have been developed which sample districting plans from specific distributions [@fifield2020mcmc; @deford2019; @carter2019; @mccartan2020].
These distributions can generally be characterized as maximum-entropy distributions on the space of all valid districting plans, in combination with several moment constraints.

For example, the algorithms of @carter2019 and @mccartan2020 sample from the maximum-entropy distribution of districting plans which are geographically contiguous, have district populations within a deviation from equality, and which have a certain average compactness value (according to a particular graph-theoretic compactness measure).
These maximum-entropy distributions put as few conditions as possible on the districting sampling process, as long as a set of constraints imposed by the researcher are met.
If these constraints are precisely those which are required by law or traditional redistricting criteria, then samples from this distribution provide a natural set of counterfactual districting plans, uninfluenced by superfluous partisan considerations, to use in estimating $H(q)$ and $\Delta H(q)$.
In practice, the translation from tradition and law into mathematical formulations of constraints is not always clear or even well-defined; there is certainly an element of subjectivity in sampling a set of districting plans.
Nonetheless, sampling methods are widely used in practice [see e.g., @2019rucho; @2018league; @2022merrill; @becker2021computational; @chen:rodd:13].

## Modeling Election Outcomes

Election results present a different set of modeling challenges, given the large number of factors that influence the outcome, and the general unpredictability of future events.
We limit our discussion here to the case of estimating harm and differential partisan harm in a two-party setting Estimating differential racial harm in the two-party setting can be done by first generating ecological inferences or survey estimates of party preference by race, and then applying methods analogous to those outlined here.
Multiparty or primary elections pose additional modeling challenges.
In Section \ref{sec:boston} we consider a spatial-racial model for primary elections with multiple candidates, to illustrate the application of our framework to these more complicated cases.

Motivated primarily by computational convenience and simplicity, we use a *proportionate uniform shift* model, which focuses on swings in the national political environment as the main determinant of election outcomes.
Election outcomes are modeled as a random deviation from a baseline outcome, and these deviations are assumed to consist of a constant fraction of voters of one party in each precinct switching to the other.
The baseline itself can be established by averaging the results of all available statewide elections over the past decade or other suitable period.
The proportionate uniform shift model is nearly identical to the uniform partisan swing model of @butler1951swing for most precincts and districts, but is more computationally convenient and avoids issues of vote shares exceeding 100% or falling below 0%.
Despite their simplicity, uniform-swing--type models are highly accurate for out-of-sample prediction [@katz2020], and are intuitive and easy to implement.
More details about our proportionate uniform shift model and how it may be used to efficiently estimate the harm measures may be found in Appendix \ref{app:formulas}.

More complicated election outcome models are certainly possible and straightforward to use with the measures proposed here.
For example, one could model district deviations as a systematic national shift plus a local idiosyncratic effect, as is done in the Stochastic Uniform Partisan Swing model of @gelman1994unified.
For ease and efficiency of computation, we stick to the simple proportionate uniform shift model here.

## Calculating Harm and Differential Harm

With a model for election outcomes and districting plans in hand, calculation of $H(q)$ and $\Delta H(q)$ is straightforward.
For each sample $\tilde q$ of a counterfactual districting plan, we use the election model to come up with a probability that voters in each precinct are represented by the candidate of their choice under $\tilde q$ but not under $q$.
When the groups used in $\Delta H(q)$ vary within precincts, we must repeat these computations for each group.
Then by summing across precincts and/or groups and dividing by the appropriate totals, we arrive at values for $H(q)$ and $\Delta H(q)$.
Appendix \ref{app:formulas} contains more details, including the specific formulas used to compute $H(q)$ and $\Delta H(q)$ for two-party elections from a set of past election returns and a sample of districting plans from a redistricting sampling algorithm.

# Connections to Current Practice for Analyzing Partisan and Racial Gerrymandering {#sec:connections}

While applicable to the study of redistricting beyond racial and partisan gerrymandering, the proposed harm measures provide an improvement over existing analytic approaches in both of these important contexts.

## Partisan Gerrymandering

The canonical framework for considering partisan fairness is partisan symmetry [@king1987democratic]. Partisan symmetry implies that the seats $s$ won by a party with vote share $v$ would be satisfied if $s(v) = 1 - s(1 - v)$. In practice, the partisan symmetry framework is applied via the partisan bias metric $\beta(v)$, which measures the seat deviation from symmetry [@tufte1973pb; @katz2020], i.e., the number of seats that would need to be reallocated to reach partisan symmetry for a given statewide vote share $v$ (usually $\half$).

More recently, and particularly in the years since @2004vieth, researchers have developed a veritable zoo of measures to identify partisan gerrymanders.
The *mean-median* difference looks at the relationship between the vote share of the median seat in a delegation and the mean vote share of the delegation to make claims about how a map is skewed [@mcdonald2015unfair].
The *declination* describes the relative rate at which districts become less competitive for each party [@warrington18].
Perhaps the new measure which has reached the most acclaim is the *efficiency gap* [@stephanopoulos2015], which measures the difference in the number of the votes wasted by each party.[^3]

[^3]: Wasted votes are those cast for a losing candidate, as well as those cast for a winning candidate beyond the required 50% to win the election.

The latter four metrics are grounded in intuition over how to reliably identify a partisan gerrymander, and not in a larger theoretical framework or normative standard (in particular, they do not measure partisan symmetry [@katz2020]).
As such, they make no distinction between the quantity they are trying to estimate and a particular estimator or formula used in calculations.
This is in contrast to partisan symmetry as well as the proposed harm measures, which require practitioners to take the additional step of linking observed election data to the theoretical construct by way of an election model, as discussed in Section \ref{sec:estimating}.[^4]
One advantage of the simpler metrics such as the efficiency gap is that they may quickly calculated using district vote shares alone.

[^4]: For partisan bias, both researchers and practitioners have largely relied on simple uniform-shift models similar to the one we use in this work.

All of these existing measures are constructed so that a value of zero indicates no bias, and a value of zero is at least implicitly held up as a normative standard for districting plans.
This poses a challenge for the measures which do not estimate a theoretical quantity, because it is unclear what the implicit standard is.
For partisan symmetry this is more explicit; @katz2020 write that "[o]bviously, a process designed to be 'fair' that turns out to be substantially asymmetric, if there is a fairer alternative, would not normally be regarded as a legitimate outcome."

But as those authors recognize, in evaluating a districting plan, it is critical to consider "if there is a fairer alternative." The inability of partisan bias and other existing measures to account for counterfactual districting plans means that none of them may be interpreted in a vacuum.
No particular value can be used as a threshold past which a plan becomes a gerrymander, because the measures confound the map-drawer's bias with the bias inherent to the district-based electoral system.

It is this confounding which explains many of the concerns that have been raised over the existing measures.
The standard calculation of partisan bias, $\beta(\half)$, can give unintuitive results in more lopsided states, which, if not interpreted carefully, can lead practitioners to make incorrect conclusions about the presence and direction of a partisan gerrymander.[^5]
And none of the measures take into account any aspect of political geography, and therefore suffer in states like Massachusetts, where, for example, the efficiency gap takes a value generally indicating an extreme Democratic gerrymander.

[^5]: This has been called by some the "Utah paradox" [@deford2020symmetry], though the paradoxical nature is contested as a mistake of using it for description, rather than inference [@katz2022].
    Even when interpreted carefully, however, partisan bias requires significant extrapolation from observed election outcomes in lopsided states---how realistic is it to evaluate the counterfactual where Democrats run even with Republicans statewide in Utah?

Despite these differences, there are also key empirical similarities in many cases.
The efficiency gap and differential partisan harm are often highly correlated (though the efficiency gap is much more discrete), as wasted votes and partisan harm are rooted in similar logic.[^6]
Similarly, in competitive states, where the baseline election has a statewide vote share near 50%, $\beta(\half)$ is highly correlated with the average number of seats won by each party and with differential partisan harm as well.
Correlations, of course, are not everything: it is the universal scale and centering of our harm measure which makes it more useful in evaluating partisan gerrymanders, as we demonstrate in Section \ref{sec:nj}.

[^6]: The differences stem from the efficiency gap considering a vote to be wasted if it is in excess of the 50% threshold needed to win, while the harm framework does not penalize such votes, since every such voter is happily represented by their candidate of choice.
    This definition of wasted votes is also at the root of other criticisms of the efficiency gap, which note its tendency to penalize proportionality and reward 3-to-1 districts [@bernstein2017egap; @tamcho2017egap; @deford2020symmetry].

Finally, it is worth comparing the proposed measures to the increasingly common application redistricting simulation techniques to cases of partisan gerrymandering.
Standard practice in such litigation, for example, is to calculate a battery of gerrymandering metrics on the simulated plans, and show that the challenged plan is an outlier on all or most of the metrics.
While this can help contextualize the challenged plan, it is not foolproof---if the underlying metric is misleading, it will still be misleading when applied to thousands of simulated plans.
In the worst cases, this can lead to directionally wrong conclusions, as we will see in Section \ref{sec:nj}.

These problems have led @deford2020symmetry, among others, to recommend evaluating the presence of a gerrymander simply by comparing the expected number of seats won under the plan versus the simulations We agree with this recommendation, as it turns out that in the partisan case, differential harm is in practice tightly related to the overall number of seats won by each party, as Section \ref{sec:nj} and Appendix \ref{app:corr} demonstrate.
However, unlike a direct measure of seats, differential harm is shifted so that a value of zero corresponds to fairness, and rescaled to be directly interpretable as a fraction of voters harmed.

## Racial Gerrymandering {#subsec:racial}

The study of racial gerrymandering and vote dilution is considerably more complicated than that of partisan gerrymandering, due to the difficulty of understanding racial voting preferences when individual votes are secret.
As such, no simple formulas exist to measure the precise racial impacts of a districting plan.
Indeed, much of the academic literature has focused on the statistical challenge of estimating vote preferences and turnout by race [@king1997solution; @greiner2006ecological; @imai2016improving].

The modern analysis of racial gerrymandering and vote dilution are inseparable from the Voting Rights Act of 1965 (VRA) and the 14th and 15 Amendments.
Section 2 of the VRA enables citizens to challenge districting plans in court for diluting the voting power of racial minorities.
Under the current framework established by @1986gingles, to do so, plaintiffs must prove that (a) the minority group is large and geographically compact enough to form a majority in some hypothetical district, (b) the minority group is "politically cohesive," and (c) the majority group can and does vote to deny the minority group its choice of candidate [@hood2018legal] (the so-called *Gingles* criteria).
Criteria (a) is generally proven through a single example districting plan, while criteria (b) and (c) are shown using the statistical estimates of vote preferences and turnout by race.

While the specific legal requirements for a vote dilution claim will obviously remain front-and-center for court challenges of racial gerrymanders, it is notable that the proposed harm measures unify all three *Gingles* criteria.
Criteria (b) and (c) captures the misrepresentation of minority voters by a candidate they do not support, while (a) requires the existence of a counterfactual where this would not be the case; together, (a) and (c) establish that minority voters are harmed.
But the proposed measures can also tackle trickier situations where the *Gingles* criteria may not be clearly met.

One such case arises when there are several distinct minority racial groups with similar preferences.
In these cases, some courts have found that (a) may be weakened to consider "coalition" districts that still allow minority voters overall to elect candidates of their choice, but there is no clear rule [@stephanopoulos2014south].
Or when urban White voters have similar partisan preferences to minority voters, (b) and (c) may not be strictly satisfied, especially for two-party general elections.
Some argue, however, that courts should still rely on the VRA in these cases to protect minority voters, especially in light of differing racial preferences in primary elections [@becker2021computational].

In both these cases, the proposed harm measures will quantify the extent to which a challenged districting plan differentially harms minority voters, taking into account their geographic and political cohesion, and the individual preferences of every voter.
Sections \ref{sec:alabama} and \ref{sec:boston} demonstrate this approach in practice.

# Application to Partisan Gerrymandering in New Jersey {#sec:nj}

To illustrate the connections in the preceding section and to demonstrate the value of the proposed measures in a real-world setting, we provide a brief analysis of congressional districting in the state of New Jersey.
As discussed above, many gerrymandering measures often function well in highly competitive states, but may produce more counterintuitive results in other states.
New Jersey, with an average Democratic two-party vote share of 56.6% across our two baseline elections (2016 presidential and 2018 senatorial), will demonstrate that this is not a problem unique to lopsided states.

```{r nj-maps, fig.width=6.5}
#| fig.cap: |
#|      Baseline vote patterns (a), two hypothetical gerrymanders (b) and (c),
#|      and one randomly sampled plan (d).
#|      County lines are overlaid in white.
include_graphics("figures/nj_maps.pdf")
```

Figure \ref{fig:nj-maps} shows the baseline Democratic vote share by precinct, along with two hypothetical gerrymanders of the state, which were generated using the short-burst optimization approach of @cannon2020.
The Democratic gerrymander has 11 Democratic seats and 1 Republican seat at baseline, while the Republican gerrymander has 6 Democratic and 6 Republican seats.

We sample 10,000 districting plans across four independent runs of the SMC algorithm of @mccartan2020, setting constraints to favor compact plans with district boundaries that tend to follow county lines.
One such plan is shown in Figure \ref{fig:nj-maps}(d).
For each of these sampled plans and the two gerrymanders, we calculate the average harm and differential partisan harm versus the simulated baseline,[^7] as well as the expected number of Democratic seats, the efficiency gap, partisan bias, the mean-median score, and partisan declination.
The distribution of these measures is shown in Figure \ref{fig:nj-meas}.

[^7]: We choose to calculate $\Delta_{\dem-\rep}H(q)$, so that positive values correspond to a plan that favors Republicans.

```{r nj-meas, fig.width=7}
#| fig.cap: |
#|      The distribution of the existing and proposed measures across a sample of plans,
#|      with the values for two gerrymanders overlaid as vertical lines.
#|      The dashed line indicates a value of zero.
include_graphics("figures/nj_meas.pdf")
```

We first examine the values of each metric on the two example plans alone.
The estimate of differential partisan harm correctly identifies the partisan skew of each gerrymander, with a large negative value for the Democratic gerrymander and a small positive value for the Republican gerrymander.
These values are relatively directly interpretable; for example, the differential harm score of $-0.109$ means that an average Democratic voter is 10.9% less likely to be misrepresented than their average Republican counter-partisan.
The efficiency gap and declination measures also correctly identify the gerrymanders, though they are much more discrete, and the efficiency gap gives roughly equal scores in absolute value to the Democratic and Republican plans, in comparison to differential harm and declination, which identify the Democratic gerrymander as more extreme.
In contrast, the usual partisan bias estimator classifies the Republican gerrymander as favoring Democrats and vice versa.
While the mean-median measure identifies the Democratic gerrymander, it classifies the Republican gerrymander as a an even more extreme Democratic-leaning outlier.

Considering the distribution of these statistics across the sampled plans doesn't help much, either.
The expected number of Democratic seats naturally identifies the gerrymanders (two-sided $p=0.0002$) and the direction of bias.
The gerrymanders are also an outlier under the efficiency gap and declination measures also (both $p=0.0002$), and in the correct direction.
While the Republican gerrymander is an outlier for the partisan bias and mean-median score ($p=0.0224$ and $p=0.0004$), the Democratic gerrymander is only an outlier for the mean-median score($p=0.0004$ compared to $p=0.349$ for partisan bias).
All of the plans identified as outliers under these two metrics are identified in the wrong direction.

There is also disagreement between the measures about the natural bias of districting plans in New Jersey: the median sampled plan has a partisan bias of $0.020$, indicating a natural Republican bias, but the median mean-median score is just $0.0040$, and the median differential partisan harm is $-0.032$, indicating a natural Democratic bias.
Which is correct?
It depends on what one means by "natural bias," though we submit that differential harm is one good way to measure it.
Democrats do win 8.4 seats on average across the simulations, which is more than the 6.8 seats that would be expected under a completely proportional outcome.
It is important to note that a value of zero estimated differential harm does not necessarily correspond to proportionality; the simulated plan with an estimated differential harm closest to zero yieled 8.1 expected Democratic seats.

Both gerrymanders excessively harm the average voter, with the Democratic plan doing so at a moderately higher rate ($p=0.0004$ for the Democratic plan, $p=0.0008$ for the Republican plan).
Notably, the plans which minimize total harm are also those which have near-zero differential partisan harm.
Thus, at least in New Jersey, overall harm reduction is consistent with a fair map on a partisan basis.
Minimizing bias with other measures, however, could lead one astray: plans which score an efficiency gap of zero can have a large average harm, which may not be distributed fairly between parties.
Plans with zero partisan bias or mean-median score actually have higher-than-average harm and tend to differentially harm Republicans.

Figure \ref{fig:nj-pairs} in the appendix expands on Figure \ref{fig:nj-meas} to also show the correlations between these various measures.
Expected Democratic seats, the differential harm estimates, the efficiency gap, and declination are all moderately correlated with each other.
Similarly, partisan bias and the mean-median score are moderately correlated, but very weakly correlated with the expected number of Democratic seats. 
New Jersey is just one state, and while some of the correlations between measures here are found in other states, some are not.
Appendix \ref{app:corr} shows these correlations across simulated plans in eight states.
The most consistent correlation is between estimated differential partisan harm and the expected number of seats won by each party, which is usually around 0.82, and always above 0.66 in the eight states we study.

# Application to Voting Rights Litigation in Alabama {#sec:alabama}

We next apply our proposed framework to @2022merrill, ongoing VRA litigation in which civil rights groups have argued that the existing Black majority district packs Black voters, and so a second Black opportunity-to-elect district should be drawn.[^8]

[^8]: Relevant court filings are available at <https://redistricting.lls.edu/case/milligan-v-merrill/>.

As discussed in Section \ref{subsec:racial}, plaintiffs had to satisfy the first *Gingles* criterion by submitting one or more remedial maps demonstrating that a new Black opportunity-to-elect district could be drawn while meeting all other redistricting requirements.
In *Merrill,* the plaintiff's expert, Moon Duchin, submitted four such remedial plans, one of which is shown in Figure \ref{fig:al-maps}(e).
These plans form a natural counterfactual $\tilde Q$ to use in analyzing the challenged districting plan (Figure \ref{fig:al-maps}(d)), especially since the federal district court ruled in favor of the plaintiffs and found that their remedial plans satisfied the first *Gingles* criterion.

This analysis is slightly more complicated than in New Jersey, since in order to understand the racial distribution of harm we need to estimate voting preferences by race.
As is custom in VRA analyses, we use an ecological inference model.
The model, detailed in Appendix \ref{app:alei}, jointly estimates turnout and vote choice by race and precinct across seven statewide elections.
Voting is highly polarized by race outside of the cities of Birmingham and Montgomery.

With these estimates in hand, we can estimate the average number of voters harmed in each precinct and racial group.
Figure \ref{fig:al-maps}(c) shows the estimated geographic distribution of harm.
Even without the ecological estimates, it is immediately clear, with reference to the partisan and racial patterns shown in Figures \ref{fig:al-maps}(a) and (b), that harm is concentrated among Black and Democratic voters in Birmingham, Montgomery, and the southern end of the Black Belt region.
These areas are excluded from the Black-majority district under the challenged plan, but are included in a Black-majority district in the average remedial plan.

```{r al-maps, fig.width=6.75}
#| fig.cap: |
#|      Top row: baseline vote patterns (a),
#|      fraction of the voting-age population which is Black (b),
#|      the expected fraction of voters in each precinct which are harmed by 
#|      the 2020 enacted congressional districts versus the set of four remedial 
#|      plans (c).
#|      2020 enacted district boundaries are overlaid
#|      in black on the leftmost map and in white on the other maps.
#|      Bottom row: the challenged plan and a submitted remedial plan 
#|      (d) and (e) colored by each district's Black share of the voting-age
#|      population, and the expected number of harmed voters in each 
#|      race/partisan group, relative to the total number of such voters (f).
include_graphics("figures/al_maps.pdf")
```

This intuition is confirmed by a closer analysis, summarized in Figure \ref{fig:al-maps}(f).
Across the state, the estimated average harm is 0.082, which translates to around 161,000 voters.
Of these harmed voters, around 136,000 are Black, while 25,000 are White.
Similarly, 151,000 are Democratic, while only 10,000 are Republican.
Of course, the total number of each of these groups of voters is very different.
Normalizing by group sizes, the expected harm for a Black Democrat is 0.25, for a Black Republican is 0.015, for a White Democrat is 0.091, and for a White Republican is 0.0073.
Thus while the challenged plan differentially harms both Black voters and Democratic voters, it *especially* harms Black Democrats, who have a differential harm of 0.158 versus White Democrats and a differential harm of 0.235 versus Black Republicans.

These calculations are made by aggregating harm within racial groups at the precinct level, and so they automatically take into account individual voter preferences.
Unlike in a traditional ecological/*Gingles* analysis, there is no need to identify a particular party as the statewide "choice" of the minority racial group, nor is there any cause for concern because of lower racial voting polarization in urban areas.
The harm measure treats voters of every race and location equally, recording just their inability to elect their preferred candidate.
Only once we have aggregated these individual harms does it become apparent that the challenged plan concentrates the harm among certain groups of voters.

# Application to Primary Elections in Boston {#sec:boston}

The proposed harm measures are particularly easy to calculate and interpret in a partisan context, since the preferences of each kind of partisan are directly observable as partisan vote shares.
However, the same framework can be fruitfully applied to more complex settings, providing insights that go beyond those available through traditional methods.

```{r boston-map, fig.width=6.75, fig.height=3.375}
#| fig.cap: |
#|      Racial composition of the city of Boston (left)
#|      and 2010 city council districts (right).
#|      Neighborhood boundaries are overlaid in black on the
#|      left map and in white on the right map.
include_graphics("figures/boston_map.pdf")
```

The city of Boston is governed by a mayor and a nonpartisan 13-member city council.
Nine of the councilors are elected from contiguous city council districts, and the remaining four councilors are elected at-large, with all councilors serving two-year terms.
Council district boundaries are redrawn every ten years following the decennial census, and must be equipopulous, be compact, and preserve neighborhood and community boundaries.[^9]
This section will study the extent to which the current district boundaries differentially harm voters of different racial groups, in comparison to a completely race-neutral districting process.
Figure \ref{fig:boston-map} shows the racial composition of the city as well as the boundaries of the 2010 city council districts and the city's official neighborhoods.

[^9]: City of Boston charter.
    Available at <https://www.boston.gov/sites/default/files/embed/b/boston-city-charter-2007.pdf>.

## Approach

To apply our proposed framework to study the council district boundaries, we need to be able to predict individual voting preferences under counterfactual districting plans.
This is more difficult than in both New Jersey and Alabama, for two reasons.
First, the city council is officially nonpartisan and city politics are dominated by the Democratic Party, so voting preferences are more complex than a simple partisan preference.
To estimate election outcomes, we require some way of mapping observed support for particular candidates in one election onto counterfactual support for a hypothetical candidate in another election.
Second, as in Alabama, we aim to examine the racial impact of the district system, and thus must estimate these voting preferences by race.
Even if we could, for instance, divide candidates into a more "liberal" and a more "conservative" group, the vote counts for each group by precinct will not alone show how different racial groups voted.

```{r boston-factors, fig.cap="", fig.width=7, fig.height=3.5}
#| fig.cap: |
#|      Candidate factor loadings, with approximate 80\% credible intervals shown as
#|      ellipses (left), and geographic variation in factor values by race (right).
#|      Neighborhood boundaries overlaid in black.
#|      Factor values in the Black second-dimension map are truncated so that variation in the other maps is visible.
include_graphics("figures/boston_factors.pdf")
```

To solve both of these problems, we develop a *latent factor ecological inference model*, which simultaneously estimates (a) turnout by precinct and race, (b) candidate positions in a latent two-dimensional political space,[^10] and (c) voter preferences in this space by precinct and race, using precinct-level demographic data and vote totals from the March 2020 presidential primary and September 2021 mayoral preliminary elections.
Figure \ref{fig:boston-factors} shows the key outputs from this model, and Appendix \ref{app:lfei} explains the model in detail.

[^10]: Exploratory analyses found that three latent dimensions did not provide a substantially better fit to the data.

Like all ecological inference models, ours rests on several unverifiable assumptions.
The latent factor component imposes additional assumptions about the structure of voting in Boston elections.
As Appendix \ref{app:lfei} discusses, these assumptions are almost certainly not strictly met.
Yet we believe that the model is a useful simplification of reality that captures the major electoral dynamics that are relevant to our question of interest.
For example, using the estimated latent positions and support levels for Michelle Wu and Annissa Essaibi-George, the two mayoral candidates that advanced to the general election, we were able to predict the precinct-level general election turnout and vote shares with considerable accuracy (Spearman correlation $\approx 0.85$, see Figure \ref{fig:boston-gen-pred} in Appendix \ref{app:lfei}).
We stress that the latent factor ecological inference model is not necessary for this kind of analysis; local survey data that collected ideological preferences and racial information would also suffice.

## Results

As Figure \ref{fig:boston-factors} shows, primary voting preferences in Boston are polarized by race, especially for the second latent dimension.
But there is significant variation within racial groups as well, such as the split between more conservative White voters in South Boston and more liberal White voters in Jamaica Plain (the first latent dimension appears to capture a progressive-moderate divide).
It is certainly possible, then, that the particular way districts are drawn will have an effect on the ability of different racial groups to elect their candidate of choice.

We consider two different scenarios: one in which all of the council races are contested along the first latent dimension, and one in which the races are contested along the second.
Specifically, we draw voter choices between two candidates from the posterior predictive distribution of our model, setting the candidates' loadings to --1 and 1 on the chosen dimension and 0 on the other dimension.
We draw the overall level of support from a $\Beta(15, 15)$ distribution, which means that we will study election scenarios where the overall vote share for each bloc of candidates ranges from roughly 30 to 70 percent.
The posterior predictive draws yield counts of voters for each candidate in each precinct by race, from which we can calculate winners at the district level, under any configuration of districts.

We limit our hypothetical elections to two candidates, to simplify the challenges of measuring harm with many candidates, over which voters may have different ranked preferences.
However, our use of latent factors provides one way to extend our harm framework to the multiple-candidate setting.
One could weight voter harm by the distance in latent space between each voter's preferred candidate and the elected candidate, thus dropping the implicit assumption that all candidates the voter did not vote for are interchangeable.

We sample 2,000 redistricting plans across two independent runs of the SMC algorithm of @mccartan2020, setting constraints to favor compact plans that respect neighborhood boundaries.
Since we do not provide any racial information to the algorithm, this set of plans forms a good approximation of a race-neutral districting process.

For the first scenario, where council races are contested along the ideological axis, we estimate that the enacted plan is quite fair, differentially harming White voters at a rate of only 0.0079 compared to the race-neutral baseline.
For the second scenario, where the contests are oriented along the racial dimension, we estimate that the enacted plan differentially harms White voters at a rate of 0.041, compared to the race-neutral baseline.

We can also flip the setup and compute harm by averaging over the simulated plans and using the enacted plan as a counterfactual.
This will produce a different answer, since harm is not symmetric between the study plan and the counterfactual.
Along the first dimension, we estimate that a race-neutral baseline would differentially harm Black voters at a rate of 0.031 compared to the enacted plan, while along the second dimension, the differential harm would be 0.018.

Taken together, these findings suggest that despite the dominance of the Democratic party in city politics, and the shared preferences between certain groups of Black and White voters, race-aware districting still serves an important role in empowering Black voters across the city to elect their chosen candidates.
Further study could focus on the racial impact of the four at-large members in comparison to a system with 13 districts and no at-large members.

# Discussion {#sec:discussion}

This paper offers a new framework for studying redistricting that brings together a focus on individual voter preferences and the causal-inference logic of counterfactuals.
The combination of these ideas imbues the analysis of districting plans with the historical understandings of legal standing and harm.
This focus naturally leads to a new normative standard of plan fairness, which is achieved when the necessary harms of a districting plan are distributed evenly across voters.

Compared to existing alternatives, differential harm more accurately identifies partisan gerrymanders---both in sign and in existence.
The exact same approach applies beyond partisanship and allows for the calculation of differential harms by race and other protected groups.
By centering the framework on individual voters' choices, we sidestep the need to blindly associate voters' preferences with their group memberships.
Analysts can model vote choice separately, estimate the harm to each individual, and then aggregate by any group of interest.
As Section \ref{sec:nj}--\ref{sec:boston} showed, this opens up space for more nuanced analyses that can extend to the local level as well.

The proposed framework is far from the end of the road.
Its flexibility comes at a cost---most notably, the need to specify a set of counterfactual districting plans, the choice of which has a significant impact on conclusions.
While modern simulation methods are a valuable starting point, these methods involve analyst discretion and interpretation of often-murky legal standards.
When subjective choices are not represented consistently, different analyses may arrive at different conclusions about which voters are harmed and at what rate.

Modeling future elections poses another set of challenges.
Simple models are easy to build from commonly-available data and are computationally tractable, but are gross simplifications of reality.
More realistic models require more analyst thought and can add significant burden to the calculation of our harm measures.
And as discussed in Section \ref{subsec:harm}, multi-candidate elections where voters have strong ordinal preferences provide further challenges that the proposed framework does not fully address.
Each of these limitations present opportunities for future study.

At its core, redistricting is a multifaceted and high-dimensional problem that must balance political, legal, and administrative constraints to allow citizens to exercise their rights.
A districting plan can never be boiled down to a single number.
But we hope our approach provides a modular and flexible set of measures that can help decompose how various components of the electoral system combine to produce observed patterns and election outcomes.
Researchers can and should tinker with our assumptions and push our framework further to better apply it to multi-candidate elections, more realistic election models, and beyond district-based electoral systems.

# References {.unnumbered}

::: {#refs}
:::

```{=tex}
\vspace{1in}
\appendix
\renewcommand\thefigure{\thesection.\arabic{figure}}
\renewcommand\thetable{\thesection.\arabic{table}}
\setcounter{figure}{0}
\setcounter{table}{0}
```
# Computing Harm Measures from Precinct-level Election Data {#app:formulas}

In practice, districting plans are built from discrete geographic units (often precincts), and election returns are reported at this level as well.[^11]
Throughout this appendix, let $j$ index the set of electoral precincts or other units.
For concreteness here and without loss of generality we will use the Democratic party as the reference party, letting $s_{jv}$ denote the Democratic two-party vote share in precinct $j$ in election $v$.
Write-in or minor third-party candidates can be safely ignored, since the overall winner will be precisely the two-party vote winner.

[^11]: When district boundaries split precincts, practitioners generally impute the returns in each component of the split precinct by population-weighted interpolation.
    Population information comes from Census blocks, which, when populated, are practically never split.

## Proportionate Uniform Shift Details

The proportionate uniform shift model assumes that from one election to another, a constant fraction of *voters of one party* in each precinct switch to the other party, and that per-precinct turnout is constant across elections.[^12]
This has several advantages over the uniform swing model, where a constant fraction of *all voters* shifts parties.
First, the proportionate shift prevents hypothetical party vote shares from exceeding 1 or falling below 0 in any precinct.
Second, as it has the effect of scaling vote shares across precincts by a constant multiple, it preserves the relative balance of a party's voters across precincts.
For $\Delta_{\dem-\rep}H(q)$, which considers voters in each party separately, this helpfully simplifies computations.

[^12]: Everything carries through if one allows for shifts in the overall turnout level across elections, as long as (a) the relative turnout across precincts is fixed, and (b) turnout shifts are independent of shifts in party preferences.

The proportionate shift may be mathematically expressed as linear shift on a transformed scale, not unlike a generalized linear model.
Specifically, we define $\gamma:[0,1]\to\R$, $$
\gamma(x) = -\thalf\sgn(x-\thalf)\log(1-2\qty|x-\thalf|),
$$ which is the inverse CDF of a Laplace distribution with rate 2.[^13]
Then the Democratic vote share in precinct $P_j$ and election $v$, notated here as $s_{jv}$, is modeled as $$
\gamma(s_{jv}) = \gamma(\overline s_j) + \eps_v, \qquad \eps_v \iid \Norm(0, \sigma^2_{\mathrm{hist}}),
$$ where $\overline{s}_j$ is the party baseline in the precinct, and $\sigma^2_\mathrm{hist}$ is estimated from the historical variability in nationwide popular vote shares.
For congressional elections in the United States from 1974--2018, we have $\widehat\sigma^2_\mathrm{hist}=0.03723$, and so draw predictive deviations from $\mathrm{t}_{22}(0, \widehat\sigma^2_\mathrm{hist})$.

[^13]: A rate of 2 is chosen so that the slope of the link function at $\half$ is exactly 1, meaning that transformed vote shares will be on approximately the same scale as the original shares.

It will simplify matters following to have notation for the overall Democratic vote share in a district.
For a precinct $j$, let $q^{-1}(j)$ denote the district it belongs to.
Then let $$
    S_{q^{-1}(j), v}=\frac{\sum_{l\in q^{-1}(j)} s_{lv}\avgvote_l}{\sum_{l\in q^{-1}(j)} \avgvote_l}
$$ denote the vote share in the district, where $\avgvote_l$ counts the total number of votes in precinct $l$ at baseline.
The baseline vote share in the district is then $\bar S_{q^{-1}(j)}$.

## Estimating $H(q)$ and $\Delta H_{\dem-\rep}(q)$

We will build up estimates of the overall $H(q)$ and $\Delta H_{\dem-\rep}(q)$ from precinct-by-group harm estimates.
Since we assumed that elections are independent of districting plans, we can first average across elections and then across counterfactual plans.
For a random voter $I$ in precinct $j$, we have for every plan $q$ that the probability of a Democrat winning their district is $$
\Pr(\win_I(V, q)=\dem\mid I\in j)
= \Pr\qty(S_{q^{-1}(j),V} > \half)
= \Phi\qty(\frac{\gamma(\bar S_{q^{-1}(j)})}{\sigma^2_\mathrm{hist}}),
$$ where $\Phi$ is the standard Normal CDF. To estimate this probability, we simply replace $\Phi$ with the CDF of the $t_{22}$ distribution ($F_{t_{22}}$), and $\sigma^2_\mathrm{hist}$ with $\hat\sigma^2_\mathrm{hist}$.
Extending one step further, for two plans $q$ and $\tilde q$, we have

```{=tex}
\begin{equation}\label{eq:appharm1}
\Pr(\win_I(V, q)=\rep\text{ and }\win_I(V, \tilde q)=\dem\mid I\in j)
= \Pr\qty(S_{q^{-1}(j),V} < \half, S_{\tilde q^{-1}(j),V} > \half).
\end{equation}
```
Because of the uniform shift, for any election $v$, $S_{q^{-1}(j),v} - S_{\tilde q^{-1}(j),v}$ is constant.
Therefore if $S_{q^{-1}(j),v}>S_{\tilde q^{-1}(j),v}$, this probability is zero (if a Democrat wins under $\tilde q$ they will definitely win under $q$, which has a higher Democratic vote share).
But if $S_{q^{-1}(j),v}<S_{\tilde q^{-1}(j),v}$, we can rewrite \eqref{eq:appharm1} as the probability that $\eps_{V}$ falls in a particular range.
Specifically, we have in general that

```{=tex}
\begin{equation}\label{eq:appharm2}
\Pr(\win_I(V, q)=\rep\text{ and }\win_I(V, \tilde q)=\dem\mid I\in j)
= \max\qty{\Phi\qty(\frac{\gamma(\bar S_{\tilde q^{-1}(j)})}{\sigma^2_\mathrm{hist}})
- \Phi\qty(\frac{\gamma(\bar S_{q^{-1}(j)})}{\sigma^2_\mathrm{hist}}), 0}.
\end{equation}
```
If we condition on $V(I)=\dem$, then \eqref{eq:appharm2} is exactly the expected harm to voter $I$ under plans $q$ and $\tilde q$.
The calculation is the same, up to sign changes, for the expected harm conditioning on $V(I)=\rep$.
This completes the first step: averaging harm within precinct and groups and across elections.

We can then estimate the average across counterfactual plans $\tilde Q$ with the usual Monte Carlo estimator: $$
    \hat h_{j,\dem}(q)
    \dfeq \frac{1}{N_\text{sim}} \sum_{k=1}^{N_\text{sim}}
    \max\qty{F_{t_{22}}\qty(\frac{\gamma(\bar S_{\tilde q_k^{-1}(j)})}{\sigma^2_\mathrm{hist}})
        - F_{t_{22}}\qty(\frac{\gamma(\bar S_{q^{-1}(j)})}{\sigma^2_\mathrm{hist}}), 0},
$$ where $\hat h_{j,\dem}(q)$ is our estimate of the average harm to a Democratic voter in precinct $j$, averaging across $V$ and $\tilde Q$.
The corresponding $\hat h_{j,\rep}(q)$ is computed similarly.

Our final estimates $\hat H(q)$ and $\Delta_{\dem-\rep}\hat H(q)$ may then be straightforwardly calculated as weighted averages:

```{=tex}
\begin{align*}
\hat H(q) &\dfeq
\frac{\sum_{j} (\bar s_j\hat h_{j,\dem}(q) +
(1-\bar s_j)\hat h_{j,\rep}(q))\avgvote_j}{\sum_{j} \avgvote_j} \qand \\
\Delta_{\dem-\rep}\hat H(q) &\dfeq
\frac{\sum_{j} (\hat h_{j,\dem}(q) - \hat h_{j,\rep}(q))\avgvote_j}{\sum_{j} \avgvote_j}.
\end{align*}
```
Here, we rely on the fact that even across election shifts, the relative balance of each party's voters across precincts is preserved.

# Correlation Between Partisan Gerrymandering Metrics Across Multiple States {#app:corr}

Figure \ref{fig:nj-pairs} expands on Figure \ref{fig:nj-meas} in the main text with pairwise scatterplots and correlation summaries. 

```{r nj-pairs, fig.width=7, fig.height=7}
#| fig.cap: |
#|      Scatterplots for all pairs of measures.
#|      The Democratic and Republican gerrymanders are shown
#|      with the blue and red lines and crosses.
#|      The dashed line indicates a value of zero.
#|      Below the diagonal, numbers indicate the absolute value of the correlation between variables.
include_graphics("figures/nj_pairs.pdf")
```

Table \ref{tab:corr} below reports the correlation between differential harm and the partisan gerrymandering metrics used in Section \ref{sec:nj} for eight states which cover a wide range of partisan leans and number of seats:

-   Utah, with 4 districts and a Democratic vote share baseline of 33%
-   Mississippi, with 4 districts and a Democratic vote share baseline of 43%
-   Iowa, with 4 districts and a Democratic vote share baseline of 46%
-   North Carolina, with 14 districts and a Democratic vote share baseline of 50%
-   Wisconsin, with 8 districts and a Democratic vote share baseline of 51%
-   New Jersey, with 12 districts and a Democratic vote share baseline of 57%
-   Massachusetts, with 9 districts and a Democratic vote share baseline of 61%
-   California, with 52 districts and a Democratic vote share baseline of 65%

The correlations are calculated across 5,000 simulated plans for each state.
The simulations are provided by the 50-State Simulation Project [@mccartan2022fiftystates].
In particular, the New Jersey simulations are not the same as those used in Section \ref{sec:nj}.

```{=tex}
\begin{table}[h!]
\centering
\input{figures/corr_table.tex}
\vspace{0.1in}
\caption{Correlations between five gerrymandering metrics and partisan differential harm, for simulated districting plans from eight states. Declination is NA for Massachusetts since there are no Republican-leaning districts at baseline under any simulated plan.}
\label{tab:corr}
\end{table}
```
# Ecological Inference Model for Alabama {#app:alei}

To estimate voter preferences by race and precinct in Alabama, we use 2020 U.S.
Census demographic data and election returns from seven recent statewide elections: the 2016 races for president and U.S. senator, the 2018 races for governor, attorney general, and secretary of state, and the 2020 races for president and U.S. senator.
Our ecological inference model used to produce the estimates is broadly similar to that of @king1997solution.
However, it jointly estimates both turnout and Democratic support across all seven elections, rather than estimating each quantity separately for each election.

Adapting the notation from the previous appendix, for precinct $j$ in election $v$, let $\vap_j$ denote the voting-age population, $\votes_{jv}$ denote the total number of votes cast for major-party candidates, $s_{jv}$ denote the Democratic vote share, and $p_{jr}$ denote the fraction of the voting-age population belonging to racial group $r$, where here $r\in\{\text{White},\text{Black},\text{Other}\}$.
Our main parameters of interest are $\turn_{jr}$ and $\supp_{jr}$, the baseline turnout and Democratic support rate by race in the precinct.

We model the observed turnout $\votes_{jv}$ and vote counts $s_{jk}\votes_{jv}$ as \begin{align*}
    \votes_{jv} \mid \turn_{jr}, \beta^{(t)}_v
        &\sim \Binlog\qty(\vap_j, \logit(\turn_j^\top\vb p_j) + \beta^{(t)}_v) \\
    \logit(\turn_j) \mid \mu^{(t)}, \Sigma^{(t)}
        &\sim \Norm(\mu^{(t)}, \Sigma^{(t)}) \\
    s_{jv}\votes_{jv} \mid \supp_{jr}, \turn_{jr}, \beta^{(s)}_v
        &\sim \Binlog\qty(\votes_{jv}, \logit\qty(
        \supp_j^\top \frac{\turn_j\circ\vb p_j}{\turn_j^\top\vb p_j}) + \beta^{(s)}_v) \\
    \logit(\supp_j) \mid \mu^{(s)}, \Sigma^{(s)}
        &\sim \Norm(\mu^{(s)}, \Sigma^{(t)}),
\end{align*} where the $\vb*\beta^{(t)}$ and $\vb*\beta^{(s)}$ model election-specific logit shifts, $\Binlog$ indicates the Binomial distribution with the probability parameter specified on the logit scale, and $\circ$ indicates the elementwise (Hadamard) product.
We give $\vb*\beta^{(t)}$ an i.i.d. $\Norm(0, 0.6^2)$ prior,and $\vb*\beta^{(s)}$ an i.i.d. $\Norm(0, 0.4^2)$ prior, and $\mu^{(t)}$ an i.i.d. $\Norm(0, 1.5^2)$ prior.
We set priors independently on the variance and correlation components of $\Sigma^{(t)}$ and $\Sigma^{(s)}$; the former received $\Gam(1.5, 1.5/0.5)$ and $\Gam(1.5, 1.5/0.25)$ priors for turnout and support, while the latter received uniform priors (i.e., LKJ priors with shape parameter 1).
Several reparametrizations were made for computational efficiency; the full Stan code for the model is available as part of the replication code.

```{r alabama-ei, fig.width=6.5}
#| fig.cap: |
#|      Model estimates of precinct-level turnout by race (a) 
#|      and Democratic support by race (b).
#|      Points are sized in proportion to their voting-age population, 
#|      and colored according to their Black share of the voting-age population.
#|      All axes are transformed to a logit scale.
include_graphics("figures/al_ei.pdf")
```

The mean support $\mu^{(s)}$ receives an informative prior based on the racially polarized voting estimates of @kuriwaki2021geography, with $\mu^{(s)}\sim\Norm(\logit((0.18, 0.90, 0.35)), (0.04^2, 0.04^2, 0.2^2))$.
These estimates were derived through multilevel regression and poststratification from survey data, calibrated to actual election results.

The model was fitted with a mean-field variational approximation for computational efficiency.
Posterior medians of $\turn_{jr}$ and $\supp_{jr}$ are plotted in Figure \ref{fig:alabama-ei}.
These estimates broadly track with the findings of the voting rights expert retained in *Merrill*.

# Latent Factor Ecological Inference Model for Boston Primary Elections {#app:lfei}

To estimate voter preferences by race and precinct in Boston, we use 2020 U.S.
Census demographic data and election returns from the March 2020 presidential primary and the September 2021 mayoral preliminary elections.
Our ecological inference model used to produce the estimates expands on the model in Appendix \ref{app:alei}, jointly estimating both turnout and vote choice in the two elections.
However, it estimates voter preferences in a two-dimensional latent space and also estimates candidates' positions in this space.

Continuing the notation from above, for precinct $j$ in election $v$, let $\vap_j$ denote the voting-age population, $\votes_{jv}$ denote the total number of votes cast for major-party candidates, $s_{jk}$ denote the vote share for candidate $k$ (who implicitly belongs to a particular election $v_k$), and $p_{jr}$ denote the fraction of the voting-age population belonging to racial group $r$, where here $r\in\{\text{White},\text{Black},\text{Hispanic},\text{Other}\}$ ("Other" consisting primarily of Asian voters in Boston).
Our main parameters of interest are $\turn_{jr}$, the baseline turnout by race and precinct, $\pref_{jqr}$, the preferences in latent dimension $q$ by race and precinct, and $L_{kq}$, the loading of each candidate on latent dimension $q$.
Here $q\in\{1,2\}$, since preliminary analyses found no improved fit when expanding to three dimensions.

We model the observed turnout $\votes_{jv}$ and vote shares $s_{jk}$ as \begin{align*}
    \votes_{jv} \mid \turn_{jr}, \beta^{(t)}_v
        &\sim \Binlog\qty(\vap_j, \logit(\turn_j^\top\vb p_j) + \beta^{(t)}_v) \\
    \logit(\turn_j) \mid \mu^{(t)}, \Sigma^{(t)}
        &\sim \Norm(\mu^{(t)}, \Sigma^{(t)}) \\
    \logit(s_{jk}) \mid \pi_{jk}, \eps &\sim \Norm(\pi_{jk}, \frac{\eps}{1+\votes_{jv_k}}) \\ 
    \pi_{jk} &= \beta^{(s)}_k + \alpha_k
        \pref_{j}^\top(\turn_j\circ \vb p_j)\mathrm{diag}(\vb*\rho)\vb L_k  \\
    \pref_{jq} \mid \Sigma^{(p)} &\sim \Norm(0, \Sigma^{(p)}).
\end{align*} Note that $\pref_j$ is a $q\times r$ matrix of preferences by race and dimension within precinct $j$, and $\turn_j\circ \vb p_j$ is a vector of the percentages of the total VAP in the precinct that belongs to voters of each race, so $\pref_{j}^\top(\turn_j\circ \vb p_j)$ is a vector with $q$ elements containing the preferences by dimension of the precinct's voters, after marginalizing out race.
The matrix $\mathrm{diag}(\vb*\rho)$ captures the relative scale or importance of each dimension to the overall outcomes.

Because of the latent factor model, we do not require that vote shares by race and precinct, when tallied by race, necessarily equal the observed vote share in the precinct.
As a result we choose to model the vote shares directly, which is more computationally efficient.
Since these vote shares come from Binomial observations, they have variance inversely proportional to the total number of votes in the precinct (the additional 1 is to avoid divide-by-zero errors).
The multiplicative factor $\eps$ captures the additional variance that isn't accounted for by the latent factors.
The $\vb*\alpha$ parameters are "fudge factors" that adjust the scale of the deviations from each candidate's average support.

We give $\vb*\beta^{(t)}$ an i.i.d. $\Norm(0, 0.5^2)$ prior,and $\vb*\beta^{(s)}$ an i.i.d. $\Norm(0, 4.0^2)$ prior, and $\logit(\mu^{(t)})$ an i.i.d. $\Beta(10, 30)$ prior.
We set priors independently on the variance and correlation components of $\Sigma^{(t)}$ and $\Sigma^{(p)}$; the former has $\Gam(1.5, 1.5/0.25)$ and $\Gam(1.5, 1.5/1.0)$ priors for turnout and support, while the latter have LKJ priors with shape parameters 4.0 and 20.0.
A larger LKJ shape parameter places more weight on correlation matrices closer to diagonal, i.e., it regularizes away from high correlations.
The scale parameters $\vb*\rho$ have i.i.d. $\Gam(1.5, 1.5/4.0)$ priors, the fudge factors $\vb*\alpha$ have i.i.d. $\Gam(5.0, 5.0)$ priors, and $\eps$ has an $\Expo(1/4.0)$ prior.
Overall, these priors weakly identify the location and scale of the parameters.
Several reparametrizations were made for computational efficiency; the full Stan code for the model is available as part of the replication code.

Like all probabilistic factor models, ours is unidentifiable due to the rotation, location, and scale invariance of the factors in the likelihood.
To identify the location and scale, we place $\Norm(0,1)$ priors on most components of $\vb L$.
To identify the rotation, we place more informative priors on the loadings of certain candidates.
This was accomplished through somewhat of an interactive process, where a preliminary principal components decomposition of the precinct vote shares helped suggest the latent factors that might be found by the model.
We chose to make align the first dimension with the Sanders-Biden axis, and chose to make the second dimension roughly orthogonal along the Janey-Buttigieg axis.
This translated to a prior of $\Norm((-1, 0), (0.1^2, 0.25^2))$ for Sanders, $\Norm((1, 0), (1.0^2, 0.5^2))$ for Biden, and $\Norm((-0.25, -1), (0.5^2, 2^2))$ for Janey.
We additionally set the prior correlation between Sanders' and Biden's loadings to be $(-0.5, 0.8)$.

The estimated loading matrix $\vb L$ is visualized on the left of Figure \ref{fig:boston-factors}, and $\pref$ is visualized for Black and White voters on the right.

```{r boston-gen-pred, fig.width=6.5}
#| fig.cap: |
#|      Model predictions of general election vote shares and turnout, 
#|      compared to actual general election results.
#|      Red reference line indicates perfect agreement.
include_graphics("figures/boston_gen_pred.pdf")
```

Like all ecological inference models, this one makes several assumptions, verifiable and unverifiable.
We assume no spatial correlation in residuals, when some is almost certainly present.
We place distributional assumptions on how voter preferences by races vary across precincts (importantly, that these preferences are centered around a common location).
And we of course impose a latent two-dimensional factor structure, which must always be a major simplification of reality.

To test the suitability of the model for representing the outcomes of hypothetical future elections, we use the model fitted to the primary elections to predict the outcome of the mayoral general election in November 2021.
Michelle Wu and Annissa Essaibi-George advanced to the general from the preliminary election.
We fix the model's loading matrix $\vb L$ to the posterior mean of their estimated loadings.
We draw $s_{jk}$ from a $\Beta(20\bar s, 20(1-\bar s))$ distribution, where $\bar s$ is each candidate's share of the two-candidate vote from the preliminary election (59.7% Wu -- 40.3% Essaibi George).

The model's predictions (posterior medians) for the turnout and vote share in each precinct are shown in Figure \ref{fig:boston-gen-pred}.
Considering the differences between a primary and general election, and the additional campaign time elapsed between the elections, the predictions are remarkably accurate.
The predicted turnout has a Spearman correlation of 0.84 with the actual turnout, and the predicted and actual vote shares have a correlation 0.87.
The turnout and support levels are also in relatively close agreement.
