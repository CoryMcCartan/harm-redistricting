---
title: Individual and Differential Harm in Redistricting
authors:
  - name: Cory McCartan
    thanks: |
      To whom correspondence should be addressed. 
      The authors thank participants of the Harvard American Politics 
      Research Workshop and Imai Research Group  for helpful comments and discussion.
    department: Department of Statistics
    affiliation: Harvard University
    location: Cambridge, MA
    email: cmccartan@fas.harvard.edu
  - name: Christopher T. Kenny
    department: Department of Government
    affiliation: Harvard University
    location: Cambridge, MA
    email: christopherkenny@fas.harvard.edu
abstract: |
  We propose a unified framework for evaluating the impact of a districting plan on voters overall and in different groups. By aggregating the harm done to individual voters by their inability to elect a candiate of choice, and taking into account the space of counterfactual possibilities, we derive at a set of measures that flexibly adapts to local geographic constraints, different types of elections, and different groups of study.  The measures have connections to, and distinct advantages over, common redistricting metrics.  We provide recommendations for estimating these measures from historical election returns, and apply these methods to study partisan gerrymandering of New Jersey congressional districts and the racial impacts of district boundaries for primary elections for the Boston city council.
keywords:
  - representation
  - redistricting simulation
  - individual standing
bibliography: references.bib
biblio-style: apalike
output:
  rticles::arxiv_article:
    keep_tex: true
    includes:
      in_header: "header.tex"
    latex_engine: pdflatex
editor_options: 
  markdown: 
    wrap: sentence
---

```{r SETUP, include=FALSE}
library(knitr)
library(here)

opts_chunk$set(echo=FALSE, message=FALSE, warning=FALSE,
               fig.path=here("paper/figures/"), fig.align="center",
               fig.width=(8.5-2*1)/2, out.width="100%", fig.asp=0.8)
```

# Introduction

-   what makes a good redistricting plan?

-   on the partisan side, lots of attention on the fairness to parties

    -   partisan symmetry [@katz2020]

    -   seats-votes curve

-   on the racial side, ... ?
    (VRA focus? looking at race of candidates vs choice? what? I don't know)

-   courts, on the other hand, have focused on individual standing [@1964reynolds; @1962baker]

-   **we argue that individual standing/harm is an excellent lens to unify the study and measurement of redistricting plans**

-   core idea: counterfactuals + voter choice.
    Is a voter more likely to be represented by the candidate of their choice under a different redistricting plan?
    If so, they've been harmed.

    -   modern simulation methods allow us to produce realistic counterfactuals

    -   by analyzing how harms fall differentially along party, race, ideological, etc. lines, we can connect individual harm to more global measures based on parties, etc.

## Outline of the Paper

Section \ref{sec:motivation} motivates our framework for measuring harm and illustrates the key concepts in the context of partisan gerrymandering for three simple examples.
Section \ref{sec:indiv-harm} formalizes the intuition of Section \ref{sec:motivation} and defines a general measure of individual and differential harm.
Section \ref{sec:estimating} discusses estimating these measures from observed election results.
Section \ref{sec:connections} connects our proposed measures to existing symmetry and fairness measures.
Sections \ref{sec:nj} and \ref{sec:boston} apply the proposed measures to partisan gerrymandering of New Jersey congressional districts and racial impacts of district boundaries on Boston City Council primary elections.
Section \ref{sec:discussion} concludes.

# Motivation {#sec:motivation}

To illustrate the concepts and measures we introduce, we will make use of three examples, which are stylized representations of U.S. states: Mininois, Minissouri, and Minichusetts.
Mininois has one large Democratic city which can electorally dominate the rest of the state; Minissouri has two medium-sized cities which are not large enough to deliver a statewide Democratic majority; and Minichusetts has a uniform 3--2 Democratic split in every precinct.
Each example state has the same population and should be divided into 3 districts with population between 54 and 66.
Voters' preferences are assumed to be stable across elections, and turnout is 100%.
Schematics for these examples are shown in Figure \ref{fig:mini-schematic}(a)--(c).

```{r mini-schematic}
#| fig.cap: |
#|      Schematic maps of the three running examples, showing the partisan composition of each of the 36 precincts.
#|      The total voting population for each example is 180. 
#|      White lines delineate precincts.
include_graphics("figures/minis_schematic.pdf")
```

## Minichusetts: counterfactuals matter

Since every precinct in Minichusetts has a Democratic majority, it is impossible to draw a districting plan built from precincts that creates even a single Republican district.
This mirrors the situation in the actual state of Massachusetts, where a high level of partisan integration and a solid statewide Democratic majority leads to Republican inability to win any congressional seats under recent historical voting patterns [@duch:18].

This Democratic dominance poses a problem for existing measures of partisan gerrymandering.
One of the most common measures, the efficiency gap of @stephanopoulos2015, takes a value of $-0.311$ or $-0.317$ for Minichusetts, depending on the configuration of the districts.
This would make any Minichusetts districting plan an extreme Democratic gerrymander in comparison to the historical range of efficiency gaps observed in states nationwide.[^1]

[^1]: See, e.g., the historical distribution calculated by the Campaign Legal Center's PlanScore tool: [planscore.campaignlegal.org/metrics/efficiencygap/](https://planscore.campaignlegal.org/metrics/efficiencygap/).

But it is impossible to gerrymander if every manipulation of district boundaries produces no change in partisan outcomes.
What the efficiency gap and other gerrymandering measures lack is an awareness of the space of possible districting plans, plans that *counterfactually* might have been selected.
Once a set of districting rules has been agreed on (in Minichusetts, that districts must be contiguous and composed of whole precincts), what matters is not how a plan measures up to a fixed ideal, but how it performs in comparison to counterfactual plans.
There can be no gerrymander, and no harm to individual voters, if no improvement in partisan fairness is possible.

## Mininois: individual harm

To explore how to properly integrate counterfactual districting plans into the analysis of a potential gerrymander, we turn to the more interesting state of Mininois, where, in a familiar pattern of partisan sorting, Democrats are sorted asymmetrically into a single population-dominating city whereas Republicans dominate the less ideologically segregated rural regions [@chen:rodd:13; @enos:brown:21].

Consider the two plans in Figure \ref{fig:harm-mininois}(a)-(b).
A Democratic gerrymander (a) effectuates Democratic control by splitting its city into with the blades of a pinwheel, reaching out into the more Republican and less population-dense remainder of the state.
We see that the Democratic gerrymander would elect zero Republicans and three Democrats, whereas the proportional map (b) would elect two Democrats and one Republican.

```{r harm-mininois}
#| fig.cap: |
#|      Two potential districting plans for Mininois: a Democratic gerrymander (a) and a close-to-proportional plan (b).
#|      Panel (c) shows the total harm to voters in each precinct done by (a), using (b) as a counterfactual.
include_graphics("figures/harm_mininois.pdf")
```

Suppose now that plan (a) is enacted into law.
Who does this decision harm, if anyone?
We offer that a voter is harmed if they are not represented by their party of choice, but have a counterfactual where they would be represented by their party of choice.
Using plan (b) as a counterfactual, we can see that rural Republicans in the eastern half of Mininois are harmed by plan (a), since under plan (b) they would be represented by a Republican.
Republicans in the city and in the southwest are unharmed, as are all Democratic voters,, since they are represented by the same party under both plans.
Figure \ref{fig:harm-mininois}, Panel C illustrates this by plotting the number of voters harmed in each precinct.

Measuring the harm of the Democratic gerrymander required comparing it to a fair counterfactual plan.
The choice of counterfactual might seem hopelessly subjective.
We discuss in Section \ref{sec:estimating} principled ways to define counterfactuals, but for now we hope the value in measuring harm through counterfactuals is clear even if the operationalization is not.

## Minissouri: differential harm

We could quantify the harm a Democratic gerrymander imposed on voters in Mininois by comparing election outcomes to those under a counterfactual proportional plan.
But our results said nothing about the direction of the harm.
While it is apparent that the Democratic gerrymander indeed benefits Democrats, tallying up the total harm done to all voters is not enough to prove this.

However, we can partition voters into groups, and compare how the harm done by a plan falls across those groups.
If a plan disproportionately harms voters of one group, then we might conclude that that group was the target of a gerrymander.
Figure \ref{fig:diffharm-minissouri} illustrates this idea for two hypothetical gerrymanders ((a) and (c)) of Minissouri.
As in Mininois, we can tally the total number of voters harmed in each precinct ((d) and (f)) in comparison to a proportional counterfactual plan (b).
As might be intuitively expected, total harm to voters is concentrated in areas whose party representation flips from the gerrymander to the counterfactual plan.

```{r diffharm-minissouri}
#| fig.cap: |
#|      Three potential districting plans for Minissouris: a Democratic gerrymander (a), 
#|      a close-to-proportional plan (b), and a Republican gerrymander (c).
#|      Panels (d) and (f) show the total harm to voters in each precinct done 
#|      by their corresponding gerrymander, using (b) as a counterfactual.
#|      Panel (e) summarizes this harm by party and across precincts, showing 
#|      the average harm done to voters of each party by each gerrymander.
include_graphics("figures/diffharm_minissouri.pdf")
```

Panel (e) then splits the voters by party, and computes, for each party, the share of its voters which harmed.
The Democratic gerrymander (a) harms Republicans at a much higher rate than Democrats, and the opposite can be said of the Republican gerrymander (c).
We call the gap between these two rates the *differential harm,* and propose it as a general way to account for the impact of a districting plan on particular groups.

The differential harm of the Democratic gerrymander of Minissouri is $-0.415$, and the differential harm of the Republican gerrymander is $0.450$, where positive values indicate Republican bias.
In other words, under the Democratic gerrymander, the average Republican voter in Mininois is 41.5% more likely to be represented by a Democrat than an average Democrat is to be represented by a Republican, compared to the proportional plan in Figure \ref{fig:diffharm-minissouri}(b).

# Individual Representational Harm {#sec:indiv-harm}

This section will formalize and generalize the concepts in Section \ref{sec:motivation}, beginning with some notation.
Let $\Voters$ be the set of individuals, or voters, in the region and time period under consideration, who vote to select a candidate to represent each of a set of legislative districts, indexed by $\Distrs$.

Voters vote in elections, each of which produces a specific outcome $v$ from the set $\Elecs$ of all possible election outcomes.
In an election, voters either vote for a candidate running in their district, or abstain from voting.
We write $v(i)$ to mean the candidate that individual $i$ votes for in election $v$.

Every voter resides in some legislative district; this assignment is referred to as a *districting plan* and is represented here by a function $q(i)$ indicating the district that individual $i$ lives in.
The set of all possible districting plans is $\Plans$.

For an election $v$, we can tally the votes for each candidate; the candidate with the most votes wins.
We denote the winner in district $d$ of districting plan $q$ as $\win_d(v,q)$.

This notation obscures the complex relationships and feedback effects between individuals, elections, and districting plans.
For example, different districting plans may lead to different candidates running, depending on district partisanship and incumbent residency.
The assumptions we make on these relationships will be made more explicit in Section \ref{sec:estimating}, where we discuss how to estimate our measures in practice.

## Harm

The key intuition from Section \ref{sec:motivation} was that to be harmed by a decision a voter must have a better outcome in the counterfactual world where another decision was made.
To operationalize this, we need to introduce a counterfactual districting plan $\tilde q$.
Then we may define the *harm* to an individual $i$ in election $v$ held under districting plan $q$ as $$
h_i(v,q,\tilde q) = \ind\{v(i) \neq \win_{q(i)}(v, q)\}
        \ind\{v(i) = \win_{\tilde q(i)}(v, \tilde q)\},
$$that is, a voter is harmed only if they are not represented by the candidate of their choice and they would have been represented by their chosen candidate under the counterfactual plan.

This definition of harm is limited in two key regards.
First, it considers only individuals who vote; if a person abstains from voting then their calculated harm is zero.
A natural extension of this definition would be to separate an individual's candidate preference from their vote choice; the latter would be used in calculating election winners, but the former could provide a more broadly-based harm measure.
Naturally, this approach requires auxiliary data to implement (such as a large-scale survey), since candidate preferences for nonvoters cannot be inferred from election returns.

A second limitation is that $h_i(v,q,\tilde q)$ ignores any preferences a voter may have between candidates he or she did not vote for.
For example, a voter may consider candidates A and B nearly exchangeable, but may strongly dislike candidate C.
If the voter ultimately voted for candidate A, this harm measure makes no distinction between candidate B or candidate C winning the voter's district.
This reflects the simplistic nature of the cost function that is implicit in the harm measure.
The problem could be remedied by replacing the indicator functions with other cost functions that consider ordinal preferences.
Ballot-level ranked-choice vote data, or candidate ideology scores, could be used to estimate such a cost function.
Here, to avoid making further assumptions, we limit ourselves to the indicator-based cost function.
Since many American elections are between just two candidates, this limitation should not prove too restrictive.
Section \ref{sec:boston} further discusses the implications of this particular specification in the context of primary elections.

## Multiple Elections or Districting Plans

As defined above, $h_i(v,q,\tilde q)$ is defined for a single election and single counterfactual districting plan $\tilde q$, but in general we will be interested in outcomes over multiple elections, and possibly a much larger set of counterfactual plans.
Ideally we would like to be able to average individual harm over a set of future elections (under the same districting plan), or over a set of hypothetical districting plans, or even over a set of individuals with some shared characteristic.

To allow for this, we replace the fixed election and counterfactual districting plans with random variables $V\in\Elecs$ and $\tilde Q\in\Plans$.
The randomness here is primarily a conceptual device to simplify the notation, but one can also think of it as reflecting uncertainty or variation in voter preferences, the political environment, candidate quality, campaign events, and other factors.
The randomness in districting plans specifically may be conceptualized as the constraints and preferences of the plan-drawing process (i.e., plans which better respect the preferences are given a higher probability).
As we will discuss in Section \ref{sec:estimating}, generally we will assume that $V$ and $\tilde Q$ are mutually independent, though this is not required for our theoretical analysis.
Finally, we will also replace $i$ with an individual $I$ taken uniformly at random from $\Voters$, with $I\indep V,\tilde Q$.

Then we may define the harm for a (randomly selected) individual under plan $q$ as $H(q) \dfeq h_I(V, q, \tilde Q)$.
Thus, for example, the harm for a single individual $i$ becomes $H(q)\mid I=i$; and the electorate's average harm in election $v$ becomes$$
\E[H(q)\mid V=v] = \Pr[v(I)\neq\win_{q(I)}(v, q)
    \text{ and }v(I)=\win_{\tilde Q(I)}(v, \tilde Q)],
$$that is, the probability that a randomly selected voter in this election is misrepresented under the adopted plan but would not have been under a randomly selected counterfactual.

## Differential Harm and Fairness {#subsec:diff-harm}

Single-member districts are often motivated by the value in representation to specific communities with shared interests; indeed, preserving "communities of interest" is one of the most common statutory and constitutional requirements imposed by states on the plan-drawing process [@ncslcriteria].
It is therefore natural to consider not just the average harm to voters done by a plan, but also how this harm is distributed across certain groups of voters, defined by race, party, or other attributes of interest.

To that end, let $\Groups=\{G_1,G_2,\dots\}$ be a set of mutually exclusive groups of voters, so that for each voter $i$, we have $i\in G_k$ for some group $G_k$.
In general we will not require the group identities to be fixed with respect to elections.[^2]
This is because some group identities, like partisan preference, may themselves change election-to-election.

[^2]: Formally, we have random indicator variables $\ind\{i\in G_k\}$ for all $i$ and $k$, subject to the constraint that $\sum_k \ind\{i\in G_k\}=1$ for all $i$.
    These indicator variables may be correlated with $V$ and/or $\tilde Q$, in general.

Once we have defined a set of groups, we say that a plan $q$ is *fair* in comparison to a counterfactual $\tilde Q$ if $\E[H(q)\mid I\in G_k]$ is constant across groups $G_k\in\Groups$.

Fairness is a strict condition; any real-life plan will never be exactly fair.
To quantify deviations from fairness, we introduce the concept of *differential harm*, defined as $$
  \Delta_{G_k-G_l}H(q) \dfeq \E[H(q)\mid I\in G_k] - \E[H(q)\mid I\in G_l],
$$ for two groups $G_k$ and $G_l$.
So $\Delta_{G_k-G_l}H(q)$ will be positive if voters in group $G_k$ are harmed at a higher rate than voters in group $G_l$, indicating that plan $q$ favors $G_l$ over $G_k$.
Using our definition of fairness, $\Delta_{G_k-G_l}H(q)=0$ for all $G_k,G_l\in\Groups$ if and only if $q$ is fair.

It is this measure of differential harm that we propose as a unified framework for evaluating a districting plan across a variety of dimensions.
It is derived from an individual-level measure of representation and it accounts for the space of counterfactual possibilities.
Importantly, it separates *vote choice* from *group membership*, allowing one to discuss how partisan election outcomes under a specific districting plan create harm for specific groups or their interactions, simply by conditioning $H(q)$ on a set of individuals.

Estimating these quantities from available data is another matter, of course, and requires additional assumptions, as we describe next.

# Estimating the Harm Measures {#sec:estimating}

The measures $H(q)$ and $\Delta H(q)$ defined above require specification of a probability distribution on elections and districting plans.
Depending on one's viewpoint, this is either a theoretical fiction which must be specified by a model, or an actual data-generating process we must aim to estimate.
Either way, past election data and an enacted districting plan alone are not enough to calculate these measures.

While not strictly necessary, modeling of $V$ and $\tilde Q$ independently will simplify the situation considerably.
Practically, this translates to the assumption that individual voters would make the same candidate choice no matter the districting plan.
To the extent that voters reward or punish an incumbent party for the districting plan they adopt, or that an adopted districting plan affects which candidates run in a district, this assumption is violated.
But as our suggested model for election outcomes $V$ will be quite coarse, not accounting for candidate factors or policy preferences, the marginal effect of this independence assumptions on our conclusions will be minimal.

## Modeling Districting Plans

It is difficult to construct a tractable probability distribution for districting plans, since the space of plans is discrete and lacks a natural metric structure.
Thankfully, in recent years a number of algorithms have been developed which sample districting plans from specific distributions [@fifield2020mcmc; @deford2019; @carter2019; @mccartan2020].
These distributions can generally be characterized as maximum-entropy distributions on the space of all valid districting plans, in combination with several moment constraints.

For example, the algorithms of @carter2019 and @mccartan2020 sample from the maximum-entropy distribution of districting plans which are geographically contiguous, have district populations within a deviation from equality, and which have a certain average compactness value (according to a particular graph-theoretic compactness measure).
These maximum-entropy distributions put as few conditions as possible on the districting sampling process, as long as a set of constraints imposed by the researcher are met.
If these constraints are precisely those which are required by law or traditional redistricting criteria, then samples from this distribution provide a natural set of counterfactual districting plans, uninfluenced by superfluous partisan considerations, to use in estimating $H(q)$ and $\Delta H(q)$.
In practice, the translation from tradition and law into mathematical formulations of constraints is not always clear or even well-defined; there is certainly an element of subjectivity in sampling a set of redistricting plans.
Nonetheless, sampling methods are widely used in practice.

## Modeling Election Outcomes

Election results present a different set of modeling challenges, given the large number of factors that influence the outcome, and the general unpredictability of future events.
As far as estimating measures like $H(q)$ and $\Delta H(q)$, we would ideally use a relatively simple model that captures the primary drivers of election outcomes.
In the interest of fairness, the model should not make any biasing assumptions about the future (e.g., that demographic shifts will favor one party, or that past trends in election returns will continue in the same direction).

We limit our discussion here to the case of estimating harm and differential partisan harm in a two-party setting.
Estimating differential racial harm in the two-party setting can be done by first generatinc ecological inferences or survey estimates of party preference by race, and then applying methods analogous to those outlined here.
Multiparty or primary elections pose additional modeling challenges.
In Section \ref{sec:boston} we consider a spatial-racial model for primary elections with multiple candidates, to illustrate the application of our framework to these more complicated cases.

Motivated primarily by computational convenience, we use a *proportionate uniform shift* model, which focuses on swings in the national political environment as the main determinant of election outcomes.
Each election outcome over the period of interest (generally ten years or less) is modeled as a random deviation from a baseline outcome, and these deviations are assumed to consist of a constant fraction of voters of one party in each precinct switching to the other.
The baseline itself can be established by averaging the results of all available statewide elections over the past decade or other suitable period.
The proportionate uniform shift model is nearly identical to the uniform partisan swing model of @butler1951swing for most precincts and districts, but is more computationally convenient and avoids issues of vote shares exceeding 100% or falling below 0%.
Despite their simplicity, uniform-swing--type models are highly accurate for out-of-sample prediction [@katz2020], and are intuitive and easy to implement.
More details about our proportionate uniform shift model may be found in Appendix \ref{app:formulas}.

More complicated election outcome models are certainly possible and straightforward to use with the measures proposed here.
For example, one could model district deviations as a systematic national shift plus a local idiosyncratic effect, as is done in the Stochastic Uniform Partisan Swing model of @gelman1994unified.
For ease and efficiency of computation, we stick to the simple proportionate uniform shift model here.

## Calculating Harm and Differential Harm

With a model for election outcomes and districting plans in hand, calculation of $H(q)$ and $\Delta H(q)$ is straightforward.
For each sample $\tilde q$ of a counterfactual districting plan, we use the election model to come up with a probability that voters in each precinct are represented by the candidate of their choice under $\tilde q$ but not under $q$.
When the groups used in $\Delta H(q)$ vary within precincts, we must repeat these computations for each group.
Then by summing across precincts and/or groups and dividing by the appropriate totals, we arrive at values for $H(q)$ and $\Delta H(q)$.
Appendix \ref{app:formulas} contains more details, including the specific formulas used to compute $H(q)$ and $\Delta H(q)$ for two-party elections from a set of past election returns and a sample of districting plans from a redistricting sampling algorithm.

# Connections to Existing Partisan and Racial Gerrymandering Metrics {#sec:connections}

The canonical framework for considering partisan fairness is partisan symmetry [@king1987democratic]. Partisan symmetry implies that the seats, $s$ won by a party with voteshare $v$ would be satisfied if $s(v) = 1 - s(1 - v)$. Often, the partisan symmetry framework has been applied via partisan bias, which measures the seat deviation from symmetry [@tufte1973pb; @katz2020]. Partisan bias, denoted by $\beta(s)$ is the number of seats that would need to be reallocated to reach proportionality for a given statewide vote share $s$ (usually $\half$). To compute partisan bias, researchers have largely relied on assumptions about how the voteshares would swing to reach the alternative voteshares.

More recently, particularly in the years since @2004vieth, researchers have developed a veritable zoo of measures to identify partisan gerrymanders. 
The most prominent of these new measures have attempted to offer alternative measures for partisan symmetry.
The *mean-median* difference looks to relationship between the voteshare of the median seat in a delegation and the mean voteshare of the delegation to make claims about how a map is skewed [@mcdonald2015unfair].
The *declination* describes the relative rate at which districts become less competitive for each party [@warrington18].
Perhaps the new measure which has reached the most acclaim is the *efficiency gap* [@stephanopoulos2015]. Referred to by Chief Justice Roberts as "sociological gobbledygook" in Gill v. Whitford, the efficiency gap looks to measure the votes wasted by the parties and compare the net wasted votes. Notably, while the efficiency gap was intended to measure partisan symmetry, it does not do so [@katz2020].
All of these measures may be estimated using district vote shares alone, and as we discuss next, are to varying degrees related to our proposed measures.

[3] It's just different, but we also think it's better
Partisan symmetry offers a coherent and theoretically grounded quantity of interest.
Yet, as a collective, the approaches towards partisan symmetry suffer from a common issue: the lack of a counterfactual. 

[4] specific issues with the key approaches and how we improve that.

[5] bring the mini-examples full circle with a little table of the scores and the harms?


## The Efficiency Gap

The efficiency gap ($EG$) interrogates how a party's votes are wasted under a districting plan.
By subtracting the wasted votes for Democrats from those for Republicans, and normalizing by the total votes cast, it offers a signed measure that is simple to interpret: $EG=0.05$, for example, indicates that 5% more Democratic votes are wasted than Republican ones.
The general recommendation is that an efficiency gap larger than two Congressional seats (i.e., 2 divided by the number of districts), or 0.08 for state legislative plans, indicates a partisan gerrymander.

A number of scholars have criticized the efficiency gap for (1) penalizing proportionality, (2) rewarding 3-to-1 districts and switching sign for more lopsided districts, and (3) being discrete and therefore sensitive to small changes in district vote shares [@bernstein2017egap; @tamcho2017egap; @deford2020symmetry].
These concerns to not apply to our proposed measures.

First, $U^{(G)}, U^{(L)}, H$, and $\Delta H(q)$ are all averaged over possible election outcomes, and so do not suffer from discreteness.
And as discussed above, $U^{(G)}$ and $U^{(L)}$ both reward proportionality.
Of course, proportionality is not always possible, given a state's political geography.
The harm measures $H$ and $\Delta H(q)$ both reflect this by comparing to a set of counterfactual districting plans.
This addresses one inherent shortcoming of the efficiency gap, illustrated best by the state of Massachusetts.
According to the efficiency gap, Massachusetts' congressional districting plan is a Democratic gerrymander ($EG=-0.14$).
But it is impossible to draw a single Republican congressional district in the state.
Consequently $H$ and $\Delta H(q)$ are everywhere 0.

Finally, the fact that the efficiency gap is minimized for districts with 75%--25% vote shares is a direct consequence of comparing the raw number of wasted votes, rather than the share within each party.
In contrast, $\Delta H(q)$ is calculated by comparing harm averaged first within each party, avoiding this deficiency.

As we will see in the application below, often there is substantial correlation between the efficiency gap and $\Delta H(q)$.
Yet in more unusual or tricky cases, the efficiency gap may point to a partisan gerrymander while $\Delta H(q)$ indicates a fair outcome or an unfair advantage for the opposite party.

## Partisan Bias

Partisan bias is probably the most widely-used measure of partisan symmetry.
The bias, denoted by $\beta(s)$ is the number of seats that would need to be reallocated to reach proportionality for a given statewide vote share $s$ (usually $\half$).
Like our proposed measures, this quantity is defined independent of electoral data and can be estimated using a uniform swing model.
Each value of $s$ yields information about a different point on the seats-votes curve.

In competitive states, where the baseline election has a statewide vote share near 50%, $\beta(\half)$ is highly correlated with $\E[\seats(\dem, V, Q)\mid Q=q]$ and thus $\Delta H(q)$ as well.
But in more lopsided states, $\beta(\half)$ can give unintuitive results, which, if not interpreted carefully, can lead practitioners to make incorrect conclusions about the presence and direction of a partisan gerrymander.

Fundamentally, however, $\beta(s)$ measures partisan symmetry, and not partisan harm or utility.
It should not be surprising, then, that it can and does "disagree" about the partisan effects of a particular plan.
These "disagreements" are really just differences in the target quantity of interest.

```{=html}
<!--
1.  Integrating yields a related measure of @nagle2015measures, which has also been criticized by @deford2020symmetry.
2.  Focuses on only one part of S-V curve, which may not be relevant

Notably, as the quantity of interest is not partisan symmetry, our measures do not require the existence of a seats-votes curve. This is consequential for the study of congressional redistricting. As a seats-votes curve is defined for a legislature, rather than a delegation, to understand the impact of single state's congressional map, you would be forced to consider how every other state drew their maps [@katz:king:rose:21a]. Thus, if this taken as the definition of a seats-votes curve, then measures of partisan symmetry lack diagnostic power to identify gerrymanders for the delegations that academics, legal scholars, and the general public are often focused on. The individualized focus of our measures are, however, portable to congressional, state legislative, or any other form of districting and elections.
-->
```
## Mean-Median Difference

The mean-median difference straightforwardly measures the difference between the mean and median district vote shares.
In practice, the mean-median differences is moderately correlated with other partisan redistricting measures.
However, considerations of the mean and median district are only related to individuals insofar as they describe the general propensity to be harmed or benefited by a particular map.
As [@katz2020] discuss, the mean-median difference can be interpreted as an estimator of *votes-denominated bias*, another value derived from the seats-votes curve.

## Simulation Methods

Despite being derived from individual harm, differential partisan harm is in fact closely related to the overall number of seats won by each party, as Proposition \ref{prop:fairness} describes below.
Yet unlike a simple measure of seats, differential harm is shifted to an interpretable scale, where a value of zero corresponds to fairness.
In other words, differential harm provides a connection between fairness and seats, establishing a normative guide to overall election outcomes.
This connection further supports the use of total seats won by each party as a summary statistic in partisan redistricting simulation methods, as advocated by @deford2020symmetry.

```{=tex}
\begin{proprep} \label{prop:fairness}
Suppose $\Groups=\{\dem,\rep\}$. If turnout is equal across districts, then for a specific districting plan $q\in\Plans$,
\begin{align*}
    \Delta_{\rep-\dem} H(q) = \E[\seats(\dem, V, \tilde Q)] - \E[\seats(\dem, V, q)].
\end{align*}
\textbf{CM note: define $\seats$ or replace with sum.}
\end{proprep}
\begin{proof}
\end{proof}
```
# Application to Partisan Gerrymandering in New Jersey {#sec:nj}

To illustrate the connections in the preceding section and to demonstrate the value of the proposed measures in a real-world setting, we provide a brief analysis of congressional districting in the state of New Jersey.
As discussed above, many gerrymandering measures function well in highly competitive states, but may produce more counterintuitive results in other states.
New Jersey, with an average Democratic two-party vote share of 56.6% across our two baseline elections (2016 presidential and 2018 senatorial), will demonstrate that this is not a problem unique to lopsided states.
Additionally, New Jersey has 12 congressional districts, which is enough to produce some variability in seats outcomes across counterfactual plans, but not so many as to render trivial the challenges of discreteness.

```{r nj-maps, fig.width=6.5, fig.height=3}
#| fig.cap: |
#|      Baseline vote patterns, two hypothetical gerrymanders, and one randomly sampled plan.
#|      Census-designated places are shaded in gray and county lines in white.
include_graphics("figures/nj_maps.pdf")
```

Figure \ref{fig:nj-maps} shows the baseline Democratic vote share by precinct, along with two hypothetical gerrymanders of the state, which were generated using the short-burst optimization approach of @cannon2020.
The Democratic gerrymander has 11 Democratic seats and 1 Republican seat at baseline, while the Republican gerrymander has 6 Democratic and 6 Republican seats.

We sample 10,000 districting plans across four independent runs of the SMC algorithm of @mccartan2020, setting constraints to favor compact plans with district boundaries that tend to follow county lines.
One such plan is shown in Figure \ref{fig:nj-maps}(d).
For each of these sampled plans and the two gerrymanders, we calculate the average harm and differential partisan harm versus the simulated baseline,[^3] as well as the expected number of Democratic seats, the efficiency gap, partisan bias, the mean-median score, and partisan declination.
[^4] The distribution of these measures, along with their pairwise relationships, are shown in Figure \ref{fig:nj-pairs}.

[^3]: As in section \ref{sec:connections}, this is $\Delta_{\dem-\rep}H(q)$, so that positive values correspond to a plan that favors Republicans.


```{r nj-pairs, fig.width=7, fig.height=7}
#| fig.cap: |
#|      Scatterplots for all pairs of measures.
#|      The Democratic and Republican gerrymanders are shown with the blue and red lines and crosses.
#|      The dashed line indicates a value of zero.
#|      Below the diagonal, numbers indicate the absolute value of the correlation between variables.
include_graphics("figures/nj_pairs.pdf")
```

Differential partisan harm identifies each gerrymander as such, with a large negative value for the Democratic gerrymander and a large positive value for the Republican gerrymander.
These values are relatively directly interpretable; for example, the differential harm score of $-0.221$ means that an average Democratic voter is 22.1% less likely to be misrepresented than their average Republican counterpartisan.
The efficiency gap and declination measures also correctly identify the gerrymanders, though they are much more discrete, and declination gives a much larger score in absolute value to the Democratic plan than to the Republican.
In contrast, the partisan bias and mean-median measures incorrectly classify the Republican gerrymander as a fair plan and a Democratic-leaning outlier.
These measures are weakly correlated with the expected number of Democratic seats, and show substantial variation even for fixed values of total seats won at baseline.

Considering the distribution of these statistics across the distribution of sampled plans doesn't help much, either.
The expected number of Democratic seats naturally identifies the gerrymanders (two-sided $p=0.0002$) and the direction of bias, and as expected from Proposition \ref{prop:fairness} this measure is highly correlated with differential partisan harm.
The gerrymanders are also an outlier under the efficiency gap and declination measures also (both $p=0.0002$).
While the gerrymanders are both an outlier for the mean-median score, only the Democratic plan is an outlier according to the partisan bias measure ($p=0.0022$, versus $p=0.099$ for the Republican plan).

There is also disagreement between the measures about the natural bias of districting plans in New Jersey: the median sampled plan has a partisan bias of $0.047$, indicating a natural Republican bias, but the median mean-median score is just $0.0069$, and the median differential partisan harm is $-0.13$, indicating a natural Democratic bias.
Which is correct?
Democrats win 8.47 seats on average across the simulations, which is more than the 6.79 seats that would be expected under a completely proportional outcome.

Both gerrymanders excessively harm the average voter, with the Democratic plan doing so at a moderately higher rate ($p=0.0002$ for the Democratic plan, $p=0.0004$ for the Republican plan).
Notably, the plans which minimize total harm are also those which have near-zero differential partisan harm.
Thus, at least in New Jersey, overall harm reduction is consistent with a fair map on a partisan basis.
Minimizing bias with other measures, however, could lead one astray: plans which score an efficiency gap of zero can have a large average harm, which may not be distributed fairly between parties.
Plans with zero partisan bias or mean-median score actually have higher-than-average harm and tend to differentially harm Republicans.

# Application to Primary Elections in Boston {#sec:boston}

The proposed harm measures are particularly easy to calculate and interpret in a partisan context, since the preferences of each kind of partisan are directly observable as partisan vote shares.
However, the same framework can be fruitfully applied to more complex settings, providing insights that go beyond those available through traditional methods.

```{r boston-map, fig.width=6.75, fig.height=3.375}
#| fig.cap: |
#|      Racial composition of the city of Boston (left), and 2010 city coucil districts (right).
#|      Neighborhood boundaries are overlaid in black on the left map and in white on the right map.
include_graphics("figures/boston_map.pdf")
```

The city of Boston is governed by a mayor and a nonpartisan 13-member city council.
Nine of the councillors are elected from contiguous city council districts, and the remaining four councillors are elected at-large, with all councillors serving two-year terms.
Council district boundaries are redrawn every ten years following the decennial census, and must be equipopulous, be compact, and preserve neighborhood and community boundaries.[^5]
This section will study the extent to which the mixed at-large and district council system harms voters in comparison to a fully district-based system (as was the case before 1909 and from 1924-1951), either overall or differentially by racial group.
Figure \ref{fig:boston-map} shows the racial composition of the city as well as the boundaries of the 2010 city council districts and the city's official neighborhoods.

[^5]: City of Boston charter.
    Available at <https://www.boston.gov/sites/default/files/embed/b/boston-city-charter-2007.pdf>.

## Approach

To apply our proposed framework to study the council system and and its district boundaries, we need to be able to predict individual voting preferences under counterfactual districting plans and systems.
This is more difficult than in our study of New Jersey, for two reasons.
First, the city council is officially nonpartisan and city politics are dominated by the Democratic Party, so voting preferences are more complex than a simple partisan preference.
To estimate election outcomes, we will need some way of mapping observed support for particular candidates in one election onto counterfactual support for a hypothetical candidate in another election.
Second, we aim to examine the racial impact of the district system, and thus need to estimate these voting preferences by race.
Even if we could, for instance, divide candidates into a more "liberal" and a more "conservative" group, the vote counts for each group by precinct will not alone tell us how different racial groups voted.

```{r boston-factors, fig.cap="", fig.width=7, fig.height=3.5}
#| fig.cap: |
#|      Candidate factor loadings, with approximate 80% credible intervals shown as ellipses (left), 
#|      and geographic variation in factor values by race (right). 
#|      Neighborhood boundaries overlaid in black.
#|      Factor values in the Black second-dimension map are truncated so that variation in the other maps is visible.
include_graphics("figures/boston_factors.pdf")
```

To solve both of these problems, we develop a *latent factor ecological inference model*, which simultaneously estimates (a) turnout by precinct and race, (b) candidate positions in a latent two-dimensional political space,[^6] and (c) voter preferences in this space by precinct and race, using precinct-level demographic data and vote totals from the March 2020 presidential primary and September 2021 mayoral preliminary elections.
Figure \ref{fig:boston-factors} shows the key outputs from this model, and Appendix \ref{app:lfei} explains the model in detail and contains additional diagnostic plots.

[^6]: Exploratory analyses found that three latent dimensions did not provide a substantially better fit to the data.

Like all ecological inference models, ours rests on several unverifiable assumptions.
The latent factor component imposes additional assumptions about the structure of voting in Boston elections.
As Appendix \ref{app:lfei} discusses, these assumptions are almost certainly not strictly met.
Yet we believe that the model is a useful simplification of reality that captures the major electoral dynamics that are relevant to our question of interest.
For example, using the estimated latent positions and support levels for Michelle Wu and Annissa Essaibi-George, the two mayoral candidates that advanced to the general election, we were able to predict the precinct-level general election turnout and vote shares with considerable accuracy (see Figure \ref{fig:boston-gen-pred} in Appendix \ref{app:lfei}).
We stress that the latent factor ecological inference model is not necessary for this kind of analysis; local survey data that collected ideological preferences and racial information would also suffice.

## Results

# Discussion {#sec:discussion}

This paper is an attempt to bridge the quantitative gap between votes and representation.
We break from existing redistricting literature and focus on the relationship between votes and representation by copartisans, rather than the relationship between votes and seats.
This focus naturally leads to a new normative standard of partisan fairness, which is achieved when the necessary harms of a districting plan are distributed evenly across voters of each party.
This may occur regardless of whether the districting plan achieves partisan symmetry.

This approach offers new purchase into the foundational questions of how to quantify the harms and benefits that accrue to voters in district-based democracies, where the rules of defining districts are fixed, but the choice of how to how to draw the districts remains a policy question.
While the overall framework is flexible, we offer a selection of simple yet interesting measures for improving the individual partisan implications of a districting plan.
Further work is needed to characterize how existing redistricting requirements and practices, such as the number or size of districts, or encouragement of competitive districts, interact with these measures.

# References {.unnumbered}

::: {#refs}
:::

```{=tex}
\vspace{1in}
\appendix
\renewcommand\thefigure{\thesection.\arabic{figure}}
\setcounter{figure}{0}
```
# Computing Harm Measures from Precinct-level Election Data {#app:formulas}

In practice, districting plans are built from discrete geographic units (often precincts), and election returns are reported at this level as well.[^7]
Throughout this appendix, let $j$ index the set of electoral precincts or other units.
For concreteness here and without loss of generality we will use the Democratic party as the reference party, letting $s_{jv}$ denote the Democratic two-party vote share in precinct $j$ in election $v$.
Write-in or minor third-party candidates can be safely ignored, since the overall winner will be precisely the two-party vote winner.

[^7]: When district boundaries split precincts, practitioners generally impute the returns in each component of the split precinct by population-weighted interpolation.
    Population information comes from Census blocks, which are practically never split.

## Proportionate Uniform Shift Details

The proportionate uniform shift model assumes that from one election to another, a constant fraction of *voters of one party* in each precinct switch to the other party, and that per-precinct turnout is constant across elections.[^8]
This has several advantages over the uniform swing model, where a constant fraction of *all voters* shifts parties.
First, the proportionate shift prevents hypothetical party vote shares from exceeding 1 or falling below 0 in any precinct.
Second, as it has the effect of scaling vote shares across precincts by a constant multiple, it preserves the relative balance of a party's voters across precincts.
For $\Delta_{\dem-\rep}H(q)$, which considers voters in each party separately, this helpfully simplifies computations.

[^8]: Everything carries through if one allows for shifts in the overall turnout level across elections, as long as (a) the relative turnout across precincts is fixed, and (b) turnout shifts are independent of shifts in party preferences.

The proportionate shift may be mathematically expressed as linear shift on a transformed scale, not unlike a generalized linear model.
Specifically, we define $\gamma:[0,1]\to\R$, $$
\gamma(x) = -\thalf\sgn(x-\thalf)\log(1-2\qty|x-\thalf|),
$$ which is the inverse CDF of a Laplace distribution with rate 2.[^9]
Then the Democratic vote share in precinct $P_j$ and election $v$, notated here as $s_{jv}$, is modeled as $$
\gamma(s_{jv}) = \gamma(\overline s_j) + \eps_v, \qquad \eps_v \iid \Norm(0, \sigma^2_{\mathrm{hist}}),
$$ where $\overline{s}_j$ is the party baseline in the precinct, and $\sigma^2_\mathrm{hist}$ is estimated from the historical variability in nationwide popular vote shares.
For congressional elections in the United States from 1974--2018, we have $\widehat\sigma^2_\mathrm{hist}=0.03723$, and so draw predictive deviations from $\mathrm{t}_{22}(0, \widehat\sigma^2_\mathrm{hist})$.

[^9]: A rate of 2 is chosen so that the slope of the link function at $\half$ is exactly 1, meaning that transformed vote shares will be on approximately the same scale as the original shares.

It will simplify matters following to have notation for the overall Democratic vote share in a district.
For a precinct $j$, let $q^{-1}(j)$ denote the district it belongs to.
Then let $$
    S_{q^{-1}(j), v}=\frac{\sum_{l\in q^{-1}(j)} s_{lv}\avgvote_l}{\sum_{l\in q^{-1}(j)} \avgvote_l}
$$ denote the vote share in the district, where $\avgvote_l$ counts the total number of votes in precinct $l$ at baseline.
The baseline vote share in the district is then $\bar S_{q^{-1}(j)}$.

## Estimating $H(q)$ and $\Delta H_{\dem-\rep}(q)$

We will build up estimates of the overall $H(q)$ and $\Delta H_{\dem-\rep}(q)$ from precinct-by-group harm estimates.
Since we assumed that elections are independent of districting plans, we can first average across elections and then across counterfactual plans.
For a random voter $I$ in precinct $j$, we have for every plan $q$ that the probability of a Democrat winning their district is $$
\Pr(\win_{q(I)}(V, q)=\dem\mid I\in j) 
= \Pr(S_{q^{-1}(j),V} > \half)
= \Phi\qty(\frac{\gamma(\bar S_{q^{-1}(j)})}{\sigma^2_\mathrm{hist}}),
$$ where $\Phi$ is the standard Normal CDF. To estimate this probability, we simply replace $\Phi$ with the CDF of the $t_{22}$ distribution ($F_{t_22}$), and $\sigma^2_\mathrm{hist}$ with $\hat\sigma^2_\mathrm{hist}$.
Extending one step further, for two plans $q$ and $\tilde q$, we have

```{=tex}
\begin{equation}\label{eq:appharm1}
\Pr(\win_{q(I)}(V, q)=\rep\text{ and }\win_{\tilde q(I)}(V, \tilde q)=\dem\mid I\in j) 
= \Pr\qty(S_{q^{-1}(j),V} < \half, S_{\tilde q^{-1}(j),V} > \half).
\end{equation}
```
Because of the uniform shift, for any election $v$, $S_{q^{-1}(j),v} - S_{\tilde q^{-1}(j),v}$ is constant.
Therefore if $S_{q^{-1}(j),v}>S_{\tilde q^{-1}(j),v}$, this probability is zero (if a Democrat wins under $\tilde q$ they will definitely win under $q$, which has a higher Democratic vote share).
But if $S_{q^{-1}(j),v}<S_{\tilde q^{-1}(j),v}$, we can rewrite \eqref{eq:appharm1} as the probability that $\eps_{V}$ falls in a particular range.
Specifically, we have in general that

```{=tex}
\begin{equation}\label{eq:appharm2}
\Pr(\win_{q(I)}(V, q)=\rep\text{ and }\win_{\tilde q(I)}(V, \tilde q)=\dem\mid I\in j) 
= \qty(\Phi\qty(\frac{\gamma(\bar S_{\tilde q^{-1}(j)})}{\sigma^2_\mathrm{hist}})
- \Phi\qty(\frac{\gamma(\bar S_{q^{-1}(j)})}{\sigma^2_\mathrm{hist}}))_+,
\end{equation}
```
where $(\cdot)_+\dfeq \max\{0, \cdot\}$.
If we condition on $V(I)=\dem$, then \eqref{eq:appharm2} is exactly the expected harm to voter $I$ under plans $q$ and $\tilde q$.
The calculation is analogous, up to sign changes, for the expected harm conditioning on $V(I)=\rep$.
This completes the first step: averaging harm within precinct and groups and across elections.

We can then estimate the average across counterfactual plans $\tilde Q$ with the usual Monte Carlo estimator: $$
    \hat h_{j,\dem}(q) 
    \dfeq \frac{1}{N_\text{sim}} \sum_{k=1}^{N_\text{sim}} 
    \qty(\Phi\qty(\frac{\gamma(\bar S_{\tilde q_k^{-1}(j)})}{\sigma^2_\mathrm{hist}})
        - \Phi\qty(\frac{\gamma(\bar S_{q^{-1}(j)})}{\sigma^2_\mathrm{hist}}))_+,
$$ where $\hat h_{j,\dem}(q)$ is our estimate of the average harm to a Democratic voter in precinct $j$, averaging across $V$ and $\tilde Q$.
The corresponding $\hat h_{j,\rep}(q)$ is computed similarly.

Our final estimates $\hat H(q)$ and $\Delta_{\dem-\rep}\hat H(q)$ may then be straightforwardly calculated as weighted averages:

```{=tex}
\begin{align*}
\hat H(q) &\dfeq
\frac{\sum_{j} (\bar s_j\hat h_{j,\dem}(q) + 
(1-\bar s_j)\hat h_{j,\rep}(q))\avgvote_j}{\sum_{j} \avgvote_j} \qand \\
\Delta_{\dem-\rep}\hat H(q) &\dfeq
\frac{\sum_{j} (\hat h_{j,\dem}(q) - \hat h_{j,\rep}(q))\avgvote_j}{\sum_{j} \avgvote_j}.
\end{align*}
```
Here, we rely on the fact that even across election shifts, the relative balance of each party's voters across precincts is preserved.

# Latent Factor Ecological Inference Model for Boston Primary Elections {#app:lfei}

```{r boston-gen-pred, fig.width=6.5}
#| fig.cap: |
#|      Model predictions of general election vote shares and turnout, compared to actual general election results. 
#|      Red reference line indicates perfect agreement. 
#|      Actual and estimated results have Spearman correlations of 0.87 (vote share) and 0.84 (turnout rate).
include_graphics("figures/boston_gen_pred.pdf")
```
